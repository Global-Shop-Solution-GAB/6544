Program.Sub.ScreenSU.Start
Gui.FormSerialMangement..Create(BaseForm)
Gui.FormSerialMangement..Caption("Serial# Management")
Gui.FormSerialMangement..Size(15585,13155)
Gui.FormSerialMangement..MinX(0)
Gui.FormSerialMangement..MinY(0)
Gui.FormSerialMangement..Position(0,0)
Gui.FormSerialMangement..BackColor(-2147483633)
Gui.FormSerialMangement..MousePointer(0)
Gui.FormSerialMangement..Event(UnLoad,FormSerialMangement_UnLoad)
Gui.FormSerialMangement..AlwaysOnTop(False)
Gui.FormSerialMangement..FontName("Tahoma")
Gui.FormSerialMangement..FontSize(8.25)
Gui.FormSerialMangement..ControlBox(True)
Gui.FormSerialMangement..MaxButton(True)
Gui.FormSerialMangement..MinButton(True)
Gui.FormSerialMangement..Moveable(True)
Gui.FormSerialMangement..Sizeable(True)
Gui.FormSerialMangement..ShowInTaskBar(True)
Gui.FormSerialMangement..TitleBar(True)
Gui.FormSerialMangement.lblSerial.Create(Label,"Serial No:",True,690,210,0,7005,165,True,0,"Arial",8,-2147483633,0,0)
Gui.FormSerialMangement.lblSerial.BorderStyle(0)
Gui.FormSerialMangement.txtSerial.Create(TextBox,"",True,2595,300,0,7800,120,True,0,"Arial",8,-2147483643,1)
Gui.FormSerialMangement.txtSerial.Event(KeyPressEnter,loadsingle)
Gui.FormSerialMangement.GsGridControlSERV.Create(GsGridControl)
Gui.FormSerialMangement.GsGridControlSERV.Size(15405,2295)
Gui.FormSerialMangement.GsGridControlSERV.Position(75,555)
Gui.FormSerialMangement.GsGridControlSERV.Event(RowCellClick,GsGridControlSERV_RowCellClick)
Gui.FormSerialMangement.GsGridControlSERV.Enabled(True)
Gui.FormSerialMangement.GsGridControlSERV.Visible(True)
Gui.FormSerialMangement.GsGridControlSERV.Zorder(0)
Gui.FormSerialMangement.tab1.Create(Tab)
Gui.FormSerialMangement.tab1.Size(15345,9480)
Gui.FormSerialMangement.tab1.Position(90,3015)
Gui.FormSerialMangement.tab1.Anchor(15)
Gui.FormSerialMangement.tab1.Enabled(True)
Gui.FormSerialMangement.tab1.Visible(True)
Gui.FormSerialMangement.tab1.Zorder(0)
Gui.FormSerialMangement.tab1.FontName("Tahoma")
Gui.FormSerialMangement.tab1.FontSize(8.25)
Gui.FormSerialMangement.tab1.Tabs(3)
Gui.FormSerialMangement.tab1.SetTab(0)
Gui.FormSerialMangement.tab1.Caption("Contacts & CSR History")
Gui.FormSerialMangement.tab1.SetTab(1)
Gui.FormSerialMangement.tab1.Caption("WO BOM")
Gui.FormSerialMangement.tab1.SetTab(2)
Gui.FormSerialMangement.tab1.Caption("Attachments")
Gui.FormSerialMangement.GsGridControlServSO.Create(GsGridControl)
Gui.FormSerialMangement.GsGridControlServSO.Size(15165,2355)
Gui.FormSerialMangement.GsGridControlServSO.Position(60,6150)
Gui.FormSerialMangement.GsGridControlServSO.Parent("tab1",0)
Gui.FormSerialMangement.GsGridControlServSO.Event(RowCellClick,GsGridControlServSO_RowCellClick)
Gui.FormSerialMangement.GsGridControlServSO.Anchor(12)
Gui.FormSerialMangement.GsGridControlServSO.Enabled(True)
Gui.FormSerialMangement.GsGridControlServSO.Visible(True)
Gui.FormSerialMangement.GsGridControlServSO.Zorder(0)
Gui.FormSerialMangement.ddlIncident.Create(DropDownList)
Gui.FormSerialMangement.ddlIncident.Enabled(True)
Gui.FormSerialMangement.ddlIncident.Visible(True)
Gui.FormSerialMangement.ddlIncident.Zorder(0)
Gui.FormSerialMangement.ddlIncident.Size(2280,300)
Gui.FormSerialMangement.ddlIncident.Position(1455,945)
Gui.FormSerialMangement.ddlIncident.FontName("Tahoma")
Gui.FormSerialMangement.ddlIncident.FontSize(8.25)
Gui.FormSerialMangement.ddlIncident.Parent("tab1",0)
Gui.FormSerialMangement.cmdIncidentSave.Create(Button)
Gui.FormSerialMangement.cmdIncidentSave.Enabled(True)
Gui.FormSerialMangement.cmdIncidentSave.Visible(True)
Gui.FormSerialMangement.cmdIncidentSave.Zorder(0)
Gui.FormSerialMangement.cmdIncidentSave.Size(855,375)
Gui.FormSerialMangement.cmdIncidentSave.Position(3510,3165)
Gui.FormSerialMangement.cmdIncidentSave.Caption("Save")
Gui.FormSerialMangement.cmdIncidentSave.FontName("Tahoma")
Gui.FormSerialMangement.cmdIncidentSave.FontSize(8.25)
Gui.FormSerialMangement.cmdIncidentSave.Parent("tab1",0)
Gui.FormSerialMangement.cmdIncidentSave.Event(Click,cmdIncidentSave_Click)
Gui.FormSerialMangement.txtSiteName.Create(TextboxM)
Gui.FormSerialMangement.txtSiteName.Size(3180,1740)
Gui.FormSerialMangement.txtSiteName.Position(1455,1335)
Gui.FormSerialMangement.txtSiteName.Parent("tab1",0)
Gui.FormSerialMangement.txtSiteName.Enabled(True)
Gui.FormSerialMangement.txtSiteName.Visible(True)
Gui.FormSerialMangement.txtSiteName.Zorder(0)
Gui.FormSerialMangement.txtSiteName.FontName("Tahoma")
Gui.FormSerialMangement.txtSiteName.FontSize(8.25)
Gui.FormSerialMangement.lblSiteName.Create(Label,"Notes",True,420,210,0,135,1335,True,1,"Arial",8,-2147483633,0,0)
Gui.FormSerialMangement.lblSiteName.Parent("tab1",0)
Gui.FormSerialMangement.lblSiteName.BorderStyle(0)
Gui.FormSerialMangement.txtIncident.Create(TextBox,"",True,735,300,0,1455,135,True,0,"Tahoma",8.25,,1)
Gui.FormSerialMangement.txtIncident.Parent("tab1",0)
Gui.FormSerialMangement.txtIncident.Locked(True)
Gui.FormSerialMangement.txtVendorPhone.Create(TextBox,"",False,1425,300,0,1200,6210,True,0,"Arial",8,-2147483643,1)
Gui.FormSerialMangement.txtVendorPhone.Parent("tab1",0)
Gui.FormSerialMangement.cmdIncidentNew.Create(Button)
Gui.FormSerialMangement.cmdIncidentNew.Enabled(True)
Gui.FormSerialMangement.cmdIncidentNew.Visible(True)
Gui.FormSerialMangement.cmdIncidentNew.Zorder(0)
Gui.FormSerialMangement.cmdIncidentNew.Size(855,375)
Gui.FormSerialMangement.cmdIncidentNew.Position(2595,3165)
Gui.FormSerialMangement.cmdIncidentNew.Caption("New")
Gui.FormSerialMangement.cmdIncidentNew.FontName("Tahoma")
Gui.FormSerialMangement.cmdIncidentNew.FontSize(8.25)
Gui.FormSerialMangement.cmdIncidentNew.Parent("tab1",0)
Gui.FormSerialMangement.cmdIncidentNew.Event(Click,cmdIncidentNew_Click)
Gui.FormSerialMangement.lblServSO.Create(Label,"Service Sales Orders",True,1560,210,0,165,5895,True,1,"Arial",8,-2147483633,0,0)
Gui.FormSerialMangement.lblServSO.Parent("tab1",0)
Gui.FormSerialMangement.lblServSO.BorderStyle(0)
Gui.FormSerialMangement.lblCSRHist.Create(Label,"Warranty",True,675,210,0,4875,60,True,1,"Arial",8,-2147483633,0,0)
Gui.FormSerialMangement.lblCSRHist.Parent("tab1",0)
Gui.FormSerialMangement.lblCSRHist.BorderStyle(0)
Gui.FormSerialMangement.lblSiteName2.Create(Label,"Generic Reason",True,1170,210,0,135,600,True,1,"Arial",8,-2147483633,0,0)
Gui.FormSerialMangement.lblSiteName2.BorderStyle(0)
Gui.FormSerialMangement.lblSiteName2.Parent("tab1",0)
Gui.FormSerialMangement.ddlIncidentType.Create(DropDownList)
Gui.FormSerialMangement.ddlIncidentType.Enabled(True)
Gui.FormSerialMangement.ddlIncidentType.Visible(True)
Gui.FormSerialMangement.ddlIncidentType.Zorder(0)
Gui.FormSerialMangement.ddlIncidentType.Size(2280,300)
Gui.FormSerialMangement.ddlIncidentType.Position(1455,540)
Gui.FormSerialMangement.ddlIncidentType.FontName("Tahoma")
Gui.FormSerialMangement.ddlIncidentType.FontSize(8.25)
Gui.FormSerialMangement.ddlIncidentType.Parent("tab1",0)
Gui.FormSerialMangement.ddlIncidentType.Event(Change,ddlIncidentType_Change)
Gui.FormSerialMangement.txtVendorEmail.Create(TextBox,"",False,1695,300,0,2670,6210,True,0,"Arial",8,-2147483643,1)
Gui.FormSerialMangement.txtVendorEmail.Parent("tab1",0)
Gui.FormSerialMangement.cmdContactsSave.Create(Button)
Gui.FormSerialMangement.cmdContactsSave.Size(855,375)
Gui.FormSerialMangement.cmdContactsSave.Position(3390,6705)
Gui.FormSerialMangement.cmdContactsSave.Parent("tab1",0)
Gui.FormSerialMangement.cmdContactsSave.Caption("Save")
Gui.FormSerialMangement.cmdContactsSave.Event(Click,cmdContactsSave_Click)
Gui.FormSerialMangement.cmdContactsSave.Enabled(False)
Gui.FormSerialMangement.cmdContactsSave.Visible(False)
Gui.FormSerialMangement.cmdContactsSave.Zorder(0)
Gui.FormSerialMangement.cmdContactsSave.FontName("Tahoma")
Gui.FormSerialMangement.cmdContactsSave.FontSize(8.25)
Gui.FormSerialMangement.GsGridControlCSRHist.Create(GsGridControl)
Gui.FormSerialMangement.GsGridControlCSRHist.Size(10275,1290)
Gui.FormSerialMangement.GsGridControlCSRHist.Position(4890,330)
Gui.FormSerialMangement.GsGridControlCSRHist.Parent("tab1",0)
Gui.FormSerialMangement.GsGridControlCSRHist.Event(RowCellClick,GsGridControlCSRHist_RowCellClick)
Gui.FormSerialMangement.GsGridControlCSRHist.Anchor(12)
Gui.FormSerialMangement.GsGridControlCSRHist.Enabled(True)
Gui.FormSerialMangement.GsGridControlCSRHist.Visible(True)
Gui.FormSerialMangement.GsGridControlCSRHist.Zorder(0)
Gui.FormSerialMangement.lblOrigSO.Create(Label,"Incident",True,555,210,0,165,3330,True,1,"Arial",8,-2147483633,0,0)
Gui.FormSerialMangement.lblOrigSO.Parent("tab1",0)
Gui.FormSerialMangement.lblOrigSO.BorderStyle(0)
Gui.FormSerialMangement.htmlContainerDoc.Create(HtmlContainer)
Gui.FormSerialMangement.htmlContainerDoc.Size(11970,8520)
Gui.FormSerialMangement.htmlContainerDoc.Position(3150,405)
Gui.FormSerialMangement.htmlContainerDoc.Parent("tab1",2)
Gui.FormSerialMangement.htmlContainerDoc.Anchor(15)
Gui.FormSerialMangement.htmlContainerDoc.Visible(True)
Gui.FormSerialMangement.htmlContainerDoc.Zorder(0)
Gui.FormSerialMangement.lblFileDesc.Create(Label,"Label",True,6300,255,0,3150,180,True,0,"Arial",8,-2147483633,0,0)
Gui.FormSerialMangement.lblFileDesc.Parent("tab1",2)
Gui.FormSerialMangement.lblFileDesc.BorderStyle(0)
Gui.FormSerialMangement.lbl10.Create(Label,"Select Document to View",True,2820,255,0,150,180,True,0,"Arial",8,-2147483633,0,0)
Gui.FormSerialMangement.lbl10.Parent("tab1",2)
Gui.FormSerialMangement.lbl10.BorderStyle(0)
Gui.FormSerialMangement.GsGridControlDoc.Create(GsGridControl)
Gui.FormSerialMangement.GsGridControlDoc.Size(2850,8520)
Gui.FormSerialMangement.GsGridControlDoc.Position(150,405)
Gui.FormSerialMangement.GsGridControlDoc.Parent("tab1",2)
Gui.FormSerialMangement.GsGridControlDoc.Event(RowCellClick,GsGridControlDoc_RowCellClick)
Gui.FormSerialMangement.GsGridControlDoc.Anchor(7)
Gui.FormSerialMangement.GsGridControlDoc.Enabled(True)
Gui.FormSerialMangement.GsGridControlDoc.Visible(True)
Gui.FormSerialMangement.GsGridControlDoc.Zorder(0)
Gui.FormSerialMangement.GsGridControlbomWOBOM.Create(GsGridControl)
Gui.FormSerialMangement.GsGridControlbomWOBOM.Size(15090,6255)
Gui.FormSerialMangement.GsGridControlbomWOBOM.Position(120,465)
Gui.FormSerialMangement.GsGridControlbomWOBOM.Parent("tab1",1)
Gui.FormSerialMangement.GsGridControlbomWOBOM.Event(RowCellClick,GsGridControlbomWOBOM_RowCellClick)
Gui.FormSerialMangement.GsGridControlbomWOBOM.Anchor(13)
Gui.FormSerialMangement.GsGridControlbomWOBOM.Enabled(True)
Gui.FormSerialMangement.GsGridControlbomWOBOM.Visible(True)
Gui.FormSerialMangement.GsGridControlbomWOBOM.Zorder(0)
Gui.FormSerialMangement.cmdCreateSO.Create(Button)
Gui.FormSerialMangement.cmdCreateSO.Enabled(True)
Gui.FormSerialMangement.cmdCreateSO.Visible(True)
Gui.FormSerialMangement.cmdCreateSO.Zorder(0)
Gui.FormSerialMangement.cmdCreateSO.Size(1125,345)
Gui.FormSerialMangement.cmdCreateSO.Position(14070,45)
Gui.FormSerialMangement.cmdCreateSO.Caption("Create SO")
Gui.FormSerialMangement.cmdCreateSO.FontName("Tahoma")
Gui.FormSerialMangement.cmdCreateSO.FontSize(8.25)
Gui.FormSerialMangement.cmdCreateSO.Parent("tab1",1)
Gui.FormSerialMangement.cmdCreateSO.Event(Click,cmdCreateSO_Click)
Gui.FormSerialMangement.GsGcOrderToWO.Create(GsGridControl)
Gui.FormSerialMangement.GsGcOrderToWO.Size(15030,2085)
Gui.FormSerialMangement.GsGcOrderToWO.Position(165,6825)
Gui.FormSerialMangement.GsGcOrderToWO.Parent("tab1",1)
Gui.FormSerialMangement.GsGcOrderToWO.Event(RowCellClick,GsGcOrderToWO_RowCellClick)
Gui.FormSerialMangement.GsGcOrderToWO.Anchor(15)
Gui.FormSerialMangement.GsGcOrderToWO.Enabled(True)
Gui.FormSerialMangement.GsGcOrderToWO.Visible(True)
Gui.FormSerialMangement.GsGcOrderToWO.Zorder(0)
Gui.FormSerialMangement.chk1.Create(CheckBox)
Gui.FormSerialMangement.chk1.Enabled(True)
Gui.FormSerialMangement.chk1.Visible(True)
Gui.FormSerialMangement.chk1.Zorder(0)
Gui.FormSerialMangement.chk1.Size(1125,300)
Gui.FormSerialMangement.chk1.Position(12855,75)
Gui.FormSerialMangement.chk1.Caption("Warranty")
Gui.FormSerialMangement.chk1.FontName("Tahoma")
Gui.FormSerialMangement.chk1.FontSize(8.25)
Gui.FormSerialMangement.chk1.Parent("tab1",1)
Gui.FormSerialMangement.cmdAddPartWO.Create(Button)
Gui.FormSerialMangement.cmdAddPartWO.Enabled(True)
Gui.FormSerialMangement.cmdAddPartWO.Visible(True)
Gui.FormSerialMangement.cmdAddPartWO.Zorder(0)
Gui.FormSerialMangement.cmdAddPartWO.Size(1125,345)
Gui.FormSerialMangement.cmdAddPartWO.Position(11640,75)
Gui.FormSerialMangement.cmdAddPartWO.Caption("Add Part")
Gui.FormSerialMangement.cmdAddPartWO.FontName("Tahoma")
Gui.FormSerialMangement.cmdAddPartWO.FontSize(8.25)
Gui.FormSerialMangement.cmdAddPartWO.Parent("tab1",1)
Gui.FormSerialMangement.cmdAddPartWO.Event(Click,cmdAddPartWO_Click)
Gui.FormSerialMangement.lblContactCust.Create(Label,"Incident",True,555,210,0,135,180,True,1,"Arial",8,-2147483633,0,0)
Gui.FormSerialMangement.lblContactCust.Parent("tab1",0)
Gui.FormSerialMangement.lblContactCust.BorderStyle(0)
Gui.FormSerialMangement.GsGridControlOrigSO.Create(GsGridControl)
Gui.FormSerialMangement.GsGridControlOrigSO.Size(15150,2100)
Gui.FormSerialMangement.GsGridControlOrigSO.Position(90,3585)
Gui.FormSerialMangement.GsGridControlOrigSO.Parent("tab1",0)
Gui.FormSerialMangement.GsGridControlOrigSO.Event(RowCellClick,GsGridControlOrigSO_RowCellClick)
Gui.FormSerialMangement.GsGridControlOrigSO.Anchor(12)
Gui.FormSerialMangement.GsGridControlOrigSO.Enabled(True)
Gui.FormSerialMangement.GsGridControlOrigSO.Visible(True)
Gui.FormSerialMangement.GsGridControlOrigSO.Zorder(0)
Gui.FormSerialMangement.cmdNewCSR.Create(Button)
Gui.FormSerialMangement.cmdNewCSR.Size(1485,375)
Gui.FormSerialMangement.cmdNewCSR.Position(9000,8580)
Gui.FormSerialMangement.cmdNewCSR.Parent("tab1",0)
Gui.FormSerialMangement.cmdNewCSR.Caption("NEW CSR")
Gui.FormSerialMangement.cmdNewCSR.Event(Click,cmdNewCSR_Click)
Gui.FormSerialMangement.cmdNewCSR.Enabled(True)
Gui.FormSerialMangement.cmdNewCSR.Visible(True)
Gui.FormSerialMangement.cmdNewCSR.Zorder(0)
Gui.FormSerialMangement.cmdNewCSR.FontName("Tahoma")
Gui.FormSerialMangement.cmdNewCSR.FontSize(8.25)
Gui.FormSerialMangement.GsGridControlCSREvent.Create(GsGridControl)
Gui.FormSerialMangement.GsGridControlCSREvent.Size(10275,1455)
Gui.FormSerialMangement.GsGridControlCSREvent.Position(4950,1800)
Gui.FormSerialMangement.GsGridControlCSREvent.Parent("tab1",0)
Gui.FormSerialMangement.GsGridControlCSREvent.Anchor(12)
Gui.FormSerialMangement.GsGridControlCSREvent.Enabled(True)
Gui.FormSerialMangement.GsGridControlCSREvent.Visible(True)
Gui.FormSerialMangement.GsGridControlCSREvent.Zorder(0)
Gui.FormSerialMangement.txtVendorName.Create(TextBox,"",False,2280,300,0,2085,5295,True,0,"Arial",8,-2147483643,1)
Gui.FormSerialMangement.txtVendorName.Parent("tab1",0)
Gui.FormSerialMangement.lblCSREvent.Create(Label,"RMA Hist Lines",True,1095,210,0,4875,1620,True,1,"Arial",8,-2147483633,0,0)
Gui.FormSerialMangement.lblCSREvent.Parent("tab1",0)
Gui.FormSerialMangement.lblCSREvent.BorderStyle(0)
Gui.FormSerialMangement.lblVendorContact.Create(Label,"Vendor Contact",False,1140,210,0,3270,6270,True,1,"Arial",8,-2147483633,0,0)
Gui.FormSerialMangement.lblVendorContact.Parent("tab1",0)
Gui.FormSerialMangement.lblVendorContact.BorderStyle(0)
Gui.FormSerialMangement.lblSiteName3.Create(Label,"Specific Reason",True,1185,210,0,135,990,True,1,"Arial",8,-2147483633,0,0)
Gui.FormSerialMangement.lblSiteName3.BorderStyle(0)
Gui.FormSerialMangement.lblSiteName3.Parent("tab1",0)
Gui.FormSerialMangement.cmdIncidentDelete.Create(Button)
Gui.FormSerialMangement.cmdIncidentDelete.Enabled(True)
Gui.FormSerialMangement.cmdIncidentDelete.Visible(True)
Gui.FormSerialMangement.cmdIncidentDelete.Zorder(0)
Gui.FormSerialMangement.cmdIncidentDelete.Size(855,375)
Gui.FormSerialMangement.cmdIncidentDelete.Position(1680,3165)
Gui.FormSerialMangement.cmdIncidentDelete.Caption("Delete")
Gui.FormSerialMangement.cmdIncidentDelete.FontName("Tahoma")
Gui.FormSerialMangement.cmdIncidentDelete.FontSize(8.25)
Gui.FormSerialMangement.cmdIncidentDelete.Parent("tab1",0)
Gui.FormSerialMangement.cmdIncidentDelete.Event(Click,cmdIncidentDelete_Click)
Gui.FormSerialMangement.cmdNewSO.Create(Button)
Gui.FormSerialMangement.cmdNewSO.Size(1485,375)
Gui.FormSerialMangement.cmdNewSO.Position(12090,8580)
Gui.FormSerialMangement.cmdNewSO.Parent("tab1",0)
Gui.FormSerialMangement.cmdNewSO.Caption("NEW Sales Order")
Gui.FormSerialMangement.cmdNewSO.Event(Click,cmdNewSO_Click)
Gui.FormSerialMangement.cmdNewSO.Enabled(True)
Gui.FormSerialMangement.cmdNewSO.Visible(True)
Gui.FormSerialMangement.cmdNewSO.Zorder(0)
Gui.FormSerialMangement.cmdNewSO.FontName("Tahoma")
Gui.FormSerialMangement.cmdNewSO.FontSize(8.25)
Gui.FormSerialMangement.cmdReg.Create(Button)
Gui.FormSerialMangement.cmdReg.Enabled(True)
Gui.FormSerialMangement.cmdReg.Visible(True)
Gui.FormSerialMangement.cmdReg.Zorder(0)
Gui.FormSerialMangement.cmdReg.Size(1485,375)
Gui.FormSerialMangement.cmdReg.Position(10545,8580)
Gui.FormSerialMangement.cmdReg.Caption("Registration")
Gui.FormSerialMangement.cmdReg.FontName("Tahoma")
Gui.FormSerialMangement.cmdReg.FontSize(8.25)
Gui.FormSerialMangement.cmdReg.Parent("tab1",0)
Gui.FormSerialMangement.cmdReg.Event(Click,cmdReg_Click)
Gui.FormSerialMangement.cmdNewRMA.Create(Button)
Gui.FormSerialMangement.cmdNewRMA.Size(1485,375)
Gui.FormSerialMangement.cmdNewRMA.Position(13695,8580)
Gui.FormSerialMangement.cmdNewRMA.Parent("tab1",0)
Gui.FormSerialMangement.cmdNewRMA.Caption("NEW RMA")
Gui.FormSerialMangement.cmdNewRMA.Event(Click,cmdNewRMA_Click)
Gui.FormSerialMangement.cmdNewRMA.Enabled(True)
Gui.FormSerialMangement.cmdNewRMA.Visible(True)
Gui.FormSerialMangement.cmdNewRMA.Zorder(0)
Gui.FormSerialMangement.cmdNewRMA.FontName("Tahoma")
Gui.FormSerialMangement.cmdNewRMA.FontSize(8.25)
Gui.FormSerialMangement.lblCustomer.Create(Label,"Customer:",True,735,210,0,180,165,True,0,"Arial",8,-2147483633,0,0)
Gui.FormSerialMangement.lblCustomer.BorderStyle(0)
Gui.FormSerialMangement.txtCustomer.Create(TextBox,"",True,1260,300,0,975,120,True,0,"Arial",8,-2147483643,1)
Gui.FormSerialMangement.txtCustomer.Event(KeyPressEnter,txtCustomer_KeyPressEnter)
Gui.FormSerialMangement.cmdRefresh.Create(Button)
Gui.FormSerialMangement.cmdRefresh.Size(855,375)
Gui.FormSerialMangement.cmdRefresh.Position(5970,90)
Gui.FormSerialMangement.cmdRefresh.Caption("Refresh")
Gui.FormSerialMangement.cmdRefresh.Event(Click,cmdRefresh_Click)
Gui.FormSerialMangement.cmdRefresh.Enabled(True)
Gui.FormSerialMangement.cmdRefresh.Visible(True)
Gui.FormSerialMangement.cmdRefresh.Zorder(0)
Gui.FormSerialMangement.cmdRefresh.FontName("Tahoma")
Gui.FormSerialMangement.cmdRefresh.FontSize(8.25)
Gui.FormSerialMangement.pBar1.Create(ProgressBar)
Gui.FormSerialMangement.pBar1.Size(1635,255)
Gui.FormSerialMangement.pBar1.Position(13080,150)
Gui.FormSerialMangement.pBar1.Anchor(9)
Gui.FormSerialMangement.pBar1.Visible(True)
Gui.FormSerialMangement.lbl1.Create(Label,"0%",True,240,210,0,14775,165,True,1,"Arial",8,-2147483633,0,0)
Gui.FormSerialMangement.lbl1.Anchor(9)
Gui.FormSerialMangement.lbl1.BorderStyle(0)
Gui.FormSerialMangement.cmdSNbrw.Create(Button)
Gui.FormSerialMangement.cmdSNbrw.Enabled(True)
Gui.FormSerialMangement.cmdSNbrw.Visible(True)
Gui.FormSerialMangement.cmdSNbrw.Zorder(0)
Gui.FormSerialMangement.cmdSNbrw.Size(435,345)
Gui.FormSerialMangement.cmdSNbrw.Position(10455,90)
Gui.FormSerialMangement.cmdSNbrw.Caption("^")
Gui.FormSerialMangement.cmdSNbrw.FontName("Tahoma")
Gui.FormSerialMangement.cmdSNbrw.FontSize(8.25)
Gui.FormSerialMangement.cmdSNbrw.Event(Click,cmdSNbrw_Click)
Gui.FormSerialMangement.cmdCust.Create(Button)
Gui.FormSerialMangement.cmdCust.Enabled(True)
Gui.FormSerialMangement.cmdCust.Visible(True)
Gui.FormSerialMangement.cmdCust.Zorder(0)
Gui.FormSerialMangement.cmdCust.Size(435,345)
Gui.FormSerialMangement.cmdCust.Position(2310,90)
Gui.FormSerialMangement.cmdCust.Caption("^")
Gui.FormSerialMangement.cmdCust.FontName("Tahoma")
Gui.FormSerialMangement.cmdCust.FontSize(8.25)
Gui.FormSerialMangement.cmdCust.Event(Click,cmdCust_Click)
Gui.FormSerialMangement.dtp1.Create(DatePicker)
Gui.FormSerialMangement.dtp1.Enabled(True)
Gui.FormSerialMangement.dtp1.Visible(True)
Gui.FormSerialMangement.dtp1.Zorder(0)
Gui.FormSerialMangement.dtp1.Size(1500,300)
Gui.FormSerialMangement.dtp1.Position(2850,120)
Gui.FormSerialMangement.dtp1.CheckBox(False)
Gui.FormSerialMangement.dtp1.FontName("Tahoma")
Gui.FormSerialMangement.dtp1.FontSize(8.25)
Gui.FormSerialMangement.dtp2.Create(DatePicker)
Gui.FormSerialMangement.dtp2.Enabled(True)
Gui.FormSerialMangement.dtp2.Visible(True)
Gui.FormSerialMangement.dtp2.Zorder(0)
Gui.FormSerialMangement.dtp2.Size(1500,300)
Gui.FormSerialMangement.dtp2.Position(4395,120)
Gui.FormSerialMangement.dtp2.CheckBox(False)
Gui.FormSerialMangement.dtp2.FontName("Tahoma")
Gui.FormSerialMangement.dtp2.FontSize(8.25)
Gui.FormSerialMangement.lblSO.Create(Label,"SO No:",True,510,210,0,11010,150,True,0,"Arial",8,-2147483633,0,0)
Gui.FormSerialMangement.lblSO.BorderStyle(0)
Gui.FormSerialMangement.txtSO.Create(TextBox,"",True,1320,300,0,11610,120,True,0,"Arial",8,-2147483643,1)
Gui.F_Registration..Create(BaseForm)
Gui.F_Registration..Caption("Registration")
Gui.F_Registration..Size(6465,6180)
Gui.F_Registration..MinX(0)
Gui.F_Registration..MinY(0)
Gui.F_Registration..Position(0,0)
Gui.F_Registration..AlwaysOnTop(False)
Gui.F_Registration..FontName("Tahoma")
Gui.F_Registration..FontSize(8.25)
Gui.F_Registration..ControlBox(True)
Gui.F_Registration..MaxButton(True)
Gui.F_Registration..MinButton(True)
Gui.F_Registration..MousePointer(0)
Gui.F_Registration..Moveable(True)
Gui.F_Registration..Sizeable(True)
Gui.F_Registration..ShowInTaskBar(True)
Gui.F_Registration..TitleBar(True)
Gui.F_Registration..Event(UnLoad,F_Registration_UnLoad)
Gui.F_Registration.cmdRegEmail.Create(Button)
Gui.F_Registration.cmdRegEmail.Enabled(False)
Gui.F_Registration.cmdRegEmail.Visible(True)
Gui.F_Registration.cmdRegEmail.Zorder(0)
Gui.F_Registration.cmdRegEmail.Size(1545,345)
Gui.F_Registration.cmdRegEmail.Position(3180,915)
Gui.F_Registration.cmdRegEmail.Caption("Email Registration")
Gui.F_Registration.cmdRegEmail.FontName("Tahoma")
Gui.F_Registration.cmdRegEmail.FontSize(8.25)
Gui.F_Registration.cmdRegEmail.Event(Click,cmdRegEmail_Click)
Gui.F_Registration.cmdRegScreen.Create(Button)
Gui.F_Registration.cmdRegScreen.Enabled(True)
Gui.F_Registration.cmdRegScreen.Visible(True)
Gui.F_Registration.cmdRegScreen.Zorder(0)
Gui.F_Registration.cmdRegScreen.Size(1410,345)
Gui.F_Registration.cmdRegScreen.Position(105,915)
Gui.F_Registration.cmdRegScreen.Caption("Warranty Screen")
Gui.F_Registration.cmdRegScreen.FontName("Tahoma")
Gui.F_Registration.cmdRegScreen.FontSize(8.25)
Gui.F_Registration.cmdRegScreen.Event(Click,cmdRegScreen_Click)
Gui.F_Registration.cmdRegSave.Create(Button)
Gui.F_Registration.cmdRegSave.Enabled(True)
Gui.F_Registration.cmdRegSave.Visible(True)
Gui.F_Registration.cmdRegSave.Zorder(0)
Gui.F_Registration.cmdRegSave.Size(1545,345)
Gui.F_Registration.cmdRegSave.Position(4830,915)
Gui.F_Registration.cmdRegSave.Caption("Save Registration")
Gui.F_Registration.cmdRegSave.FontName("Tahoma")
Gui.F_Registration.cmdRegSave.FontSize(8.25)
Gui.F_Registration.cmdRegSave.Event(Click,cmdRegSave_Click)
Gui.F_Registration.GsGcReg.Create(GsGridControl)
Gui.F_Registration.GsGcReg.Enabled(True)
Gui.F_Registration.GsGcReg.Visible(True)
Gui.F_Registration.GsGcReg.Zorder(0)
Gui.F_Registration.GsGcReg.Size(6315,4260)
Gui.F_Registration.GsGcReg.Position(60,1365)
Gui.F_Registration.GsGcReg.Anchor(15)
Gui.F_Registration.lbl1.Create(Label,"From Folder",True,855,195,0,75,120,True,0,"Tahoma",8.25,,0,0)
Gui.F_Registration.lbl1.BorderStyle(0)
Gui.F_Registration.lbl2.Create(Label,"To Folder",True,675,195,0,90,540,True,0,"Tahoma",8.25,,0,0)
Gui.F_Registration.lbl2.BorderStyle(0)
Gui.F_Registration.txtFromFolder.Create(TextBox,"",True,3285,300,0,1065,60,True,0,"Tahoma",8.25,,1)
Gui.F_Registration.txtToFolder.Create(TextBox,"",True,3285,300,0,1065,480,True,0,"Tahoma",8.25,,1)
Gui.F_Registration.cmdFrom.Create(Button)
Gui.F_Registration.cmdFrom.Enabled(True)
Gui.F_Registration.cmdFrom.Visible(True)
Gui.F_Registration.cmdFrom.Zorder(0)
Gui.F_Registration.cmdFrom.Size(390,345)
Gui.F_Registration.cmdFrom.Position(4470,30)
Gui.F_Registration.cmdFrom.Caption("^")
Gui.F_Registration.cmdFrom.FontName("Tahoma")
Gui.F_Registration.cmdFrom.FontSize(8.25)
Gui.F_Registration.cmdFrom.Event(Click,cmdFrom_Click)
Gui.F_Registration.cmdTo.Create(Button)
Gui.F_Registration.cmdTo.Enabled(True)
Gui.F_Registration.cmdTo.Visible(True)
Gui.F_Registration.cmdTo.Zorder(0)
Gui.F_Registration.cmdTo.Size(390,345)
Gui.F_Registration.cmdTo.Position(4470,450)
Gui.F_Registration.cmdTo.Caption("^")
Gui.F_Registration.cmdTo.FontName("Tahoma")
Gui.F_Registration.cmdTo.FontSize(8.25)
Gui.F_Registration.cmdTo.Event(Click,cmdTo_Click)
Gui.F_Registration.cmdTextEmail.Create(Button)
Gui.F_Registration.cmdTextEmail.Enabled(True)
Gui.F_Registration.cmdTextEmail.Visible(True)
Gui.F_Registration.cmdTextEmail.Zorder(0)
Gui.F_Registration.cmdTextEmail.Size(1545,345)
Gui.F_Registration.cmdTextEmail.Position(1575,915)
Gui.F_Registration.cmdTextEmail.Caption("Email Copy Text ")
Gui.F_Registration.cmdTextEmail.FontName("Tahoma")
Gui.F_Registration.cmdTextEmail.FontSize(8.25)
Gui.F_Registration.cmdTextEmail.Event(Click,cmdTextEmail_Click)
Gui.FormRegText..Create(BaseForm)
Gui.FormRegText..Caption("Email Text")
Gui.FormRegText..Size(7770,6300)
Gui.FormRegText..MinX(0)
Gui.FormRegText..MinY(0)
Gui.FormRegText..Position(0,0)
Gui.FormRegText..AlwaysOnTop(False)
Gui.FormRegText..FontName("Tahoma")
Gui.FormRegText..FontSize(8.25)
Gui.FormRegText..ControlBox(True)
Gui.FormRegText..MaxButton(True)
Gui.FormRegText..MinButton(True)
Gui.FormRegText..MousePointer(0)
Gui.FormRegText..Moveable(True)
Gui.FormRegText..Sizeable(True)
Gui.FormRegText..ShowInTaskBar(True)
Gui.FormRegText..TitleBar(True)
Gui.FormRegText.cmdOKTEXT.Create(Button)
Gui.FormRegText.cmdOKTEXT.Enabled(True)
Gui.FormRegText.cmdOKTEXT.Visible(True)
Gui.FormRegText.cmdOKTEXT.Zorder(0)
Gui.FormRegText.cmdOKTEXT.Size(1125,345)
Gui.FormRegText.cmdOKTEXT.Position(6630,30)
Gui.FormRegText.cmdOKTEXT.Caption("OK")
Gui.FormRegText.cmdOKTEXT.FontName("Tahoma")
Gui.FormRegText.cmdOKTEXT.FontSize(8.25)
Gui.FormRegText.cmdOKTEXT.Event(Click,cmdOKTEXT_Click)
Gui.FormRegText.txtRegEmail.Create(TextboxM)
Gui.FormRegText.txtRegEmail.Enabled(True)
Gui.FormRegText.txtRegEmail.Visible(True)
Gui.FormRegText.txtRegEmail.Zorder(0)
Gui.FormRegText.txtRegEmail.Size(7680,5340)
Gui.FormRegText.txtRegEmail.Position(60,405)
Gui.FormRegText.txtRegEmail.FontName("Tahoma")
Gui.FormRegText.txtRegEmail.FontSize(8.25)
Program.Sub.ScreenSU.End

Program.Sub.Preflight.Start
V.Global.sSerial.Declare(String,"")
v.Global.sEmailID.Declare
'Program.External.Include.Library("6004.lib")
'Program.External.Include.Library("UPLPUROR.lib")
v.Global.bEmail.Declare
Program.External.Include.Library("GCG_5658_ORDUPL.lib")
Program.Sub.Preflight.End

Program.Sub.Main.Start
v.Local.dYearDate.Declare
F.Intrinsic.Control.Try

	V.Local.sError.Declare(String,"")
	V.Local.sFile.Declare(String,"")
	
	f.Intrinsic.Control.CallSub(checkCustomFolder)

	F.Intrinsic.Control.CallSub(Create_Empty_DTs)
	F.Intrinsic.Control.CallSub(Set_Properties)
	f.Intrinsic.Control.CallSub("Deserialize")
	
	Gui.FormSerialMangement.lblFileDesc.Caption("")
	
	F.Intrinsic.String.Build("{0}\ART\GSS2.ico",V.Caller.GlobalDir,V.Local.sFile)
	gui.FormSerialMangement.htmlContainerDoc.Silent(true)
	gui.FormSerialMangement.htmlContainerDoc.Navigate("about:blank")
	gui.FormSerialMangement.htmlContainerDoc.Navigate(V.Local.sFile,false)
	
	Gui.FormSerialMangement.tab1.SetTab(0)
	f.Intrinsic.Control.CallSub(LoadIcon)
	f.Intrinsic.Control.CallSub(loadCBO)
	f.Intrinsic.Control.CallSub(checkCustomFolder)
	
	f.Intrinsic.Date.DateAdd("YYYY", -1, v.Ambient.Date, v.Local.dYearDate)
	gui.FormSerialMangement.dtp1.Value(v.Local.dYearDate)
	
	gui.FormSerialMangement..Show
	

f.Intrinsic.Control.Catch
	f.Intrinsic.Control.CallSub(ErrorMsg, CurrentSub, v.Ambient.CurrentSubroutine)
f.Intrinsic.Control.EndTry
Program.Sub.Main.End

Program.Sub.checkCustomFolder.Start
v.Local.sFolder.Declare
v.Local.bExists.Declare
v.Local.sText.Declare(String, "")

f.Intrinsic.Control.Try
	f.Intrinsic.String.Build("{0}\CUSTOM\GCG_6544\", v.Caller.GlobalDir, v.Local.sFolder)
	f.Intrinsic.File.DirExists(v.Local.sFolder, v.Local.bExists)
	f.Intrinsic.Control.If(v.Local.bExists.Not)
		f.Intrinsic.File.CreateDir(v.Local.sFolder)
	f.Intrinsic.Control.EndIf
	
'	f.Intrinsic.String.Build("{0}\CUSTOM\GCG_5658\WEB_ORDER\", v.Caller.GlobalDir, v.Local.sFolder)
'	f.Intrinsic.File.DirExists(v.Local.sFolder, v.Local.bExists)
'	f.Intrinsic.Control.If(v.Local.bExists.Not)
'		f.Intrinsic.File.CreateDir(v.Local.sFolder)
'	f.Intrinsic.Control.EndIf	
'	f.Intrinsic.String.Build("WEB ORDER DIRECTORY   = {0}", v.Local.sFolder, v.Local.sText)
'	
'	f.Intrinsic.String.Build("{0}\CUSTOM\GCG_5658\WEB_ERROR\", v.Caller.GlobalDir, v.Local.sFolder)
'	f.Intrinsic.File.DirExists(v.Local.sFolder, v.Local.bExists)
'	f.Intrinsic.Control.If(v.Local.bExists.Not)
'		f.Intrinsic.File.CreateDir(v.Local.sFolder)
'	f.Intrinsic.Control.EndIf	
'	f.Intrinsic.String.Build("{0}{1}WEB ERROR DIRECTORY   = {2}", v.Local.sText, v.Ambient.NewLine, v.Local.sFolder, v.Local.sText)
'	
'	f.Intrinsic.String.Build("{0}\CUSTOM\GCG_5658\CONVERTED\", v.Caller.GlobalDir, v.Local.sFolder)
'	f.Intrinsic.File.DirExists(v.Local.sFolder, v.Local.bExists)
'	f.Intrinsic.Control.If(v.Local.bExists.Not)
'		f.Intrinsic.File.CreateDir(v.Local.sFolder)
'	f.Intrinsic.Control.EndIf
'	f.Intrinsic.String.Build("{0}{1}WEB CONVERTED DIR     = {2}", v.Local.sText, v.Ambient.NewLine, v.Local.sFolder, v.Local.sText)
'	
'	f.Intrinsic.String.Build("{0}\CUSTOM\GCG_5658\UPLOADED\", v.Caller.GlobalDir, v.Local.sFolder)
'	f.Intrinsic.File.DirExists(v.Local.sFolder, v.Local.bExists)
'	f.Intrinsic.Control.If(v.Local.bExists.Not)
'		f.Intrinsic.File.CreateDir(v.Local.sFolder)
'	f.Intrinsic.Control.EndIf
'	f.Intrinsic.String.Build("{0}{1}WEB UPLOADED DIRECTORY= {2}", v.Local.sText, v.Ambient.NewLine, v.Local.sFolder, v.Local.sText)
'	
'	f.Intrinsic.String.Build("{0}{1}EMAIL FROM ADDRESS    =", v.Local.sText, v.Ambient.NewLine, v.Local.sText)
'	f.Intrinsic.String.Build("{0}{1}EMAIL TO ADDRESS      =", v.Local.sText, v.Ambient.NewLine, v.Local.sText)

	
	f.Intrinsic.String.Build("{0}\WEB_ORDERS", v.Caller.GlobalDir, v.Local.sFolder)
	f.Intrinsic.File.DirExists(v.Local.sFolder, v.Local.bExists)
	f.Intrinsic.Control.If(v.Local.bExists.Not)
		f.Intrinsic.File.CreateDir(v.Local.sFolder)
	f.Intrinsic.Control.EndIf	
	f.Intrinsic.String.Build("WEB ORDER DIRECTORY   = {0}", v.Local.sFolder, v.Local.sText)
	
	f.Intrinsic.String.Build("{0}\WEB_ORDERS\WEB_ERROR", v.Caller.GlobalDir, v.Local.sFolder)
	f.Intrinsic.File.DirExists(v.Local.sFolder, v.Local.bExists)
	f.Intrinsic.Control.If(v.Local.bExists.Not)
		f.Intrinsic.File.CreateDir(v.Local.sFolder)
	f.Intrinsic.Control.EndIf	
	f.Intrinsic.String.Build("{0}{1}WEB ERROR DIRECTORY   = {2}", v.Local.sText, v.Ambient.NewLine, v.Local.sFolder, v.Local.sText)
	
	f.Intrinsic.String.Build("{0}\WEB_ORDERS\CONVERTED", v.Caller.GlobalDir, v.Local.sFolder)
	f.Intrinsic.File.DirExists(v.Local.sFolder, v.Local.bExists)
	f.Intrinsic.Control.If(v.Local.bExists.Not)
		f.Intrinsic.File.CreateDir(v.Local.sFolder)
	f.Intrinsic.Control.EndIf
	f.Intrinsic.String.Build("{0}{1}WEB CONVERTED DIR     = {2}", v.Local.sText, v.Ambient.NewLine, v.Local.sFolder, v.Local.sText)
	
	f.Intrinsic.String.Build("{0}\WEB_ORDERS\UPLOADED", v.Caller.GlobalDir, v.Local.sFolder)
	f.Intrinsic.File.DirExists(v.Local.sFolder, v.Local.bExists)
	f.Intrinsic.Control.If(v.Local.bExists.Not)
		f.Intrinsic.File.CreateDir(v.Local.sFolder)
	f.Intrinsic.Control.EndIf
	f.Intrinsic.String.Build("{0}{1}WEB UPLOADED DIRECTORY= {2}", v.Local.sText, v.Ambient.NewLine, v.Local.sFolder, v.Local.sText)
	
	f.Intrinsic.String.Build("{0}{1}EMAIL FROM ADDRESS    = ", v.Local.sText, v.Ambient.NewLine, v.Local.sText)
	f.Intrinsic.String.Build("{0}{1}EMAIL TO ADDRESS      = ", v.Local.sText, v.Ambient.NewLine, v.Local.sText)
	
	f.Intrinsic.String.Build("{0}\GSSPARAM{1}.txt", v.Caller.FilesDir, v.Caller.CompanyCode, v.Local.sFolder)
	f.Intrinsic.File.String2File(v.Local.sFolder, v.Local.sText)
f.Intrinsic.Control.Catch
	f.Intrinsic.Control.CallSub(ErrorMsg, CurrentSub, v.Ambient.CurrentSubroutine)
f.Intrinsic.Control.EndTry
Program.Sub.checkCustomFolder.End

Program.Sub.loadIcon.Start
v.Local.sIcon.Declare
'sets the icon
f.Intrinsic.String.Build("{0}\ART\gss2.ico", v.Caller.GlobalDir, v.Local.sIcon)
gui.FormSerialMangement..Icon(v.Local.sIcon)
Program.Sub.loadIcon.End

Program.Sub.ErrorMsg.Start
v.Local.sError.Declare

'Closes ODBC connection, default to connection : "con"
'f.Intrinsic.Control.If(v.ODBC.con.State, =, 1)
'	f.ODBC.Connection!con.Close
'f.Intrinsic.Control.EndIf

'Generic Error message.
f.Intrinsic.String.Build("Project GCG_6544_CSR_Serialized_Good.g2u {0}{0}Subroutine: {1}{0}Error: {2} with Description: {3}", v.Ambient.NewLine, v.Args.CurrentSub, v.Ambient.ErrorNumber, v.Ambient.ErrorDescription, v.Local.sError)
f.Intrinsic.UI.Msgbox(v.Local.sError)
Program.Sub.ErrorMsg.End

Program.Sub.cmdNewSO_Click.Start
v.Local.iRet.Declare
F.Intrinsic.Control.Try
	f.Global.General.LaunchMenuTask(132, 2, v.Local.iRet)
	
F.Intrinsic.Control.Catch
	f.Intrinsic.Control.CallSub(ErrorMsg, CurrentSub, v.Ambient.CurrentSubroutine)	
F.Intrinsic.Control.EndTry
Program.Sub.cmdNewSO_Click.End

Program.Sub.cmdNewRMA_Click.Start
v.Local.iRet.Declare
F.Intrinsic.Control.Try
	f.Global.General.LaunchMenuTask(399, 0, v.Local.iRet)
	
F.Intrinsic.Control.Catch
	f.Intrinsic.Control.CallSub(ErrorMsg, CurrentSub, v.Ambient.CurrentSubroutine)	
F.Intrinsic.Control.EndTry
Program.Sub.cmdNewRMA_Click.End

Program.Sub.cmdNewCSR_Click.Start
v.Local.iRet.Declare
v.Local.sCustomer.Declare
v.Local.sSerialNumber.Declare
v.Local.sParams.Declare
v.Local.iPID.Declare
v.Local.bCheck.Declare
v.Local.bContains.Declare
v.Local.iCnt.Declare
v.Local.sReturn.Declare
v.Local.sProcess.Declare
v.Local.iCRMHwnd.Declare
v.Local.sSubject.Declare(String, "")
v.Local.sProblem.Declare(String, "")
v.Local.sCustContactNum.Declare
F.Intrinsic.Control.Try

	v.Local.sCustomer.Set(v.Screen.FormSerialMangement!txtCustomer.Text)
	v.Local.sSerialNumber.Set(v.Screen.FormSerialMangement!txtSerial.Text)
	'v.Local.sCustContactNum.Set(v.Screen.FormSerialMangement!txtCustContactNumber.Text)
	
	f.Intrinsic.String.Trim(v.Local.sCustContactNum, v.Local.sCustContactNum)
	f.Intrinsic.Control.If(v.Local.sCustContactNum, =, "")
		v.Local.sCustContactNum.Set("-1")
	f.Intrinsic.Control.EndIf
	
	f.Intrinsic.Task.IsProgramRunning("CRM.exe", v.Local.bCheck)
	
	f.Intrinsic.Control.If(v.Local.bCheck.Not)
		f.Global.General.LaunchMenuTask(243, 0, v.Local.iRet)
		f.Intrinsic.UI.Sleep(15)
	f.Intrinsic.Control.EndIf
	
	f.Intrinsic.Task.IsProgramRunning("CRM.exe", v.Local.bCheck)
	f.Intrinsic.Control.If(v.Local.bCheck)
		f.Intrinsic.Task.GetProcessList(v.Local.sReturn)
		f.Intrinsic.String.Split(v.Local.sReturn, "*!*", v.Local.sReturn)
		f.Intrinsic.Control.For(v.Local.iCnt, 0, v.Local.sReturn.UBound, 1)
			f.Intrinsic.String.Instr(v.Local.sReturn(v.Local.iCnt), "CRM.exe", 0, v.Local.bContains)
			f.Intrinsic.Control.If(v.Local.bContains)
				f.Intrinsic.String.Split(v.Local.sReturn(v.Local.iCnt), "!*!", v.Local.sProcess)
				v.Local.iPID.Set(v.Local.sProcess(0))
				f.Intrinsic.Control.ExitFor(v.Local.iCnt)
			f.Intrinsic.Control.EndIf
		f.Intrinsic.Control.Next(v.Local.iCnt)
		
		f.Intrinsic.Control.If(v.Local.iPID, <>, 0)
			f.Intrinsic.API.GetHandleFromPID(v.Local.iPID, v.Local.iCRMHwnd)
			
			f.Intrinsic.String.Build("MODE::11*!*COMPANY-NUMBER::{0}*!*COMPANY-TYPE::15*!*NEW-CSR::1*!*SUBJECT::*!*PROBLEM::*!*CONTACT::{1}*!*FAX::{2}", v.Local.sCustomer, v.Local.sCustContactNum, v.Local.sSerialNumber, v.Local.sParams)
			'F.Intrinsic.String.Build("MODE::11*!*COMPANY-NUMBER::{0}*!*COMPANY-TYPE::{1}*!*NEW-CSR::0*!*SERV-REQ-NUMBER::{2}",V.Local.sCustomer,V.Local.iType,V.Local.iSRNum,V.Local.sParams)   
			f.Intrinsic.API.ChangeCaption(v.Local.iCRMHwnd, v.Local.sParams)
		f.Intrinsic.Control.EndIf
	f.Intrinsic.Control.EndIf

	'f.Global.General.LaunchMenuTask(250, 0, v.Local.iRet)
	
F.Intrinsic.Control.Catch
	f.Intrinsic.Control.CallSub(ErrorMsg, CurrentSub, v.Ambient.CurrentSubroutine)	
F.Intrinsic.Control.EndTry
Program.Sub.cmdNewCSR_Click.End

Program.Sub.FormSerialMangement_UnLoad.Start
f.Intrinsic.Control.Try
	f.Intrinsic.Control.CallSub("Serialize")
	f.Intrinsic.Control.End
f.Intrinsic.Control.Catch
	f.Intrinsic.Control.CallSub(ErrorMsg, CurrentSub, v.Ambient.CurrentSubroutine)
f.Intrinsic.Control.EndTry
Program.Sub.FormSerialMangement_UnLoad.End

Program.Sub.GsGridControlDoc_RowCellClick.Start
F.Intrinsic.Control.Try
	
	V.Local.sError.Declare(String,"")
	V.Local.sFile.Declare(String,"")
	
	'f.Intrinsic.Control.BlockEvents
	gui.FormSerialMangement.lbl1.Caption("0%")
	gui.FormSerialMangement.pBar1.Value(0)
	
	F.Intrinsic.String.Build("{0}{1}",V.DataTable.Doc(V.Args.RowIndex).Path!FieldValTrim,V.DataTable.Doc(V.Args.RowIndex).File!FieldValTrim,V.Local.sFile)
	gui.FormSerialMangement.pBar1.Value(40)
	gui.FormSerialMangement.lbl1.Caption("40%")
	Gui.FormSerialMangement.lblFileDesc.Caption(V.DataTable.Doc(V.Args.RowIndex).Description!FieldValTrim)
	gui.FormSerialMangement.pBar1.Value(80)
	gui.FormSerialMangement.lbl1.Caption("80%")
	gui.FormSerialMangement.htmlContainerDoc.Navigate(V.Local.sFile,false)
	gui.FormSerialMangement.pBar1.Value(100)
	gui.FormSerialMangement.lbl1.Caption("100%")
	'f.Intrinsic.Control.UnBlockEvents
	
	F.Intrinsic.Control.ExitSub
	
F.Intrinsic.Control.Catch
	f.Intrinsic.Control.CallSub(ErrorMsg, CurrentSub, v.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.GsGridControlDoc_RowCellClick.End

Program.Sub.Create_Empty_DTs.Start
F.Intrinsic.Control.Try
	V.Local.sError.Declare(String,"")
	V.Local.sSql.Declare(String,"")
	V.Local.i.Declare(Long,0)
	V.Local.dDate.Declare(Date,V.Ambient.Date)
	V.Local.iMonth.Declare(Long,0)
	V.Local.sStatus.Declare(String,"")
	v.Local.sRet.Declare
	
	v.Local.iCnt.Declare
	v.Local.sSerialCheck.Declare
	v.Local.sDateCheck.Declare
	
'	f.Intrinsic.Control.If(v.ODBC.con.State, =, 1)
'		f.ODBC.Connection!con.Close
'	f.Intrinsic.Control.EndIf

	f.Data.Datatable.Create("regDT", True)
	f.Data.Datatable.AddColumn("regDT", "Title", "String")
	f.Data.Datatable.AddColumn("regDT", "Value", "String")
	f.Data.DataView.Create("regDT", "regDV", 22)
	
	
	f.ODBC.Connection!con.OpenCompanyConnection
'*****************************************************************************CHECK
'	f.Intrinsic.String.Build("Select right(Reference,7) as Ref, rtrim(Serial_Number) as Serial, rtrim(Customer) as Customer, rtrim(Customer) as Name_Customer,  rtrim(Customer) as Warranty_Code,'' as Status, Date_History, Date_History as Date_Warranty, Part From V_Item_History Where Code_Transaction = 'O35' and Serial_Number <> ''", V.Local.sSql)
	'v.Local.sSql.Set("Select right(Reference,7) as Ref, rtrim(Serial_Number) as Serial, rtrim(Customer) as Customer, rtrim(Customer) as Name_Customer,  rtrim(Customer) as Warranty_Code,'' as Status, Date_History, Date_History as Date_Warranty, Part From V_Item_History Where Code_Transaction = 'O35' and Serial_Number <> '' and part = ''")
	'Change on 12/31/2021
	v.Local.sSql.Set("Select Order_no as Ref, rTrim(Serial) as Serial, if(Customer = '', Purch_From_Id, Customer) as Customer, if(Customer = '', Purch_From_Id, Customer) as Name_Customer, if(Customer = '', Purch_From_Id, Customer) as Warranty_Code,'' as Status, DATE_WARRANTY_CHG as Date_History, DATE_WARRANTY_CHG as Date_Warranty, Part from V_WARRANTY where Serial = '-1'")
	f.Data.DataTable.CreateFromSQL("Serv","con",V.Local.sSql,True)
	
	'Changes 1/17/2020 Adding part number and Description
	'f.Data.DataTable.AddColumn("Serv", "Part", "String")
	f.Data.DataTable.AddColumn("Serv", "Description", "String")
	'f.Data.DataTable.AddExpressionColumn("Serv", "KeyField", "String", "IFF(Ref = '', Serial, Ref)")
	
	f.Data.Dictionary.CreateFromSQL("warrantyDict", "con", "select Customer, C_Sort_1 from CUSTOMER_SALES where customer = '{0}' and rec = '2'")
	f.Data.Dictionary.SetDefaultReturn("warrantyDict", "")
	f.Data.DataTable.SetValueFormat("Serv", -1, "Warranty_Code", "Warranty_Code", ">")
	f.Data.DataTable.FillFromDictionary("Serv", "warrantyDict", "Warranty_Code", "Warranty_Code")
	f.Data.Dictionary.Close("warrantyDict")
	
'	f.Data.Dictionary.CreateFromSQL("termsDict", "con", "select Terms from GCG_5530_Warranty where Warranty_Code = {0}")
'	f.Data.Dictionary.SetDefaultReturn("warrantyDict", 0)
	
	
	f.Data.DataTable.SetValueFormat("Serv", -1, "Name_Customer", "Name_Customer", ">")
	f.Data.Dictionary.CreateFromSQL("servDict", "con", "Select rtrim(Customer) as Customer, Name_Customer from V_Customer_Master")
	f.Data.Dictionary.SetDefaultReturn("servDict", "")
	f.Data.DataTable.FillFromDictionary("Serv", "servDict", "Name_Customer", "Name_Customer")
	f.Data.Dictionary.Close("servDict")
	
'	f.Data.DataTable.Create("Serv", true)
'	f.Data.DataTable.AddColumn("Serv", "Ref", "String")
'	f.Data.DataTable.AddColumn("Serv", "Serial", "String")
'	f.Data.DataTable.AddColumn("Serv", "Customer", "String")
'	f.Data.DataTable.AddColumn("Serv", "Name_Customer", "String")
'	f.Data.DataTable.AddColumn("Serv", "Status", "String")
'	f.Data.DataTable.AddColumn("Serv", "Date_History", "Date")
'	f.Data.DataTable.AddColumn("Serv", "Date_Warranty", "Date")
'	f.Data.DataTable.AddColumn("Serv", "Part", "String")
	f.Data.DataView.Create("Serv", "ServDV", 22)
	
	F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.Serv.RowCount--,1)
'		F.Intrinsic.String.Build("Select Term_Months From OE_Warranty_Trms a Join V_Inventory_Mst2 b On a.Key_Type = b.Warranty_Type Where Part = '{0}'",V.DataTable.Serv(V.Local.i).Part!FieldValTrim,V.Local.sSql)
'		F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.iMonth)
		
		v.Local.iMonth.Set(0)
		f.Intrinsic.String.Build("select Terms from GCG_5530_Warranty where Warranty_Code = '{0}'", v.DataTable.Serv(V.Local.i).Warranty_Code!FieldValTrim, v.Local.sSql)
		f.ODBC.Connection!con.ExecuteAndReturn(v.Local.sSql, v.Local.iMonth)		
		
		F.Intrinsic.Date.DateAdd("M",V.Local.iMonth,V.DataTable.Serv(V.Local.i).Date_History!FieldVal,V.Local.dDate)
		
		F.Intrinsic.Control.If(V.Local.dDate,>,V.Ambient.Date)
			V.Local.sStatus.Set("Open")
		F.Intrinsic.Control.Else
			V.Local.sStatus.Set("Closed")
		F.Intrinsic.Control.EndIf
		F.Data.DataTable.SetValue("Serv",V.Local.i,"Date_Warranty",V.Local.dDate,"Status",V.Local.sStatus)
	F.Intrinsic.Control.Next(V.Local.i)
	
	'F.Data.DataTable.RemoveColumn("Serv","Part")
	
	F.Intrinsic.String.Build("Select Path, File, Description From ATG_Doc_Assoc Where Link_ID = -1","",V.Local.sSql)
	F.Data.DataTable.CreateFromSQL("Doc","con",V.Local.sSql,True)
	
	F.Intrinsic.String.Build("Select * From GCG_6544_SO_INCIDENT Where Order_No = '-1'","",V.Local.sSql)
	
	F.Data.DataTable.CreateFromSQL("OrigSO","con",V.Local.sSql,True)
	'f.Data.DataTable.AddColumn("OrigSO", "Quote", "String")
	
	F.Intrinsic.String.Build("Select Invoice, Order_No, Record_No as Order_Line, Part, Description, '' as PO, '' as PO_Line, user_3 as SO_Type From V_Order_Lines Where Order_No = '-1'","",V.Local.sSql)
	F.Data.DataTable.CreateFromSQL("ServSO","con",V.Local.sSql,True)
	
	F.Intrinsic.String.Build("Select 'Delete' as Delete_Col, Serial, Part, Date_warranty_chg as Date_Warranty, Time_warranty_chg as Time_Warranty, Order_no, Order_suffix, Order_line, Invoice, Date_Purchased, Date_Expiration, if(Customer = '', Purch_From_Id, Customer) as Customer, Purch_From_Id, End_User_Name, Address_1, Address_2, City, State, Zip, Country, County, Attention, Phone, Fax, Email From V_WARRANTY Where Serial = '{0}'","-1",V.Local.sSql)
	F.Data.DataTable.CreateFromSQL("ServHist","con",V.Local.sSql,True)
	f.Data.DataTable.AddColumn("ServHist", "Notes", "String")
	
	F.Intrinsic.String.Build("Select Serial, Part, Text From WARRANTY_COMMENTS where serial = '-1'","",V.Local.sSql)
	v.Local.sSql.Set("Select * from RMA_HIST_LINES where rma_id = '-1'")
	F.Data.DataTable.CreateFromSQL("Event","con",V.Local.sSql,True)
	
	f.Intrinsic.String.Build("Select Job, Suffix, Order_no, Order_line, Part, Description from Order_to_wo where Order_No+Order_Line in (Select Order_No+Record_No from V_Order_Lines where Order_no in (Select distinct Order_No from V_Order_Header where User_1 = '{0}')) ", "-1", v.Local.sSQL)
	f.Data.DataTable.CreateFromSQL("orderToWoDT", "con", v.Local.sSQL, true)
	
	F.Intrinsic.String.Build("Select Job, Suffix, Seq, '' Job_Part, '' as SerialNumber, Part, Description, '' as Warranty, HOURS_WORKED as Quantity From V_Job_Detail Where Job = '-1'","",V.Local.sSql)
	F.Data.DataTable.CreateFromSQL("WOBOM","con",V.Local.sSql,True)
	f.Data.Datatable.AddColumn("WOBOM", "Selected", "Boolean", False)
	f.Data.DataView.Create("WOBOM", "WOSelectedDV", 22, "Selected = 'True'", "")
	
	'F.Intrinsic.String.Build("Select Job, Suffix, Seq, '' Job_Part, '' as SerialNumber, Part, Description, '' as Warranty, '' as Quantity From V_Job_Detail Where Job = '-1'","",V.Local.sSql) GsGridControlOrigSO
	F.Data.DataTable.CreateFromSQL("orderToWoDT$ChildWO","con",V.Local.sSql,True)
	
	f.Data.DataTable.AddRelation("orderToWoDT", "Job*!*Suffix", "orderToWoDT$ChildWO", "Job*!*Suffix")
	f.Data.DataView.Create("orderToWoDT$ChildWO", "ChildDV", 22)
	
	
	
	F.ODBC.Connection!con.Close
	F.Intrinsic.Control.ExitSub
	
F.Intrinsic.Control.Catch
	f.Intrinsic.Control.CallSub(ErrorMsg, CurrentSub, v.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.Create_Empty_DTs.End

Program.Sub.Set_Properties.Start
v.Local.iCnt.Declare
v.Local.sFields.Declare
F.Intrinsic.Control.Try
	V.Local.sError.Declare(String,"")
	
	gui.F_Registration.GsGcReg.AddGridviewFromDataview("regGV", "regDT", "regDV")
	Gui.F_Registration.GsGcReg.SetGridviewProperty("regGV", "OptionsViewColumnAutoWidth", false)
	gui.F_Registration.GsGcReg.BestFitColumns("regGV")
	
	Gui.F_Registration.GsGcReg.SetColumnProperty("regGV", "Title", "HeaderBackColor", v.Color.GSS)
	Gui.F_Registration.GsGcReg.SetColumnProperty("regGV", "Title", "HeaderForeColor", "White")
	Gui.F_Registration.GsGcReg.SetColumnProperty("regGV", "Value", "HeaderBackColor", v.Color.GSS)
	Gui.F_Registration.GsGcReg.SetColumnProperty("regGV", "Value", "HeaderForeColor", "White")
	
	Gui.F_Registration.GsGcReg.SetColumnProperty("regGV", "Value", "ReadOnly", False)
	Gui.F_Registration.GsGcReg.SetColumnProperty("regGV", "Value", "AllowEdit", True)
	
	Gui.F_Registration.GsGcReg.MainView("regGV")
	
	Gui.FormSerialMangement.GsGridControlSERV.AddGridviewFromDataview("GServ", "Serv", "ServDV")
	Gui.FormSerialMangement.GsGridControlSERV.SetGridviewProperty("GServ", "OptionsViewColumnAutoWidth", false)
	gui.FormSerialMangement.GsGridControlSERV.BestFitColumns("GServ")
	
	Gui.FormSerialMangement.GsGridControlSERV.SetGridviewProperty("GServ","ReadOnly",True)
	Gui.FormSerialMangement.GsGridControlSERV.SetGridviewProperty("GServ","Editable",False)
	Gui.FormSerialMangement.GsGridControlSERV.SetGridviewProperty("GServ","OptionsViewShowAutoFilterRow",True)
	Gui.FormSerialMangement.GsGridControlSERV.SetGridviewProperty("GServ","Enableappearanceoddrow",True)
	'Gui.FormSerialMangement.GsGridControlSERV.SetGridviewProperty("GServ","OptionsFindAlwaysVisible",True)
	
	Gui.FormSerialMangement.GsGridControlSERV.SetColumnProperty("GServ","Ref","Caption","Ref")
	Gui.FormSerialMangement.GsGridControlSERV.SetColumnProperty("GServ","Serial","Caption","Serial No:")
	Gui.FormSerialMangement.GsGridControlSERV.SetColumnProperty("GServ","Customer","Caption","Customer")
	Gui.FormSerialMangement.GsGridControlSERV.SetColumnProperty("GServ","Name_Customer","Caption","Customer Name")
	Gui.FormSerialMangement.GsGridControlSERV.SetColumnProperty("Gserv","STATUS","Caption","Status")
	Gui.FormSerialMangement.GsGridControlSERV.SetColumnProperty("Gserv","Date_History","Caption","Ship Date")
	Gui.FormSerialMangement.GsGridControlSERV.SetColumnProperty("Gserv","Date_Warranty","Caption","Warranty End Date")
	Gui.FormSerialMangement.GsGridControlSERV.SetColumnProperty("Gserv","Warranty_Code","Caption","Warranty Code")
	
	Gui.FormSerialMangement.GsGridControlSERV.SetColumnProperty("Gserv","STATUS","Visible",False)
	
	Gui.FormSerialMangement.GsGridControlSERV.SetColumnProperty("Gserv","Ref","VisibleIndex", 0)
	Gui.FormSerialMangement.GsGridControlSERV.SetColumnProperty("Gserv","Serial","VisibleIndex", 1)
	Gui.FormSerialMangement.GsGridControlSERV.SetColumnProperty("Gserv","Part","VisibleIndex", 2)
	Gui.FormSerialMangement.GsGridControlSERV.SetColumnProperty("Gserv","Description","VisibleIndex", 3)
	Gui.FormSerialMangement.GsGridControlSERV.SetColumnProperty("Gserv","Customer","VisibleIndex", 4)
	Gui.FormSerialMangement.GsGridControlSERV.SetColumnProperty("Gserv","Name_Customer","VisibleIndex", 5)
	Gui.FormSerialMangement.GsGridControlSERV.SetColumnProperty("Gserv","Date_History","VisibleIndex", 6)
	Gui.FormSerialMangement.GsGridControlSERV.SetColumnProperty("Gserv","Warranty_Code","VisibleIndex", 7)
	Gui.FormSerialMangement.GsGridControlSERV.SetColumnProperty("Gserv","Date_Warranty","VisibleIndex", 8)
	
	Gui.FormSerialMangement.GsGridControlSERV.SetColumnProperty("GServ","Ref","HeaderBackColor",v.Color.GSS)
	Gui.FormSerialMangement.GsGridControlSERV.SetColumnProperty("GServ","Ref","HeaderForeColor","White")
	Gui.FormSerialMangement.GsGridControlSERV.SetColumnProperty("GServ","Serial","HeaderBackColor",v.Color.GSS)
	Gui.FormSerialMangement.GsGridControlSERV.SetColumnProperty("GServ","Serial","HeaderForeColor","White")
	Gui.FormSerialMangement.GsGridControlSERV.SetColumnProperty("GServ","Customer","HeaderBackColor",v.Color.GSS)
	Gui.FormSerialMangement.GsGridControlSERV.SetColumnProperty("GServ","Customer","HeaderForeColor","White")
	Gui.FormSerialMangement.GsGridControlSERV.SetColumnProperty("GServ","Name_Customer","HeaderBackColor",v.Color.GSS)
	Gui.FormSerialMangement.GsGridControlSERV.SetColumnProperty("GServ","Name_Customer","HeaderForeColor","White")
	Gui.FormSerialMangement.GsGridControlSERV.SetColumnProperty("GServ","STATUS","HeaderBackColor",v.Color.GSS)
	Gui.FormSerialMangement.GsGridControlSERV.SetColumnProperty("GServ","STATUS","HeaderForeColor","White")
	Gui.FormSerialMangement.GsGridControlSERV.SetColumnProperty("GServ","Date_History","HeaderBackColor",v.Color.GSS)
	Gui.FormSerialMangement.GsGridControlSERV.SetColumnProperty("GServ","Date_History","HeaderForeColor","White")
	Gui.FormSerialMangement.GsGridControlSERV.SetColumnProperty("GServ","Date_Warranty","HeaderBackColor",v.Color.GSS)
	Gui.FormSerialMangement.GsGridControlSERV.SetColumnProperty("GServ","Date_Warranty","HeaderForeColor","White")
	Gui.FormSerialMangement.GsGridControlSERV.SetColumnProperty("GServ","Warranty_Code","HeaderBackColor",v.Color.GSS)
	Gui.FormSerialMangement.GsGridControlSERV.SetColumnProperty("GServ","Warranty_Code","HeaderForeColor","White")
	
	Gui.FormSerialMangement.GsGridControlSERV.SetColumnProperty("GServ","Part","HeaderBackColor",v.Color.GSS)
	Gui.FormSerialMangement.GsGridControlSERV.SetColumnProperty("GServ","Part","HeaderForeColor","White")
	Gui.FormSerialMangement.GsGridControlSERV.SetColumnProperty("GServ","Description","HeaderBackColor",v.Color.GSS)
	Gui.FormSerialMangement.GsGridControlSERV.SetColumnProperty("GServ","Description","HeaderForeColor","White")
	
	gui.FormSerialMangement.GsGridControlSERV.SetColumnProperty("GServ", "Ref", "Visible", false)
	
	Gui.FormSerialMangement.GsGridControlSERV.SetColumnProperty("GServ","Date_History","DisplayCustomDatetime","d")
	Gui.FormSerialMangement.GsGridControlSERV.SetColumnProperty("GServ","Date_Warranty","DisplayCustomDatetime","d")
	
	Gui.FormSerialMangement.GsGridControlSERV.MainView("GServ")
	
	Gui.FormSerialMangement.GsGridControlDoc.AddGridviewFromDatatable("GDoc","Doc")
	Gui.FormSerialMangement.GsGridControlDoc.SetGridviewProperty("GDoc", "OptionsViewColumnAutoWidth", false)
	gui.FormSerialMangement.GsGridControlDoc.BestFitColumns("GDoc")
	
	Gui.FormSerialMangement.GsGridControlDoc.SetGridviewProperty("GDoc","ReadOnly",True)
	Gui.FormSerialMangement.GsGridControlDoc.SetGridviewProperty("GDoc","Editable",False)
	
	Gui.FormSerialMangement.GsGridControlDoc.SetColumnProperty("GDoc","Path","Caption","Path")
	Gui.FormSerialMangement.GsGridControlDoc.SetColumnProperty("GDoc","Path","Visible",False)
	Gui.FormSerialMangement.GsGridControlDoc.SetColumnProperty("GDoc","File","Caption","File")
	Gui.FormSerialMangement.GsGridControlDoc.SetColumnProperty("GDoc","File","Visible",False)
	Gui.FormSerialMangement.GsGridControlDoc.SetColumnProperty("GDoc","Description","Caption","Description")
	
	Gui.FormSerialMangement.GsGridControlDoc.SetColumnProperty("GDoc","Path","HeaderBackColor",v.Color.GSS)
	Gui.FormSerialMangement.GsGridControlDoc.SetColumnProperty("GDoc","Path","HeaderForeColor","White")
	Gui.FormSerialMangement.GsGridControlDoc.SetColumnProperty("GDoc","File","HeaderBackColor",v.Color.GSS)
	Gui.FormSerialMangement.GsGridControlDoc.SetColumnProperty("GDoc","File","HeaderForeColor","White")
	Gui.FormSerialMangement.GsGridControlDoc.SetColumnProperty("GDoc","Description","HeaderBackColor",v.Color.GSS)
	Gui.FormSerialMangement.GsGridControlDoc.SetColumnProperty("GDoc","Description","HeaderForeColor","White")
	
	Gui.FormSerialMangement.GsGridControlDoc.MainView("GDoc")  
	
	Gui.FormSerialMangement.GsGridControlbomWOBOM.AddGridviewFromDatatable("GWOBOM","WOBOM")
	Gui.FormSerialMangement.GsGridControlbomWOBOM.SetGridviewProperty("GWOBOM", "OptionsViewColumnAutoWidth", false)
	gui.FormSerialMangement.GsGridControlbomWOBOM.BestFitColumns("GWOBOM")
	
'	Gui.FormSerialMangement.GsGridControlbomWOBOM.SetGridviewProperty("GWOBOM","ReadOnly",True)
'	Gui.FormSerialMangement.GsGridControlbomWOBOM.SetGridviewProperty("GWOBOM","Editable",False)

	Gui.FormSerialMangement.GsGridControlbomWOBOM.SetColumnProperty("GWOBOM", "Selected", "ReadOnly",False)
	Gui.FormSerialMangement.GsGridControlbomWOBOM.SetColumnProperty("GWOBOM", "Selected", "AllowEdit",True)
	Gui.FormSerialMangement.GsGridControlbomWOBOM.SetColumnProperty("GWOBOM", "Quantity", "ReadOnly",False)
	Gui.FormSerialMangement.GsGridControlbomWOBOM.SetColumnProperty("GWOBOM", "Quantity", "AllowEdit",True)
	Gui.FormSerialMangement.GsGridControlbomWOBOM.SetColumnProperty("GWOBOM", "Selected", "VisibleIndex", 0)
	Gui.FormSerialMangement.GsGridControlbomWOBOM.SetGridviewProperty("GWOBOM","OptionsSelectionEnableAppearanceFocusedRow",False)
	
	Gui.FormSerialMangement.GsGridControlbomWOBOM.SetColumnProperty("GWOBOM","Job","Caption","Job")
	Gui.FormSerialMangement.GsGridControlbomWOBOM.SetColumnProperty("GWOBOM","Suffix","Caption","Suffix")
	Gui.FormSerialMangement.GsGridControlbomWOBOM.SetColumnProperty("GWOBOM","Seq","Caption","Seq")
	Gui.FormSerialMangement.GsGridControlbomWOBOM.SetColumnProperty("GWOBOM","Job_Part","Caption","Job Part")
	Gui.FormSerialMangement.GsGridControlbomWOBOM.SetColumnProperty("GWOBOM","Part","Caption","Part")
	Gui.FormSerialMangement.GsGridControlbomWOBOM.SetColumnProperty("GWOBOM","Description","Caption","Description")
	Gui.FormSerialMangement.GsGridControlbomWOBOM.SetColumnProperty("GWOBOM","Warranty","Caption","Warranty")
	Gui.FormSerialMangement.GsGridControlbomWOBOM.SetColumnProperty("GWOBOM","SerialNumber","Caption","Serial Number")
	Gui.FormSerialMangement.GsGridControlbomWOBOM.SetColumnProperty("GWOBOM","Quantity","Caption","Quantity")
	
	gui.FormSerialMangement.GsGridControlbomWOBOM.SetColumnProperty("GWOBOM", "Job", "CellForeColor", v.Color.LtBlue)
	gui.FormSerialMangement.GsGridControlbomWOBOM.SetColumnProperty("GWOBOM", "Suffix", "CellForeColor", v.Color.LtBlue)
	gui.FormSerialMangement.GsGridControlbomWOBOM.SetColumnProperty("GWOBOM", "Part", "CellForeColor", v.Color.LtBlue)
	Gui.FormSerialMangement.GsGridControlbomWOBOM.SetColumnProperty("GWOBOM", "Job_Part", "CellForeColor", v.Color.LtBlue)
	
	Gui.FormSerialMangement.GsGridControlbomWOBOM.SetColumnProperty("GWOBOM","Warranty","Visible",False)
	Gui.FormSerialMangement.GsGridControlbomWOBOM.SetColumnProperty("GWOBOM","Selected","HeaderBackColor",v.Color.GSS)
	Gui.FormSerialMangement.GsGridControlbomWOBOM.SetColumnProperty("GWOBOM","Selected","HeaderForeColor","White")
	Gui.FormSerialMangement.GsGridControlbomWOBOM.SetColumnProperty("GWOBOM","Job","HeaderBackColor",v.Color.GSS)
	Gui.FormSerialMangement.GsGridControlbomWOBOM.SetColumnProperty("GWOBOM","Job","HeaderForeColor","White")
	Gui.FormSerialMangement.GsGridControlbomWOBOM.SetColumnProperty("GWOBOM","Suffix","HeaderBackColor",v.Color.GSS)
	Gui.FormSerialMangement.GsGridControlbomWOBOM.SetColumnProperty("GWOBOM","Suffix","HeaderForeColor","White")
	Gui.FormSerialMangement.GsGridControlbomWOBOM.SetColumnProperty("GWOBOM","Part","HeaderBackColor",v.Color.GSS)
	Gui.FormSerialMangement.GsGridControlbomWOBOM.SetColumnProperty("GWOBOM","Part","HeaderForeColor","White")
	Gui.FormSerialMangement.GsGridControlbomWOBOM.SetColumnProperty("GWOBOM","Description","HeaderBackColor",v.Color.GSS)
	Gui.FormSerialMangement.GsGridControlbomWOBOM.SetColumnProperty("GWOBOM","Description","HeaderForeColor","White")
	Gui.FormSerialMangement.GsGridControlbomWOBOM.SetColumnProperty("GWOBOM","Warranty","HeaderBackColor",v.Color.GSS)
	Gui.FormSerialMangement.GsGridControlbomWOBOM.SetColumnProperty("GWOBOM","Warranty","HeaderForeColor","White")
	Gui.FormSerialMangement.GsGridControlbomWOBOM.SetColumnProperty("GWOBOM","Seq","HeaderBackColor",v.Color.GSS)
	Gui.FormSerialMangement.GsGridControlbomWOBOM.SetColumnProperty("GWOBOM","Seq","HeaderForeColor","White")
	Gui.FormSerialMangement.GsGridControlbomWOBOM.SetColumnProperty("GWOBOM","Job_Part","HeaderBackColor",v.Color.GSS)
	Gui.FormSerialMangement.GsGridControlbomWOBOM.SetColumnProperty("GWOBOM","Job_Part","HeaderForeColor","White")
	Gui.FormSerialMangement.GsGridControlbomWOBOM.SetColumnProperty("GWOBOM","SerialNumber","HeaderBackColor",v.Color.GSS)
	Gui.FormSerialMangement.GsGridControlbomWOBOM.SetColumnProperty("GWOBOM","SerialNumber","HeaderForeColor","White")
	Gui.FormSerialMangement.GsGridControlbomWOBOM.SetColumnProperty("GWOBOM","Quantity","HeaderBackColor",v.Color.GSS)
	Gui.FormSerialMangement.GsGridControlbomWOBOM.SetColumnProperty("GWOBOM","Quantity","HeaderForeColor","White")
	
	gui.FormSerialMangement.GsGridControlbomWOBOM.SetGridviewProperty("GWOBOM", "OptionsViewShowAutoFilterRow", True)
'	Gui.FormSerialMangement.GsGridControlbomWOBOM.SetColumnProperty("GWOBOM","Job","MinWidth","30")
'	Gui.FormSerialMangement.GsGridControlbomWOBOM.SetColumnProperty("GWOBOM","Suffix","MinWidth","30")
'	Gui.FormSerialMangement.GsGridControlbomWOBOM.SetColumnProperty("GWOBOM","Seq","MinWidth","30")
'	Gui.FormSerialMangement.GsGridControlbomWOBOM.SetColumnProperty("GWOBOM","Job_Part","MinWidth","30")
'	Gui.FormSerialMangement.GsGridControlbomWOBOM.SetColumnProperty("GWOBOM","Part","MinWidth","30")
'	Gui.FormSerialMangement.GsGridControlbomWOBOM.SetColumnProperty("GWOBOM","SerialNumber","MinWidth","30")
	
	Gui.FormSerialMangement.GsGridControlbomWOBOM.AddStyleFormatCondition("GWOBOM","Warranty","ParentGreen","Equal","Y")
    	Gui.FormSerialMangement.GsGridControlbomWOBOM.SetStyleFormatConditionProperty("GWOBOM","Warranty","ParentGreen","BackColor", v.Color.LtGreen)
    	Gui.FormSerialMangement.GsGridControlbomWOBOM.SetStyleFormatConditionProperty("GWOBOM","Warranty","ParentGreen","ApplyToRow",True)
    
	Gui.FormSerialMangement.GsGridControlbomWOBOM.MainView("GWOBOM")
	
	Gui.FormSerialMangement.GsGridControlOrigSO.AddGridviewFromDatatable("GOrigSO","OrigSO")
	Gui.FormSerialMangement.GsGridControlOrigSO.SetGridviewProperty("GOrigSO", "OptionsViewColumnAutoWidth", false)
	gui.FormSerialMangement.GsGridControlOrigSO.BestFitColumns("GOrigSO")
	
	Gui.FormSerialMangement.GsGridControlOrigSO.SetGridviewProperty("GOrigSO","ReadOnly",True)
	Gui.FormSerialMangement.GsGridControlOrigSO.SetGridviewProperty("GOrigSO","Editable",False)
	Gui.FormSerialMangement.GsGridControlOrigSO.SetGridviewProperty("GOrigSO","OptionsSelectionEnableAppearanceFocusedRow",False)
	
	
	Gui.FormSerialMangement.GsGridControlOrigSO.SetColumnProperty("GOrigSO","Order_No","Caption","SO #")
	Gui.FormSerialMangement.GsGridControlOrigSO.SetColumnProperty("GOrigSO","Incident_Type","Caption","Generic Reason")
	Gui.FormSerialMangement.GsGridControlOrigSO.SetColumnProperty("GOrigSO","Incident","Caption","Specific Reason")
	Gui.FormSerialMangement.GsGridControlOrigSO.SetColumnProperty("GOrigSO","Notes","Caption","Notes")
	Gui.FormSerialMangement.GsGridControlOrigSO.SetColumnProperty("GOrigSO","Serial_no","Caption","Serial #")
	Gui.FormSerialMangement.GsGridControlOrigSO.SetColumnProperty("GOrigSO","Incident_ID","Caption","ID")
'	
	Gui.FormSerialMangement.GsGridControlOrigSO.SetColumnProperty("GOrigSO","Order_No","HeaderBackColor",v.Color.GSS)
	Gui.FormSerialMangement.GsGridControlOrigSO.SetColumnProperty("GOrigSO","Order_No","HeaderForeColor","White")
	Gui.FormSerialMangement.GsGridControlOrigSO.SetColumnProperty("GOrigSO","Incident_Type","HeaderBackColor",v.Color.GSS)
	Gui.FormSerialMangement.GsGridControlOrigSO.SetColumnProperty("GOrigSO","Incident_Type","HeaderForeColor","White")
	Gui.FormSerialMangement.GsGridControlOrigSO.SetColumnProperty("GOrigSO","Incident","HeaderBackColor",v.Color.GSS)
	Gui.FormSerialMangement.GsGridControlOrigSO.SetColumnProperty("GOrigSO","Incident","HeaderForeColor","White")
	Gui.FormSerialMangement.GsGridControlOrigSO.SetColumnProperty("GOrigSO","Notes","HeaderBackColor",v.Color.GSS)
	Gui.FormSerialMangement.GsGridControlOrigSO.SetColumnProperty("GOrigSO","Notes","HeaderForeColor","White")
	Gui.FormSerialMangement.GsGridControlOrigSO.SetColumnProperty("GOrigSO","Serial_no","HeaderBackColor",v.Color.GSS)
	Gui.FormSerialMangement.GsGridControlOrigSO.SetColumnProperty("GOrigSO","Serial_no","HeaderForeColor","White")
	Gui.FormSerialMangement.GsGridControlOrigSO.SetColumnProperty("GOrigSO","Incident_ID","HeaderBackColor",v.Color.GSS)
	Gui.FormSerialMangement.GsGridControlOrigSO.SetColumnProperty("GOrigSO","Incident_ID","HeaderForeColor","White")
	
	Gui.FormSerialMangement.GsGridControlOrigSO.SetColumnProperty("GOrigSO","Incident_ID","VisibleIndex",0)
	Gui.FormSerialMangement.GsGridControlOrigSO.SetColumnProperty("GOrigSO","Serial_No","VisibleIndex",1)
	'gui.FormSerialMangement.GsGridControlOrigSO.SetColumnProperty("GOrigSO", "Part", "CellForeColor", v.Color.LtBlue)
'	gui.FormSerialMangement.GsGridControlOrigSO.SetColumnProperty("GOrigSO", "Order_No", "CellForeColor", v.Color.LtBlue)
'	gui.FormSerialMangement.GsGridControlOrigSO.SetColumnProperty("GOrigSO", "Part", "CellForeColor", v.Color.LtBlue)
'	gui.FormSerialMangement.GsGridControlOrigSO.SetColumnProperty("GOrigSO", "Quote", "CellForeColor", v.Color.LtBlue)
	
	Gui.FormSerialMangement.GsGridControlOrigSO.MainView("GOrigSO")
	
	Gui.FormSerialMangement.GsGridControlServSO.AddGridviewFromDatatable("GServSO","ServSO")
	Gui.FormSerialMangement.GsGridControlServSO.SetGridviewProperty("GServSO", "OptionsViewColumnAutoWidth", false)
	gui.FormSerialMangement.GsGridControlServSO.BestFitColumns("GServSO")
	
	Gui.FormSerialMangement.GsGridControlServSO.SetGridviewProperty("GServSO","ReadOnly",True)
	Gui.FormSerialMangement.GsGridControlServSO.SetGridviewProperty("GServSO","Editable",False)
	
	Gui.FormSerialMangement.GsGridControlServSO.SetGridviewProperty("GServSO","OptionsSelectionEnableAppearanceFocusedRow",False)
	
	Gui.FormSerialMangement.GsGridControlServSO.SetColumnProperty("GServSO","Order_No","Caption","SO #")
	Gui.FormSerialMangement.GsGridControlServSO.SetColumnProperty("GServSO","Order_Line","Caption","SO Line")
	Gui.FormSerialMangement.GsGridControlServSO.SetColumnProperty("GServSO","Part","Caption","Part")
	Gui.FormSerialMangement.GsGridControlServSO.SetColumnProperty("GServSO","Description","Caption","Description")
	Gui.FormSerialMangement.GsGridControlServSO.SetColumnProperty("GServSO","PO","Caption","PO #")
	Gui.FormSerialMangement.GsGridControlServSO.SetColumnProperty("GServSO","PO_Line","Caption","PO Line")
	Gui.FormSerialMangement.GsGridControlServSO.SetColumnProperty("GServSO","Invoice","Caption","Invoice")
	Gui.FormSerialMangement.GsGridControlServSO.SetColumnProperty("GServSO","SO_Type","Caption","SO Type")
	
	Gui.FormSerialMangement.GsGridControlServSO.SetColumnProperty("GServSO","Invoice","HeaderBackColor",v.Color.GSS)
	Gui.FormSerialMangement.GsGridControlServSO.SetColumnProperty("GServSO","Invoice","HeaderForeColor","White")
	Gui.FormSerialMangement.GsGridControlServSO.SetColumnProperty("GServSO","Order_No","HeaderBackColor",v.Color.GSS)
	Gui.FormSerialMangement.GsGridControlServSO.SetColumnProperty("GServSO","Order_No","HeaderForeColor","White")
	Gui.FormSerialMangement.GsGridControlServSO.SetColumnProperty("GServSO","Order_Line","HeaderBackColor",v.Color.GSS)
	Gui.FormSerialMangement.GsGridControlServSO.SetColumnProperty("GServSO","Order_Line","HeaderForeColor","White")
	Gui.FormSerialMangement.GsGridControlServSO.SetColumnProperty("GServSO","Part","HeaderBackColor",v.Color.GSS)
	Gui.FormSerialMangement.GsGridControlServSO.SetColumnProperty("GServSO","Part","HeaderForeColor","White")
	Gui.FormSerialMangement.GsGridControlServSO.SetColumnProperty("GServSO","Description","HeaderBackColor",v.Color.GSS)
	Gui.FormSerialMangement.GsGridControlServSO.SetColumnProperty("GServSO","Description","HeaderForeColor","White")
	Gui.FormSerialMangement.GsGridControlServSO.SetColumnProperty("GServSO","PO","HeaderBackColor",v.Color.GSS)
	Gui.FormSerialMangement.GsGridControlServSO.SetColumnProperty("GServSO","PO","HeaderForeColor","White")
	Gui.FormSerialMangement.GsGridControlServSO.SetColumnProperty("GServSO","PO_Line","HeaderBackColor",v.Color.GSS)
	Gui.FormSerialMangement.GsGridControlServSO.SetColumnProperty("GServSO","PO_Line","HeaderForeColor","White")
	Gui.FormSerialMangement.GsGridControlServSO.SetColumnProperty("GServSO","SO_Type","HeaderBackColor",v.Color.GSS)
	Gui.FormSerialMangement.GsGridControlServSO.SetColumnProperty("GServSO","SO_Type","HeaderForeColor","White")
	
	Gui.FormSerialMangement.GsGridControlServSO.SetColumnProperty("GServSO","Order_No","CellForeColor", v.Color.LtBlue)
	Gui.FormSerialMangement.GsGridControlServSO.SetColumnProperty("GServSO","Part","CellForeColor", v.Color.LtBlue)
	Gui.FormSerialMangement.GsGridControlServSO.SetColumnProperty("GServSO","PO","CellForeColor", v.Color.LtBlue)
	
	Gui.FormSerialMangement.GsGridControlServSO.MainView("GServSO")
	
	Gui.FormSerialMangement.GsGridControlCSRHist.AddGridviewFromDatatable("GServHist","ServHist")
	Gui.FormSerialMangement.GsGridControlCSRHist.SetGridviewProperty("GServHist", "OptionsViewColumnAutoWidth", false)
	gui.FormSerialMangement.GsGridControlCSRHist.BestFitColumns("GServHist")
	
	Gui.FormSerialMangement.GsGridControlCSRHist.SetGridviewProperty("GServHist","ReadOnly",True)
	Gui.FormSerialMangement.GsGridControlCSRHist.SetGridviewProperty("GServHist","Editable",False)

	f.Intrinsic.String.Split(v.DataTable.ServHist.FieldNames, "*!*", v.Local.sFields)
	f.Intrinsic.Control.For(v.Local.iCnt, 0, v.Local.sFields.UBound, 1)
		gui.FormSerialMangement.GsGridControlCSRHist.SetColumnProperty("GServHist", v.Local.sFields(v.Local.iCnt), "HeaderFontBold", True)
		gui.FormSerialMangement.GsGridControlCSRHist.SetColumnProperty("GServHist", v.Local.sFields(v.Local.iCnt), "Visible", True)
'		gui.FormSerialMangement.GsGridControlCSRHist.SetColumnProperty("GServHist", v.Local.sFields(v.Local.iCnt), "ReadOnly", True)
'		gui.FormSerialMangement.GsGridControlCSRHist.SetColumnProperty("GServHist", v.Local.sFields(v.Local.iCnt), "AllowEdit", False)
'		gui.FormSerialMangement.GsGridControlCSRHist.SetColumnProperty("GServHist", v.Local.sFields(v.Local.iCnt), "HeaderHAlignment", "Near")
'		gui.FormSerialMangement.GsGridControlCSRHist.SetColumnProperty("GServHist", v.Local.sFields(v.Local.iCnt), "CellHAlignment", "Near")
		gui.FormSerialMangement.GsGridControlCSRHist.SetColumnProperty("GServHist", v.Local.sFields(v.Local.iCnt), "HeaderBackColor", v.Color.GSS)
		gui.FormSerialMangement.GsGridControlCSRHist.SetColumnProperty("GServHist", v.Local.sFields(v.Local.iCnt), "HeaderForeColor", v.Color.White)
	f.Intrinsic.Control.Next(v.Local.iCnt)
	
	Gui.FormSerialMangement.GsGridControlCSRHist.SetColumnProperty("GServHist","Delete_Col","Caption","Delete")
'	Gui.FormSerialMangement.GsGridControlCSRHist.SetColumnProperty("GServHist","Date_Entered","Caption","Date Entered")
'	Gui.FormSerialMangement.GsGridControlCSRHist.SetColumnProperty("GServHist","Date_Closed","Caption","Date Closed")
'	Gui.FormSerialMangement.GsGridControlCSRHist.SetColumnProperty("GServHist","Req_Type","Caption","Req Type")
'	Gui.FormSerialMangement.GsGridControlCSRHist.SetColumnProperty("GServHist","Notes","Caption","Notes")
'	
	Gui.FormSerialMangement.GsGridControlCSRHist.SetColumnProperty("GServHist","Date_Warranty","DisplayCustomDatetime","d")
'	Gui.FormSerialMangement.GsGridControlCSRHist.SetColumnProperty("GServHist","Date_Closed","DisplayCustomDatetime","d")
'	
'	Gui.FormSerialMangement.GsGridControlCSRHist.SetColumnProperty("GServHist","Request_Number","HeaderBackColor",v.Color.GSS)
'	Gui.FormSerialMangement.GsGridControlCSRHist.SetColumnProperty("GServHist","Request_Number","HeaderForeColor","White")
'	Gui.FormSerialMangement.GsGridControlCSRHist.SetColumnProperty("GServHist","Date_Entered","HeaderBackColor",v.Color.GSS)
'	Gui.FormSerialMangement.GsGridControlCSRHist.SetColumnProperty("GServHist","Date_Entered","HeaderForeColor","White")
'	Gui.FormSerialMangement.GsGridControlCSRHist.SetColumnProperty("GServHist","Date_Closed","HeaderBackColor",v.Color.GSS)
'	Gui.FormSerialMangement.GsGridControlCSRHist.SetColumnProperty("GServHist","Date_Closed","HeaderForeColor","White")
'	Gui.FormSerialMangement.GsGridControlCSRHist.SetColumnProperty("GServHist","Req_Type","HeaderBackColor",v.Color.GSS)
'	Gui.FormSerialMangement.GsGridControlCSRHist.SetColumnProperty("GServHist","Req_Type","HeaderForeColor","White")
'	Gui.FormSerialMangement.GsGridControlCSRHist.SetColumnProperty("GServHist","Notes","HeaderBackColor",v.Color.GSS)
'	Gui.FormSerialMangement.GsGridControlCSRHist.SetColumnProperty("GServHist","Notes","HeaderForeColor","White")
'	
	gui.FormSerialMangement.GsGridControlCSRHist.SetColumnProperty("GServHist", "Serial", "CellForeColor", v.Color.LtBlue)
	
	Gui.FormSerialMangement.GsGridControlCSRHist.MainView("GServHist")
	
	Gui.FormSerialMangement.GsGridControlCSREvent.AddGridviewFromDatatable("GEvent","Event")
	Gui.FormSerialMangement.GsGridControlCSREvent.SetGridviewProperty("GEvent", "OptionsViewColumnAutoWidth", false)
	gui.FormSerialMangement.GsGridControlCSREvent.BestFitColumns("GEvent")
	
	Gui.FormSerialMangement.GsGridControlCSREvent.SetGridviewProperty("GEvent","ReadOnly",True)
	Gui.FormSerialMangement.GsGridControlCSREvent.SetGridviewProperty("GEvent","Editable",False)
	
	f.Intrinsic.String.Split(v.DataTable.Event.FieldNames, "*!*", v.Local.sFields)
	f.Intrinsic.Control.For(v.Local.iCnt, 0, v.Local.sFields.UBound, 1)
		gui.FormSerialMangement.GsGridControlCSREvent.SetColumnProperty("GEvent", v.Local.sFields(v.Local.iCnt), "HeaderFontBold", True)
		gui.FormSerialMangement.GsGridControlCSREvent.SetColumnProperty("GEvent", v.Local.sFields(v.Local.iCnt), "Visible", True)
'		gui.FormSerialMangement.GsGridControlCSREvent.SetColumnProperty("GEvent", v.Local.sFields(v.Local.iCnt), "ReadOnly", True)
'		gui.FormSerialMangement.GsGridControlCSREvent.SetColumnProperty("GEvent", v.Local.sFields(v.Local.iCnt), "AllowEdit", False)
'		gui.FormSerialMangement.GsGridControlCSREvent.SetColumnProperty("GEvent", v.Local.sFields(v.Local.iCnt), "HeaderHAlignment", "Near")
'		gui.FormSerialMangement.GsGridControlCSREvent.SetColumnProperty("GEvent", v.Local.sFields(v.Local.iCnt), "CellHAlignment", "Near")
		gui.FormSerialMangement.GsGridControlCSREvent.SetColumnProperty("GEvent", v.Local.sFields(v.Local.iCnt), "HeaderBackColor", v.Color.GSS)
		gui.FormSerialMangement.GsGridControlCSREvent.SetColumnProperty("GEvent", v.Local.sFields(v.Local.iCnt), "HeaderForeColor", v.Color.White)
	f.Intrinsic.Control.Next(v.Local.iCnt)
	
'	Gui.FormSerialMangement.GsGridControlCSREvent.SetColumnProperty("GEvent","Date_Entered","Caption","Date")
'	Gui.FormSerialMangement.GsGridControlCSREvent.SetColumnProperty("GEvent","TEXT","Caption","Text")
'	
'	
''	Gui.FormSerialMangement.GsGridControlCSREvent.SetColumnProperty("GEvent","Date_Entered","MinWidth","80")
'	
'	Gui.FormSerialMangement.GsGridControlCSREvent.SetColumnProperty("GEvent","Date_Entered","DisplayCustomDatetime","d")
'	
'	Gui.FormSerialMangement.GsGridControlCSREvent.SetColumnProperty("GEvent","Date_Entered","HeaderBackColor",v.Color.GSS)
'	Gui.FormSerialMangement.GsGridControlCSREvent.SetColumnProperty("GEvent","Date_Entered","HeaderForeColor","White")
'	Gui.FormSerialMangement.GsGridControlCSREvent.SetColumnProperty("GEvent","TEXT","HeaderBackColor",v.Color.GSS)
'	Gui.FormSerialMangement.GsGridControlCSREvent.SetColumnProperty("GEvent","TEXT","HeaderForeColor","White")
	
	Gui.FormSerialMangement.GsGridControlCSREvent.MainView("GEVENT")
	
	gui.FormSerialMangement.GsGcOrderToWO.AddGridviewFromDatatable("orderToWOGV", "orderToWoDT")
	Gui.FormSerialMangement.GsGcOrderToWO.SetGridviewProperty("orderToWOGV", "OptionsViewColumnAutoWidth", false)
	gui.FormSerialMangement.GsGcOrderToWO.BestFitColumns("orderToWOGV")
	
	gui.FormSerialMangement.GsGcOrderToWO.SetGridviewProperty("orderToWOGV", "ReadOnly", true)
	gui.FormSerialMangement.GsGcOrderToWO.SetGridviewProperty("orderToWOGV", "Editable", false)
	
	gui.FormSerialMangement.GsGcOrderToWO.SetGridviewProperty("orderToWOGV", "OptionsSelectionEnableAppearanceFocusedRow", false)
	
	gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("orderToWOGV", "Job", "Caption", "Job")
	gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("orderToWOGV", "Suffix", "Caption", "Suffix")
	gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("orderToWOGV", "Order_No", "Caption", "SO #")
	gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("orderToWOGV", "Order_Line", "Caption", "SO Line")
	gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("orderToWOGV", "Part", "Caption", "Part")
	gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("orderToWOGV", "Description", "Caption", "Description")
	
	gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("orderToWOGV", "Job", "HeaderBackColor", v.Color.GSS)
	gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("orderToWOGV", "Suffix", "HeaderBackColor", v.Color.GSS)
	gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("orderToWOGV", "Order_No", "HeaderBackColor", v.Color.GSS)
	gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("orderToWOGV", "Order_Line", "HeaderBackColor", v.Color.GSS)
	gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("orderToWOGV", "Part", "HeaderBackColor", v.Color.GSS)
	gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("orderToWOGV", "Description", "HeaderBackColor", v.Color.GSS)
	
	gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("orderToWOGV", "Job", "HeaderForeColor", "White")
	gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("orderToWOGV", "Suffix", "HeaderForeColor", "White")
	gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("orderToWOGV", "Order_No", "HeaderForeColor", "White")
	gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("orderToWOGV", "Order_Line", "HeaderForeColor", "White")
	gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("orderToWOGV", "Part", "HeaderForeColor", "White")
	gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("orderToWOGV", "Description", "HeaderForeColor", "White")
	
'	gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("orderToWOGV", "Job", "MinWidth", "60")
'	gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("orderToWOGV", "Suffix", "MinWidth", "60")
	
	'gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("orderToWOGV", "Job", "CellForeColor", v.Color.LtBlue)
	gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("orderToWOGV", "Suffix", "CellForeColor", v.Color.LtBlue)
	gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("orderToWOGV", "Order_No", "CellForeColor", v.Color.LtBlue)
	gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("orderToWOGV", "Order_Line", "CellForeColor", v.Color.LtBlue)
	gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("orderToWOGV", "Part", "CellForeColor", v.Color.LtBlue)
	
	gui.FormSerialMangement.GsGcOrderToWO.MainView("orderToWOGV")
	
	'f.Data.DataView.Create("orderToWoDT$ChildWO", "ChildDV", 22)
	
	Gui.FormSerialMangement.GsGcOrderToWO.AddGridviewFromDataview("GCHILDWO", "orderToWoDT", "ChildDV")
	Gui.FormSerialMangement.GsGcOrderToWO.SetGridviewProperty("GCHILDWO", "OptionsViewColumnAutoWidth", false)
	gui.FormSerialMangement.GsGcOrderToWO.BestFitColumns("GCHILDWO")
	
	Gui.FormSerialMangement.GsGcOrderToWO.SetGridviewProperty("GCHILDWO","ReadOnly",True)
	Gui.FormSerialMangement.GsGcOrderToWO.SetGridviewProperty("GCHILDWO","Editable",False)
	Gui.FormSerialMangement.GsGcOrderToWO.SetGridviewProperty("GCHILDWO","OptionsSelectionEnableAppearanceFocusedRow",False)
	
	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Job","Caption","Job")
	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Suffix","Caption","Suffix")
	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Seq","Caption","Seq")
	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Job_Part","Caption","Job Part")
	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Part","Caption","Part")
	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Description","Caption","Description")
	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Warranty","Caption","Warranty")
	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","SerialNumber","Caption","Serial Number")
	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Quantity","Caption","Quantity")
	
'	gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO", "Job", "CellForeColor", v.Color.LtBlue)
'	gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO", "Suffix", "CellForeColor", v.Color.LtBlue)
'	gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO", "Part", "CellForeColor", v.Color.LtBlue)
'	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO", "Job_Part", "CellForeColor", v.Color.LtBlue)
	
	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Warranty","Visible",False)
	
	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Job","HeaderBackColor",v.Color.GSS)
	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Job","HeaderForeColor","White")
	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Suffix","HeaderBackColor",v.Color.GSS)
	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Suffix","HeaderForeColor","White")
	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Part","HeaderBackColor",v.Color.GSS)
	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Part","HeaderForeColor","White")
	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Description","HeaderBackColor",v.Color.GSS)
	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Description","HeaderForeColor","White")
	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Warranty","HeaderBackColor",v.Color.GSS)
	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Warranty","HeaderForeColor","White")
	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Seq","HeaderBackColor",v.Color.GSS)
	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Seq","HeaderForeColor","White")
	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Job_Part","HeaderBackColor",v.Color.GSS)
	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Job_Part","HeaderForeColor","White")
	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","SerialNumber","HeaderBackColor",v.Color.GSS)
	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","SerialNumber","HeaderForeColor","White")
	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Quantity","HeaderBackColor",v.Color.GSS)
	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Quantity","HeaderForeColor","White")
	
'	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Job","MinWidth","30")
'	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Suffix","MinWidth","30")
'	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Seq","MinWidth","30")
'	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Job_Part","MinWidth","30")
'	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Part","MinWidth","30")
'	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","SerialNumber","MinWidth","30")
'	
	Gui.FormSerialMangement.GsGcOrderToWO.AddStyleFormatCondition("GCHILDWO","Warranty","ParentGreen","Equal","Y")
    	Gui.FormSerialMangement.GsGcOrderToWO.SetStyleFormatConditionProperty("GCHILDWO","Warranty","ParentGreen","BackColor", v.Color.LtGreen)
    	Gui.FormSerialMangement.GsGcOrderToWO.SetStyleFormatConditionProperty("GCHILDWO","Warranty","ParentGreen","ApplyToRow",True)
	
	F.Intrinsic.Control.ExitSub
	
F.Intrinsic.Control.Catch
	f.Intrinsic.Control.CallSub(ErrorMsg, CurrentSub, v.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.Set_Properties.End

Program.Sub.GsGridControlSERV_RowCellClick.Start
F.Intrinsic.Control.Try
	V.Local.sError.Declare(String,"")
	V.Local.sRef.Declare(String,"")
	V.Local.sSql.Declare(String,"")
	v.Local.sSerial.Declare

	'f.Intrinsic.Control.BlockEvents
	gui.FormSerialMangement.pBar1.Value(0)
	gui.FormSerialMangement.lbl1.Caption("0%")
	f.Intrinsic.Control.If(v.DataTable.Event.RowCount, >, 0)
		F.Data.DataTable.DeleteRow("Event")
		F.Data.DataTable.AcceptChanges("Event")
	f.Intrinsic.Control.EndIf
	
	gui.FormSerialMangement.pBar1.Value(10)
	gui.FormSerialMangement.lbl1.Caption("10%")
	Gui.FormSerialMangement.GsGridControlSERV.GetCellValueByColumnName("GServ","Serial",V.Args.RowIndex,V.Local.sRef)
	v.Local.sSerial.Set(v.Local.sRef)
	Gui.FormSerialMangement.txtSerial.Text(V.Local.sRef.Trim)
	
	gui.FormSerialMangement.pBar1.Value(20)
	gui.FormSerialMangement.lbl1.Caption("20%")
	
	Gui.FormSerialMangement.GsGridControlSERV.GetCellValueByColumnName("GServ","Customer",V.Args.RowIndex,V.Local.sRef)
	
	gui.FormSerialMangement.pBar1.Value(30)
	gui.FormSerialMangement.lbl1.Caption("30%")
	Gui.FormSerialMangement.txtCustomer.Text(V.Local.sRef.Trim)
	gui.FormSerialMangement.txtCustomer.Text(v.Local.sRef.Trim)
	gui.FormSerialMangement.pBar1.Value(60)
	gui.FormSerialMangement.lbl1.Caption("60%")	
	
'	f.Intrinsic.Control.If(v.ODBC.con.State, =, 1)
'		f.ODBC.Connection!con.Close
'	f.Intrinsic.Control.EndIf

	f.ODBC.Connection!con.OpenCompanyConnection
		f.Intrinsic.String.Build("Select Name_Customer from V_CUSTOMER_MASTER where Customer = '{0}'", v.Local.sRef, v.Local.sRef)
		f.ODBC.Connection!con.ExecuteAndReturn(v.Local.sRef, v.Local.sRef)
	f.ODBC.Connection!con.Close
	'gui.FormSerialMangement.txtCustomer.Text(v.Local.sRef.Trim)
	gui.FormSerialMangement.pBar1.Value(80)
	gui.FormSerialMangement.lbl1.Caption("80%")
	F.Intrinsic.Control.CallSub(txtSerial_KeyPress)
	gui.FormSerialMangement.pBar1.Value(100)
	gui.FormSerialMangement.lbl1.Caption("100%")
	'add customer infro to Textboxes.
	'f.Intrinsic.Control.UnBlockEvents
	F.Intrinsic.Control.ExitSub
	
F.Intrinsic.Control.Catch
	f.Intrinsic.Control.CallSub(ErrorMsg, CurrentSub, v.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.GsGridControlSERV_RowCellClick.End

Program.Sub.txtSerial_KeyPress.Start
F.Intrinsic.Control.Try
	V.Local.sError.Declare(String,"")
	V.Local.iRet.Declare(Long,0)
	V.Local.sFile.Declare(String,"")
	
	'f.Intrinsic.Control.CallSub(cleanTxt)
	
	f.Data.DataView.SetFilter("Serv", "ServDV", "")
	
	f.Intrinsic.Control.If(V.Screen.FormSerialMangement!txtSerial.Text,<>,"")
		f.Intrinsic.Control.If(V.Screen.FormSerialMangement!txtSerial.Text,<>,V.Global.sSerial)
			v.Global.sSerial.Set(V.Screen.FormSerialMangement!txtSerial.Text)
			f.Intrinsic.Control.CallSub(Get_Data)
			f.Intrinsic.Control.CallSub(loadTxt)			
		f.Intrinsic.Control.EndIf
	f.Intrinsic.Control.Else
		v.Global.sSerial.Set("")
		f.Data.DataTable.DeleteRow("WOBOM")
		f.Intrinsic.Control.CallSub(cleanTxt)
	f.Intrinsic.Control.EndIf
	
	f.Intrinsic.String.Build("{0}\ART\GSS2.ico",V.Caller.GlobalDir,V.Local.sFile)
	gui.FormSerialMangement.htmlContainerDoc.Navigate(V.Local.sFile,false)
	
	f.Intrinsic.Control.ExitSub	
F.Intrinsic.Control.Catch
	f.Intrinsic.Control.CallSub(ErrorMsg, CurrentSub, v.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.txtSerial_KeyPress.End

Program.Sub.Get_Data.Start
F.Intrinsic.Control.Try
	V.Local.sError.Declare(String,"")
	V.Local.sSql.Declare(String,"")
	V.Local.sBillTo.Declare(String,"")
	V.Local.sShipTo.Declare(String,"")
	V.Local.i.Declare(Long,0)
	V.Local.sSo.Declare(String,"")
	V.Local.sPart.Declare(String,"")
	V.Local.sJob.Declare(String,"")
	V.Local.iLinkID.Declare(Long,0)
	v.Local.sSerial.Declare
	v.Local.iCnt.Declare
	v.Local.sTemp.Declare
	v.Local.iListLink.Declare
	v.Local.sPartDoc.Declare
	v.Local.sTempDoc.Declare
	v.Local.sList.Declare
	v.Local.sJobPart.Declare
	v.Local.sDRWPart.Declare
	

	f.Intrinsic.String.RPad(V.Screen.FormSerialMangement!txtSerial.Text, " ", 20, v.Local.sSerial)
	
	'getting orginal Sales Order that was created for the selected Serial 
	'looking in hist first then to order header
'	f.Intrinsic.Control.If(v.ODBC.con.State, =, 1)
'		f.ODBC.Connection!con.Close
'	f.Intrinsic.Control.EndIf
	
	F.ODBC.Connection!con.OpenCompanyConnection
	F.Intrinsic.String.Build("Select Top 1 Order_No, Part From V_Item_History Where Serial_Number = '{0}' and Code_Transaction = 'O35'",V.Screen.FormSerialMangement!txtSerial.Text,V.Local.sSql)
	'F.Intrinsic.String.Build("Select Top 1 Order_No, Part From V_Item_History Where Serial_Number = '{0}' and Code_Transaction = 'O35'",v.Local.sSerial,V.Local.sSql)
	F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.sSO)
	
	F.Intrinsic.String.Split(V.Local.sSo,"*!*",V.Local.sSo)
	V.Local.sSo.RedimPreserve(0,1)
	
	V.Local.sPart.Set(V.Local.sSo(1).Trim)
	
	V.Local.sSo.RedimPreserve(0,0)
	GUI.FormSerialMangement.txtSO.Text(v.Local.sSo)
	
	F.Intrinsic.String.Build("Select Top 1 Job From V_Item_History Where Serial_Number = '{0}' and Part = '{1}' and job <> ''",V.Screen.FormSerialMangement!txtSerial.Text,V.Local.sPart,V.Local.sSql)
	
	F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.sJob)
	

''HOURS_WORKED
	f.Intrinsic.String.Build("Select Parent as Job_Part, Part, Quantity from V_BOM_MSTR where parent = '{0}' and part <> ''", v.Local.sPart, v.Local.sSql)
	f.Data.Datatable.CreateFromSQL("TempWO", "con", v.Local.sSql)
	F.Data.DataTable.DeleteRow("WOBOM")
	F.Data.DataTable.AcceptChanges("WOBOM")
	F.Data.DataTable.Merge("TempWO","WOBOM",False,4)
	F.Data.DataTable.Close("TempWO")
	
	f.Data.Dictionary.CreateFromSQL("descDict", "con", "Select distinct Part, Description from V_Inventory_all")
	f.Data.Datatable.FillFromDictionary("WOBOM", "descDict", "Part", "Description")
	f.Data.Dictionary.Close("descDict")
	
	F.Intrinsic.Control.If(V.Local.sJob,<>,"")
		'F.Intrinsic.String.Build("Select Job, Suffix, Seq, Job+Suffix as Job_Part, Part, Job+Suffix+Seq as SerialNumber, Description, Job+Suffix+Seq as Quantity From V_Job_Hist_Dtl Where Job = '{0}' and LMO = 'M' Order by Suffix",V.Local.sJob,V.Local.sSql)
		F.Intrinsic.String.Build("Select Job, Suffix, Seq, Job+Suffix as Job_Part, Part, Job+Suffix+Seq as SerialNumber, Description, HOURS_WORKED as Quantity From V_Job_Hist_Dtl Where Job = '{0}' and LMO in ('M', 'C') Order by Suffix",V.Local.sJob,V.Local.sSql)
		F.Data.DataTable.CreateFromSQL("TempWO","con",V.Local.sSql)
		F.Intrinsic.Control.If(V.DataTable.TempWO.RowCount--,=,-1)
			F.Data.DataTable.Close("TempWO")
			'F.Intrinsic.String.Build("Select Job, Suffix, Seq, Job+Suffix as Job_Part, Part, Job+Suffix+Seq as SerialNumber, Description, Job+Suffix+Seq as Quantity From V_Job_Detail Where Job = '{0}' and LMO = 'M' Order by Suffix",V.Local.sJob,V.Local.sSql)
			F.Intrinsic.String.Build("Select Job, Suffix, Seq, Job+Suffix as Job_Part, Part, Job+Suffix+Seq as SerialNumber, Description, HOURS_WORKED as Quantity From V_Job_Detail Where Job = '{0}' and LMO in ('M', 'C') Order by Suffix",V.Local.sJob,V.Local.sSql)
			F.Data.DataTable.CreateFromSQL("TempWO","con",V.Local.sSql)
		F.Intrinsic.Control.EndIf
		
		F.Data.Dictionary.CreateFromSQL("JobPart","con","Select Job+Suffix as Job_Part, Part from V_Job_Header union Select Job+Suffix as Job_Part, Part from V_job_hist_mast")
		F.Data.Dictionary.SetDefaultReturn("JobPart","")
		F.Data.DataTable.FillFromDictionary("TempWO","JobPart", "Job_Part", "Job_Part")
		F.Data.Dictionary.Close("JobPart")
	
		F.Data.DataTable.AcceptChanges("WOBOM")
		F.Data.DataTable.Merge("TempWO","WOBOM",False,4)
		F.Data.DataTable.Close("TempWO")
		
	F.Intrinsic.Control.EndIf
	
	F.Data.Dictionary.CreateFromSQL("Warranty","con","Select Part, 'Y' as Warranty From V_Inventory_Mstr Where Flag_Warranty = 'Y'")
	F.Data.Dictionary.SetDefaultReturn("Warranty","N")
	F.Data.DataTable.FillFromDictionary("WOBOM","Warranty","Part","Warranty")
	F.Data.Dictionary.Close("Warranty")
	
	
	
	
'	F.Data.Dictionary.CreateFromSQL("QuantityDict","con","Select Job+Suffix+Seq as Job_Part, Hours_Actual as Quantity from V_JOB_OPERATIONS union Select Job+Suffix as Job_Part, Hours_Actual as Quantity from V_JOB_HIST_OPS")
'	F.Data.Dictionary.SetDefaultReturn("QuantityDict","")
'	F.Data.DataTable.FillFromDictionary("WOBOM","QuantityDict", "Quantity", "Quantity")
'	F.Data.Dictionary.Close("QuantityDict")

	f.Intrinsic.Control.If(v.DataTable.WOBOM.RowCount, >, 0)
	
		v.Local.sJobPart.Set(v.DataTable.WOBOM(0).Job_Part!FieldValTrim)
		f.Intrinsic.String.Build("Select Part from V_BOM_MSTR where Parent ='{0}' and Category = 'R'", v.Local.sJobPart, v.Local.sSql)
		f.Data.DataTable.CreateFromSQL("DrawingsDT", "con", v.Local.sSql, true)
		v.Local.sSql.Set("")
		f.Intrinsic.Control.For(v.Local.iCnt, 0, v.DataTable.DrawingsDT.RowCount--, 1)
			v.Local.sDRWPart.Set(v.DataTable.DrawingsDT(v.Local.iCnt).Part!FieldVal)
			f.Intrinsic.String.RPad(v.Local.sDRWPart, " ", 20, v.Local.sDRWPart)
			f.Intrinsic.Control.If(v.Local.sSql.Trim, =, "")
				f.Intrinsic.String.Build("'{0}' {1}", v.Local.sDRWPart, v.Local.sSql, v.Local.sSql)
			f.Intrinsic.Control.Else
				f.Intrinsic.String.Build("'{0}', {1}", v.Local.sDRWPart, v.Local.sSql, v.Local.sSql)
			f.Intrinsic.Control.EndIf
			
			
			f.Data.DataTable.AddRow("WOBOM", "Job", v.Local.sJob, "Suffix", "000", "Seq", "", "Job_Part", v.Local.sJobPart, "SerialNumber", "", "Part", v.Local.sDRWPart, "Description", v.Local.sDRWPart, "Warranty", "N")
		f.Intrinsic.Control.Next(v.Local.iCnt)
		f.Data.DataTable.Close("DrawingsDT")
		f.Intrinsic.Control.If(v.Local.sSql.Trim, <>, "")
			f.Intrinsic.String.Build("where Part in ({0})", v.Local.sSql, v.Local.sSql)
		f.Intrinsic.Control.EndIf
		
		f.Intrinsic.String.Build("Select Part, Description from V_Inventory_Mstr {0}", v.Local.sSql, V.Local.sSql)
		f.Data.Dictionary.CreateFromSQL("descriptionDict", "con", v.Local.sSql)
		F.Data.DataTable.FillFromDictionary("WOBOM","descriptionDict", "Description", "Description")
		F.Data.Dictionary.Close("descriptionDict")
		
		F.Data.Dictionary.CreateFromSQL("Serial_NumberDict","con","Select  Job+Suffix+Sequence as JobSuffixSeq, Serial_number from V_Item_History where Code_Transaction = 'J55'")
		F.Data.Dictionary.SetDefaultReturn("Serial_NumberDict","")
		F.Data.DataTable.FillFromDictionary("WOBOM","Serial_NumberDict", "SerialNumber", "SerialNumber")
		F.Data.Dictionary.Close("Serial_NumberDict")
		
		F.Intrinsic.String.Build("Select Top 1 Job+Suffix From V_Item_History Where Serial_Number = '{0}' and Part = '{1}'",V.Screen.FormSerialMangement!txtSerial.Text,V.Local.sPart,V.Local.sSql)
		F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.sJob)
	f.Intrinsic.Control.EndIf
'*88***************************************
'Check Get Link using Job+Suffix. It's not working on customer's. Link at Inventory Level  (30 instead of 20).
'Attachment on both levels. event
	F.Global.DocumentControl.GetLinkID(V.Local.sJob,20,V.Local.iLinkID)
	F.Intrinsic.String.Build("Select Path, File, Description From ATG_Doc_Assoc Where Link_ID = {0}",V.Local.iLinkID,V.Local.sSql)
	F.Data.DataTable.CreateFromSQL("TempDoc","con",v.Local.sSql)
	F.Data.DataTable.DeleteRow("Doc")
	F.Data.DataTable.AcceptChanges("Doc")
	F.Data.DataTable.Merge("TempDoc","Doc",False,4)
	F.Data.DataTable.Close("TempDoc")
	
'***************** Adding Docs for Parts.

	f.Intrinsic.Control.If(v.DataView.WOBOM!WOBOMDV.Exists)
		f.Data.DataView.Close("WOBOM", "WOBOMDV")
	f.Intrinsic.Control.EndIf
	f.Data.DataView.Create("WOBOM", "WOBOMDV", 22, "Seq = ''", "")
	f.Data.DataView.ToDataTableDistinct("WOBOM", "WOBOMDV", "partDocsDT", "Part")
	f.Data.DataTable.AddRow("partDocsDT", "Part", v.Local.sJobPart)

'Linking
	f.Intrinsic.Control.If(v.DataTable.partDocsDT.RowCount, >, 0)	
		v.Local.iListLink.Redim(0, v.DataTable.partDocsDT.RowCount--)
	
		f.Intrinsic.Control.For(v.Local.iCnt, 0, v.DataTable.partDocsDT.RowCount--, 1)
			v.Local.sPartDoc.Set(v.DataTable.partDocsDT(v.Local.iCnt).Part!FieldVal)
			f.Intrinsic.String.RPad(v.Local.sPartDoc, " ", 22, v.Local.sPartDoc)
			
			f.Global.DocumentControl.GetLinkID(v.Local.sPartDoc, 30, v.Local.iListLink(v.Local.iCnt))	
		f.Intrinsic.Control.Next(v.Local.iCnt)

		f.Intrinsic.String.Join(v.Local.iListLink, "','", v.Local.sTemp)
		F.Intrinsic.String.Build("Select Path, File, Description From ATG_Doc_Assoc Where Link_ID in ('{0}')",V.Local.sTemp,V.Local.sSql)
		F.Data.DataTable.CreateFromSQL("TempDoc","con",v.Local.sSql)
		f.Data.DataTable.DeleteRow("Doc")
		F.Data.DataTable.AcceptChanges("Doc")
		F.Data.DataTable.Merge("TempDoc","Doc",False,4)
		F.Data.DataTable.Close("TempDoc")
		F.Data.DataTable.Close("partDocsDT")
	f.Intrinsic.Control.EndIf
	
	'******************
'	f.Data.DataView.Create("partDocsDT", "partDocsDV", 22)
'	f.Data.DataView.ToString("partDocsDT", "partDocsDV", "Part", "*!*", ",", v.Local.sTemp)
'	f.Intrinsic.String.Build("'{0}'", v.Local.sTemp, v.Local.sTemp)
	
	F.Intrinsic.String.Build("Select * From GCG_6544_SO_INCIDENT Where Serial_No = '{0}'", V.Screen.FormSerialMangement!txtSerial.Text, V.Local.sSql)
	F.Data.DataTable.CreateFromSQL("TempOrigSO","con",V.Local.sSql)
	f.Data.DataTable.AddColumn("TempOrigSO", "Quote", "String")
	F.Data.DataTable.DeleteRow("OrigSO")
	F.Data.DataTable.AcceptChanges("OrigSO")
	'F.Intrinsic.Control.If(V.DataTable.TempOrigSO.RowCount--,<>,-1)
		F.Data.DataTable.Merge("TempOrigSO","OrigSO",False,4)
'	F.Intrinsic.Control.Else
'		F.Data.DataTable.Close("TempOrigSO")
'		F.Intrinsic.String.Build("Select Order_No, Record_No as Order_Line, Part, Description From V_Order_Lines Where Order_No = '{0}'",V.Local.sSo,V.Local.sSql)
'		F.Data.DataTable.CreateFromSQL("TempOrigSO","con",V.Local.sSql)
'		F.Data.DataTable.Merge("TempOrigSO","OrigSO",False,4)
'	F.Intrinsic.Control.EndIf
'	
'	f.Data.Dictionary.CreateFromSQL("quoteDict", "con", "Select order_no, quote from V_Order_Header")
'	f.Data.Dictionary.SetDefaultReturn("quoteDict", "")
'	f.Data.DataTable.FillFromDictionary("OrigSO", "quoteDict", "order_no", "Quote")
'	f.Data.Dictionary.Close("quoteDict")
	
	'F.Intrinsic.String.Build("Select a.Order_No, a.Order_Line, a.Part, Description, PO, PO_Line From V_Order_Hist_Line a Left Join PO_Drop_Ship b on  a.Order_No = b.Order_No and a.Order_Line = b.Order_Line Right Join V_Order_Hist_Head c on a.Order_No = c.Order_No Where a.Part Like 'SERV%' and c.User_1 = '{0}'",V.Screen.FormSerialMangement!txtSerial.Text,V.Local.sSql)
	
	'F.Intrinsic.String.Build("Select a.Order_No, a.Order_Line, a.Part, Description, PO, PO_Line From V_Order_Hist_Line a Left Join PO_Drop_Ship b on  a.Order_No = b.Order_No and a.Order_Line = b.Order_Line Right Join V_Order_Hist_Head c on a.Order_No = c.Order_No Where a.User_1 = '{0}'",V.Screen.FormSerialMangement!txtSerial.Text,V.Local.sSql)
	
	'F.Intrinsic.String.Build("Select a.Order_No, a.Order_Line, a.Part, Description, PO, PO_Line From V_Order_Hist_Line a Left Join PO_Drop_Ship b on  a.Order_No = b.Order_No and a.Order_Line = b.Order_Line Right Join V_Order_Hist_Head c on a.Order_No = c.Order_No Where a.User_1 = '{0}' and date_shipped > '01/01/2020'",V.Screen.FormSerialMangement!txtSerial.Text,V.Local.sSql)
	
	F.Intrinsic.String.Build("Select a.Invoice, a.Order_No, a.Order_Line, a.Part, Description, PO, PO_Line, a.user_3 as SO_Type From V_Order_Hist_Line a Left Join PO_Drop_Ship b on  a.Order_No = b.Order_No and a.Order_Line = b.Order_Line Where a.User_1 = '{0}'", V.Screen.FormSerialMangement!txtSerial.Text, V.Local.sSql)
	
	F.Data.DataTable.CreateFromSQL("TempServSO", "con", V.Local.sSql)
	F.Data.DataTable.DeleteRow("ServSO")
	F.Data.DataTable.AcceptChanges("ServSO")
	F.Data.DataTable.Merge("TempServSO","ServSO",False,4)
	F.Data.DataTable.Close("TempServSO")
	'F.Intrinsic.String.Build("Select a.Invoice, a.Order_No, a.Record_No as Order_Line, a.Part, Description, PO, PO_Line From V_Order_Lines a Left Join PO_Drop_Ship b on a.Order_No = b.Order_No and a.Record_No = b.Order_Line Right Join V_Order_Header c on a.Order_No = c.Order_No Where a.User_1 = '{0}'",V.Screen.FormSerialMangement!txtSerial.Text,V.Local.sSql)
	'F.Intrinsic.String.Build("Select a.Order_No, a.Record_No as Order_Line, a.Part, Description, PO, PO_Line From V_Order_Lines a Left Join PO_Drop_Ship b on a.Order_No = b.Order_No and a.Record_No = b.Order_Line Right Join V_Order_Header c on a.Order_No = c.Order_No Where a.Part Like 'SERV%' and c.User_1 = '{0}'",V.Screen.FormSerialMangement!txtSerial.Text,V.Local.sSql)
	
	F.Intrinsic.String.Build("Select a.Invoice, a.Order_No, a.Record_No as Order_Line, a.Part, Description, PO, PO_Line, a.user_3 as SO_Type From V_Order_Lines a Left Join PO_Drop_Ship b on a.Order_No = b.Order_No and a.Record_No = b.Order_Line Where a.User_1 = '{0}'", V.Screen.FormSerialMangement!txtSerial.Text, V.Local.sSql)
	F.Data.DataTable.CreateFromSQL("TempServSO","con",V.Local.sSql)
	F.Data.DataTable.Merge("TempServSO","ServSO",False,4)
	F.Data.DataTable.Close("TempServSO")
	
	'F.Intrinsic.String.Build("Select Request_Number, Date_Entered, IF(Date_Closed = '1900-01-01','',Date_Closed) as Date_Closed, Req_Type From V_Cust_Serv_Req Where Fax = '{0}'",V.Screen.FormSerialMangement!txtSerial.Text,V.Local.sSql)
	F.Intrinsic.String.Build("Select 'DELETE' as Delete_Col, Serial, Part, Date_warranty_chg as Date_Warranty, Time_warranty_chg as Time_Warranty, Order_no, Order_suffix, Order_line, Invoice, Date_Purchased, Date_Expiration, Customer, Purch_From_Id, End_User_Name, Address_1, Address_2, City, State, Zip, Country, County, Attention, Phone, Fax, Email From V_WARRANTY Where Serial = '{0}'",V.Screen.FormSerialMangement!txtSerial.Text,V.Local.sSql)
	
	F.Data.DataTable.CreateFromSQL("TempServHist","con",V.Local.sSql,True)
'	f.Data.DataTable.AddColumn("TempServHist", "Notes", "String")
'	
'	f.Data.Dictionary.CreateFromSQL("notesDictionary", "con", "Select CSR_Number, TEXT from Cust_Svc_Rq_Notes where Type_CD = 'P'")
'	f.Data.Dictionary.SetDefaultReturn("notesDictionary", " ")
'	f.Data.DataTable.FillFromDictionary("TempServHist", "notesDictionary", "Request_Number", "Notes")
'	f.Data.Dictionary.Close("notesDictionary")
	
	F.Data.DataTable.DeleteRow("ServHist")
	F.Data.DataTable.AcceptChanges("ServHist")
	F.Data.DataTable.Merge("TempServHist","ServHist",False,4)
	F.Data.DataTable.Close("TempServHist")
	
	f.Data.Dictionary.CreateFromSQL("notesDictionary", "con", "Select Serial, Text from WARRANTY_COMMENTS")
	f.Data.Dictionary.SetDefaultReturn("notesDictionary", "Not Found")
	f.Data.Datatable.FillFromDictionary("ServHist", "notesDictionary", "Serial", "Notes")
	f.Data.Dictionary.Close("notesDictionary")
	F.ODBC.Connection!con.Close
	
	F.Intrinsic.Control.ExitSub
		
F.Intrinsic.Control.Catch

	f.Intrinsic.Control.CallSub(ErrorMsg, CurrentSub, v.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.Get_Data.End

Program.Sub.cmdContactsSave_Click.Start
'v.Local.sSerial.Declare
'v.Local.sCustomer.Declare
'v.Local.sCustContactNum.Declare
'v.Local.sCustomerName.Declare
'v.Local.sCustName.Declare
'v.Local.sCustPhone.Declare
'v.Local.sCustEmail.Declare

'v.Local.sSiteNames.Declare
'v.Local.sSiteName.Declare
'v.Local.sSiteContact.Declare
'v.Local.sSiteContacts.Declare

'v.Local.sVendor.Declare
'v.Local.sVendorContactNum.Declare
'v.Local.sVendorName.Declare
'v.Local.sVContactName.Declare
'v.Local.sVContactPhone.Declare
'v.Local.sVContactEmail.Declare

'F.Intrinsic.Control.Try
'	v.Local.sSerial.Set(v.Screen.FormSerialMangement!txtSerial.Text)
'	v.Local.sCustomer.Set(v.Screen.FormSerialMangement!txtCustomer.Text)
'	v.Local.sCustContactNum.Set(v.Screen.FormSerialMangement!txtCustContactNumber.Text)
'	v.Local.sCustomerName.Set(v.Screen.FormSerialMangement!txtCustomer.Text)
'	v.Local.sCustName.Set(v.Screen.FormSerialMangement!txtContactCust.Text)
'	v.Local.sCustPhone.Set(v.Screen.FormSerialMangement!txtConCustPhone.Text)
'	v.Local.sCustEmail.Set(v.Screen.FormSerialMangement!txtConCustEmail.Text)

'	f.Intrinsic.String.Split(v.Screen.FormSerialMangement!txtSiteName.Text, v.Ambient.NewLine, v.Local.sSiteNames)
'	f.Intrinsic.String.Join(v.Local.sSiteNames, "!*!", v.Local.sSiteName)
'	
'	f.Intrinsic.String.Split(v.Screen.FormSerialMangement!txtSiteContact.Text, v.Ambient.NewLine, v.Local.sSiteContacts)
'	f.Intrinsic.String.Join(v.Local.sSiteContacts, "!*!", v.Local.sSiteContact)
'	
'	v.Local.sVendor.Set(v.Screen.FormSerialMangement!txtVendor.Text)
'	v.Local.sVendorContactNum.Set(v.Screen.FormSerialMangement!txtVendContactNumber.Text)
'	v.Local.sVendorName.Set(v.Screen.FormSerialMangement!txtVendorName.Text)
'	v.Local.sVContactName.Set(v.Screen.FormSerialMangement!txtVendorContact.Text)
'	v.Local.sVContactPhone.Set(v.Screen.FormSerialMangement!txtVendorPhone.Text)
'	v.Local.sVContactEmail.Set(v.Screen.FormSerialMangement!txtVendorEmail.Text)
'	
''	f.Intrinsic.Control.If(v.ODBC.con.State, =, 1)
''		f.ODBC.Connection!con.Close
''	f.Intrinsic.Control.EndIf
'	
'	f.ODBC.Connection!con.OpenCompanyConnection
'		f.Data.DataTable.CreateFromSQL("saveDT", "con", "Select * from GCG_5530_CSR_INFO")
'	f.ODBC.Connection!con.Close
'	
'	f.Data.DataTable.DeleteRow("saveDT")
'	
'	f.Data.DataTable.AddRow("saveDT", "Serial_Number", v.Local.sSerial, "Customer", v.Local.sCustomer, "Customer_Name", v.Local.sCustomerName, "CONTACTCUSTNUM", v.Local.sCustContactNum,"ContactCustName", v.Local.sCustName, "ContactCustPhone", v.Local.sCustPhone, "ContactCustEmail", v.Local.sCustEmail, "Site_Names", v.Local.sSiteName, "Site_Contacts", v.Local.sSiteContact, "Vendor", v.Local.sVendor, "Vendor_Name", v.Local.sVendorName, "CONTACTVENDNUM", v.Local.sVendorContactNum, "ContactVendorName", v.Local.sVContactName, "ContactVendorPhone", v.Local.sVContactPhone, "ContactVendorEmail", v.Local.sVContactEmail)
'	
''	f.Intrinsic.Control.If(v.ODBC.con.State, =, 1)
''		f.ODBC.Connection!con.Close
''	f.Intrinsic.Control.EndIf
'	
'	f.ODBC.Connection!con.OpenCompanyConnection
'		f.Data.DataTable.SaveToDB("saveDT", "con", "GCG_5530_CSR_INFO", "Serial_Number", 256)
'	f.ODBC.Connection!con.Close
'	
'	f.Intrinsic.UI.Msgbox("Save Complete")
'Intrinsic.Control.Catch
'	f.Intrinsic.Control.CallSub(ErrorMsg, CurrentSub, v.Ambient.CurrentSubroutine)
'F.Intrinsic.Control.EndTry
Program.Sub.cmdContactsSave_Click.End

Program.Sub.GsGridControlCSRHist_RowCellClick.Start
v.Local.sColumn.Declare
v.Local.sFilePath.Declare
v.Local.sText.Declare
v.Local.iRet.Declare


v.Local.sCustomer.Declare
v.Local.iType.Declare
v.Local.sSerialNumber.Declare
v.Local.sParams.Declare
v.Local.iPID.Declare
v.Local.bCheck.Declare
v.Local.bContains.Declare
v.Local.iCnt.Declare
v.Local.sReturn.Declare
v.Local.sProcess.Declare
v.Local.iCRMHwnd.Declare

v.Local.sSO.Declare
v.Local.sSOS.Declare

v.Local.sTime.Declare
v.Local.sDate.Declare

F.Intrinsic.Control.Try
	V.Local.sError.Declare(String,"")
	V.Local.sRef.Declare(String,"")
	V.Local.sSql.Declare(String,"")
	V.Local.i.Declare(Long,0)
	
	'f.Intrinsic.Control.BlockEvents
	gui.FormSerialMangement.pBar1.Value(0)
	gui.FormSerialMangement.lbl1.Caption("0%")
	
	f.Intrinsic.Control.If(v.DataTable.TempEvent.Exists)
		f.Data.DataTable.Close("TempEvent")
	f.Intrinsic.Control.EndIf
	gui.FormSerialMangement.pBar1.Value(10)
	gui.FormSerialMangement.lbl1.Caption("10%")
	Gui.FormSerialMangement.GsGridControlCSRHist.GetCellValueByColumnName("GServHist","Serial",V.Args.RowIndex,V.Local.sRef)
	Gui.FormSerialMangement.GsGridControlCSRHist.GetCellValueByColumnName("GServHist","Order_no",V.Args.RowIndex,V.Local.sSO)
	Gui.FormSerialMangement.GsGridControlCSRHist.GetCellValueByColumnName("GServHist","Date_Warranty",V.Args.RowIndex,V.Local.sDate)
	Gui.FormSerialMangement.GsGridControlCSRHist.GetCellValueByColumnName("GServHist","Time_Warranty",V.Args.RowIndex,V.Local.sTime)
'	f.Intrinsic.Control.If(v.ODBC.con.State, =, 1)
'		f.ODBC.Connection!con.Close
'	f.Intrinsic.Control.EndIf
	
	gui.FormSerialMangement.pBar1.Value(30)
	gui.FormSerialMangement.lbl1.Caption("30%")
	
	F.ODBC.Connection!con.OpenCompanyConnection
		f.Intrinsic.String.Build("select Order_no from V_Order_Hist_line where User_1 = '{0}'", v.Local.sRef, v.Local.sSql)
		f.ODBC.Connection!con.ExecuteAndReturn(v.Local.sSql, v.Local.sSOS)
		f.Intrinsic.Control.If(v.Local.sSOS.Trim, <>, "")
			f.Intrinsic.String.Replace(v.Local.sSOS, "*!*", "','", v.Local.sSOS)
			f.Intrinsic.String.Build("'{0}','{1}'", v.Local.sSOS, v.Local.sSO.Trim, v.Local.sSOS)
		f.Intrinsic.Control.Else
			f.Intrinsic.String.Build("'{0}'", v.Local.sSO.Trim, v.Local.sSOS)
		f.Intrinsic.Control.EndIf
		F.Intrinsic.String.Build("Select * from RMA_HIST_LINES where Order_no in ({0})",V.Local.sSOS.Trim,V.Local.sSql)
		
		F.Data.DataTable.CreateFromSQL("TempEvent","con",V.Local.sSql,True)
	F.ODBC.Connection!con.Close
	
	gui.FormSerialMangement.pBar1.Value(60)
	gui.FormSerialMangement.lbl1.Caption("60%")
	
	F.Data.DataTable.DeleteRow("Event")
	F.Data.DataTable.AcceptChanges("Event")
	F.Data.DataTable.Merge("TempEvent","Event",False,4)
	F.Data.DataTable.Close("TempEvent")
	
	gui.FormSerialMangement.pBar1.Value(80)
	gui.FormSerialMangement.lbl1.Caption("80%")
	
	f.Intrinsic.String.UCase(v.Args.Column, v.Local.sColumn)
	f.Intrinsic.Control.If(v.Local.sColumn, =, "DELETE_COL")

		f.Intrinsic.String.Format(v.Local.sTime, "hhnnssss", v.Local.sTime)
		f.Intrinsic.String.Format(v.Local.sDate, "yymmdd", v.Local.sDate)
		f.Intrinsic.Control.If(v.Local.sDate, =, "000101")
			v.Local.sDate.Set("000000")
		f.Intrinsic.Control.EndIf
		f.Intrinsic.String.Build("Delete From Warranty Where Date_Warranty_chg = '{0}' and Time_Warranty_chg = '{1}' and serial = '{2}'", v.Local.sDate, v.Local.sTime, v.Local.sRef,  v.Local.sSql)
		F.ODBC.Connection!con.OpenCompanyConnection
			f.ODBC.Connection!con.Execute(v.Local.sSql)
			f.Data.Datatable.DeleteRow("ServHist", v.Args.RowIndex)
		f.ODBC.Connection!con.Close
		
	'	f.Intrinsic.String.Build("{0}\CUSTOM\GCG_5530\CSR_{1}{2}.txt", v.Caller.GlobalDir, v.Caller.CompanyCode, v.Caller.Terminal, v.Local.sFilePath)
		'f.Intrinsic.File.String2File(v.Local.sFilePath, v.Local.sRef)
		
		'f.Global.General.LaunchMenuTask(250, 0, v.Local.iRet)
	f.Intrinsic.Control.EndIf
	
	
	'CRM
	v.Local.sCustomer.Set(v.Screen.FormSerialMangement!txtCustomer.Text)
	v.Local.sSerialNumber.Set(v.Screen.FormSerialMangement!txtSerial.Text)
	
'	f.Intrinsic.Task.IsProgramRunning("CRM.exe", v.Local.bCheck)

'	f.Intrinsic.Control.If(v.Local.bCheck.Not)
'		f.Global.General.LaunchMenuTask(243, 0, v.Local.iRet)
'		f.Intrinsic.UI.Sleep(15)
'	f.Intrinsic.Control.EndIf
'	
'	f.Intrinsic.Task.IsProgramRunning("CRM.exe", v.Local.bCheck)
'	f.Intrinsic.Control.If(v.Local.bCheck)
'		f.Intrinsic.Task.GetProcessList(v.Local.sReturn)
'		f.Intrinsic.String.Split(v.Local.sReturn, "*!*", v.Local.sReturn)
'		f.Intrinsic.Control.For(v.Local.iCnt, 0, v.Local.sReturn.UBound, 1)
'			f.Intrinsic.String.Instr(v.Local.sReturn(v.Local.iCnt), "CRM.exe", 0, v.Local.bContains)
'			f.Intrinsic.Control.If(v.Local.bContains)
'				f.Intrinsic.String.Split(v.Local.sReturn(v.Local.iCnt), "!*!", v.Local.sProcess)
'				v.Local.iPID.Set(v.Local.sProcess(0))
'				f.Intrinsic.Control.ExitFor(v.Local.iCnt)
'			f.Intrinsic.Control.EndIf
'		f.Intrinsic.Control.Next(v.Local.iCnt)

'		f.Intrinsic.Control.If(v.Local.iPID, <>, 0)
'			f.Intrinsic.API.GetHandleFromPID(v.Local.iPID, v.Local.iCRMHwnd)
'			
'			'f.Intrinsic.String.Build("MODE::11*!*COMPANY-NUMBER::{0}*!*COMPANY-TYPE::15*!*NEW-CSR::1*!*SUBJECT:: *!*PROBLEM:: *!*CONTACT:: *!*FAX::{2}", v.Local.sCustomer, v.Local.sSerialNumber, v.Local.sParams)
'			F.Intrinsic.String.Build("MODE::11*!*COMPANY-NUMBER::{0}*!*COMPANY-TYPE::15*!*NEW-CSR::0*!*SERV-REQ-NUMBER::{1}",V.Local.sCustomer, V.Local.sRef,V.Local.sParams)   
'			f.Intrinsic.API.ChangeCaption(v.Local.iCRMHwnd, v.Local.sParams)
'		f.Intrinsic.Control.EndIf
'	f.Intrinsic.Control.EndIf
	
	
	gui.FormSerialMangement.pBar1.Value(100)
	gui.FormSerialMangement.lbl1.Caption("100%")
	
	
	

	'f.Intrinsic.Control.UnBlockEvents
	
	F.Intrinsic.Control.ExitSub
		
F.Intrinsic.Control.Catch
	f.Intrinsic.Control.CallSub(ErrorMsg, CurrentSub, v.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.GsGridControlCSRHist_RowCellClick.End

Program.Sub.GsGridControlOrigSO_RowCellClick.Start
v.Local.sID.Declare
v.Local.sInc.Declare
v.Local.sType.Declare
v.Local.sNotes.Declare
f.Intrinsic.Control.Try
	gui.FormSerialMangement.GsGridControlOrigSO.GetCellValueByColumnName("GOrigSO", "Incident_ID", v.Args.RowIndex, v.Local.sID)
	gui.FormSerialMangement.GsGridControlOrigSO.GetCellValueByColumnName("GOrigSO", "Incident", v.Args.RowIndex, v.Local.sInc)
	gui.FormSerialMangement.GsGridControlOrigSO.GetCellValueByColumnName("GOrigSO", "Incident_Type", v.Args.RowIndex, v.Local.sType)
	gui.FormSerialMangement.GsGridControlOrigSO.GetCellValueByColumnName("GOrigSO", "Notes", v.Args.RowIndex, v.Local.sNotes)
	'Set Controls
	'f.Intrinsic.Control.BlockEvents
	gui.FormSerialMangement.txtIncident.Text(v.Local.sID)
	gui.FormSerialMangement.ddlIncidentType.Text(v.Local.sType)
	gui.FormSerialMangement.ddlIncident.Text(v.Local.sInc)	
	gui.FormSerialMangement.txtSiteName.Text(v.Local.sNotes)
	'f.Intrinsic.Control.UnBlockEvents
f.Intrinsic.Control.Catch
	f.Intrinsic.Control.CallSub(ErrorMsg, CurrentSub, v.Ambient.CurrentSubroutine)
f.Intrinsic.Control.EndTry
Program.Sub.GsGridControlOrigSO_RowCellClick.End

Program.Sub.cmdContact_Click.Start
'v.Local.sContact.Declare
'v.Local.sRet.Declare
'v.Local.sCustomer.Declare	
'v.Local.sSQL.Declare
'f.Intrinsic.Control.Try
'	v.Local.sCustomer.Set(v.Screen.FormSerialMangement!txtCustomer.Text)
'	
'	f.Intrinsic.Control.If(v.Local.sCustomer.Trim, =, "")
'		f.Intrinsic.UI.Msgbox("Please select a Customer.")
'		f.Intrinsic.Control.ExitSub
'	f.Intrinsic.Control.EndIf
'	
'	f.Intrinsic.String.Build("Select Cust,TYPE,NAME,SEQ,PHONE1,EMAIL1,ALT_ID From V_Contact where Type = 'C' and Cust = '{0}'", v.Local.sCustomer, v.Local.sSQL)
'	
'	f.Intrinsic.UI.SetBrowserHotTypeAhead(true)
''	
''	f.Intrinsic.Control.If(v.ODBC.con.State, =, 1)
''		f.ODBC.Connection!con.Close
''	f.Intrinsic.Control.EndIf
'	
'	f.ODBC.Connection!con.OpenCompanyConnection
'		f.Intrinsic.UI.Browser("Contacts", "con", v.Local.sSQL, "Cust*!*TYPE*!*NAME*!*SEQ*!*PHONE1*!*EMAIL1*!*ALT_ID", "60*!*40*!*80*!*40*!*80*!*120*!*40", v.Local.sRet)
'	f.ODBC.Connection!con.Close
'	
'	f.Intrinsic.Control.If(v.Local.sRet, <>, "***CANCEL***")
'		f.Intrinsic.String.Split(v.Local.sRet, "*!*", v.Local.sContact)
'		gui.FormSerialMangement.txtCustContactNumber.Text(v.Local.sContact(6))
'		gui.FormSerialMangement.txtContactCust.Text(v.Local.sContact(2))
'		gui.FormSerialMangement.txtConCustPhone.Text(v.Local.sContact(4))
'		gui.FormSerialMangement.txtConCustEmail.Text(v.Local.sContact(5))
'	f.Intrinsic.Control.EndIf
'	
'f.Intrinsic.Control.Catch
'	f.Intrinsic.Control.CallSub(ErrorMsg, CurrentSub, v.Ambient.CurrentSubroutine)
'f.Intrinsic.Control.EndTry
Program.Sub.cmdContact_Click.End

Program.Sub.cmdPreferredVendor_Click.Start
v.Local.sRet.Declare
v.Local.sVendors.Declare
f.Intrinsic.Control.Try
	f.Intrinsic.UI.SetBrowserHotTypeAhead(true)
	f.Intrinsic.UI.Browser(300, , v.Local.sRet)
	f.Intrinsic.Control.If(v.Local.sRet, <>, "***CANCEL***")
		f.Intrinsic.String.Split(v.Local.sRet, "*!*", v.Local.sVendors)
		gui.FormSerialMangement.txtVendor.Text(v.Local.sVendors(0))
		gui.FormSerialMangement.txtVendorName.Text(v.Local.sVendors(1))
	f.Intrinsic.Control.EndIf
f.Intrinsic.Control.Catch
	f.Intrinsic.Control.CallSub(ErrorMsg, CurrentSub, v.Ambient.CurrentSubroutine)
f.Intrinsic.Control.EndTry
Program.Sub.cmdPreferredVendor_Click.End

Program.Sub.cmdVendorContact_Click.Start
v.Local.sContact.Declare
v.Local.sRet.Declare
v.Local.sVendor.Declare
v.Local.sSQL.Declare
f.Intrinsic.Control.Try

	v.Local.sVendor.Set(v.Screen.FormSerialMangement!txtVendor.Text)
	f.Intrinsic.Control.If(v.Local.sVendor.Trim, =, "")
		f.Intrinsic.UI.Msgbox("Please select a Vendor.")
		f.Intrinsic.Control.ExitSub
	f.Intrinsic.Control.EndIf
	
	f.Intrinsic.String.Build("Select Cust,TYPE,NAME,SEQ,PHONE1,EMAIL1,ALT_ID From V_Contact where Type = 'V' and Cust = '{0}'", v.Local.sVendor, v.Local.sSQL)
	
	f.Intrinsic.UI.SetBrowserHotTypeAhead(true)
	
'	f.Intrinsic.Control.If(v.ODBC.con.State, =, 1)
'		f.ODBC.Connection!con.Close
'	f.Intrinsic.Control.EndIf
	
	f.ODBC.Connection!con.OpenCompanyConnection
		f.Intrinsic.UI.Browser("Contacts", "con", v.Local.sSQL, "Cust*!*TYPE*!*NAME*!*SEQ*!*PHONE1*!*EMAIL1*!*ALT_ID", "60*!*40*!*80*!*40*!*80*!*120*!*40", v.Local.sRet)
	f.ODBC.Connection!con.Close
	
	f.Intrinsic.Control.If(v.Local.sRet, <>, "***CANCEL***")
		f.Intrinsic.String.Split(v.Local.sRet, "*!*", v.Local.sContact)
		gui.FormSerialMangement.txtVendContactNumber.Text(v.Local.sContact(6))
		gui.FormSerialMangement.txtVendorContact.Text(v.Local.sContact(2))
		gui.FormSerialMangement.txtVendorPhone.Text(v.Local.sContact(4))
		gui.FormSerialMangement.txtVendorEmail.Text(v.Local.sContact(5))
	f.Intrinsic.Control.EndIf
	
f.Intrinsic.Control.Catch
	f.Intrinsic.Control.CallSub(ErrorMsg, CurrentSub, v.Ambient.CurrentSubroutine)
f.Intrinsic.Control.EndTry
Program.Sub.cmdVendorContact_Click.End

Program.Sub.GsGridControlServSO_RowCellClick.Start
 v.Local.sPart.Declare
 v.Local.sLocation.Declare
 v.Local.sOrderNo.Declare
 v.Local.sParams.Declare
 v.Local.sCustomer.Declare
 v.Local.sSQL.Declare
v.Local.sPO.Declare
v.Local.bOrderHist.Declare

v.Local.sColumn.Declare

f.Intrinsic.Control.Try


	'f.Intrinsic.Control.BlockEvents
	gui.FormSerialMangement.pBar1.Value(0)
	gui.FormSerialMangement.lbl1.Caption("0%")
	
	f.Intrinsic.String.UCase(v.Args.Column, v.Local.sColumn)
	f.Intrinsic.Control.SelectCase(v.Local.sColumn)
		f.Intrinsic.Control.Case("ORDER_NO")
			v.Local.sOrderNo.Set(v.DataTable.ServSO(v.Args.RowIndex).Order_No!FieldValTrim)
			
'			f.Intrinsic.Control.If(v.ODBC.con.State, =, 1)
'				f.ODBC.Connection!con.Close
'			f.Intrinsic.Control.EndIf
			gui.FormSerialMangement.pBar1.Value(30) 
			gui.FormSerialMangement.lbl1.Caption("30%")
			
			f.ODBC.Connection!con.OpenCompanyConnection
				f.Intrinsic.String.Build("Select * from v_order_header where Order_No = '{0}'", v.Local.sOrderNo, v.Local.sSQL)
				f.Data.DataTable.CreateFromSQL("orderDT", "con", v.Local.sSQL)
					gui.FormSerialMangement.pBar1.Value(40)
					gui.FormSerialMangement.lbl1.Caption("40%")
					f.Intrinsic.Control.If(v.DataTable.orderDT.RowCount, =, 1)
						v.Local.sCustomer.Set(v.DataTable.orderDT(0).Customer!FieldValTrim)
						gui.FormSerialMangement.pBar1.Value(50)
						gui.FormSerialMangement.lbl1.Caption("50%")
					f.Intrinsic.Control.Else
						f.Intrinsic.String.Build("Select distinct customer from V_ORDER_HIST_HEAD where Order_No = '{0}'", v.Local.sOrderNo, v.Local.sSQL)
						f.Data.DataTable.CreateFromSQL("orderHistDT", "con", v.Local.sSQL)
						f.Intrinsic.Control.If(v.DataTable.orderHistDT.RowCount, =, 1)
							v.Local.sCustomer.Set(v.DataTable.orderHistDT(0).Customer!FieldValTrim)
							v.Local.bOrderHist.Set(true)
						f.Intrinsic.Control.Else
							gui.FormSerialMangement.pBar1.Value(100)
							gui.FormSerialMangement.lbl1.Caption("100%")
							f.Intrinsic.UI.Msgbox("Multiple Customers are asociated with this Order.")
							v.Local.sCustomer.Set("*!*ZDR*!*")
						f.Intrinsic.Control.EndIf	
						f.Data.DataTable.Close("orderHistDT")
					f.Intrinsic.Control.EndIf					
				f.Data.DataTable.Close("orderDT")
			f.ODBC.Connection!con.Close
			
			gui.FormSerialMangement.pBar1.Value(70)
			gui.FormSerialMangement.lbl1.Caption("70%")
			
			f.Intrinsic.Control.If(v.Local.bOrderHist)
				f.Intrinsic.String.Build("{0}!*!{1}", v.Local.sOrderNo, v.Local.sCustomer, v.Local.sParams)
				gui.FormSerialMangement.pBar1.Value(100)
				gui.FormSerialMangement.lbl1.Caption("100%")
				f.Global.General.CallwrapperAsync(7070 , v.Local.sParams)
			f.Intrinsic.Control.Else
				f.Intrinsic.String.Build("{0}!*!O!*!{1}", v.Local.sOrderNo, v.Local.sCustomer, v.Local.sParams)
				gui.FormSerialMangement.pBar1.Value(100)
				gui.FormSerialMangement.lbl1.Caption("100%")
				f.Global.General.CallwrapperAsync(200000, v.Local.sParams)
			f.Intrinsic.Control.EndIf
			
		f.Intrinsic.Control.Case("PART")
			gui.FormSerialMangement.pBar1.Value(30)
			gui.FormSerialMangement.lbl1.Caption("30%")
			v.Local.sPart.Set(v.DataTable.ServSO(v.Args.RowIndex).Part!FieldValTrim)
			v.Local.sLocation.Set("  ")
			gui.FormSerialMangement.pBar1.Value(60)
			gui.FormSerialMangement.lbl1.Caption("60%")
			f.Intrinsic.String.Build("{0}!*!O!*!*!*ZDR*!*!*!*!*ZDR*!*!*!{1}!*!{2}", v.Caller.CompanyCode, v.Local.sPart, v.Local.sLocation, v.Local.sParams)
			gui.FormSerialMangement.pBar1.Value(100)
			gui.FormSerialMangement.lbl1.Caption("100%")
			f.Global.General.CallwrapperAsync(3500, v.Local.sParams)
			
		f.Intrinsic.Control.Case("PO")
			gui.FormSerialMangement.pBar1.Value(30)
			gui.FormSerialMangement.lbl1.Caption("30%")
			v.Local.sPO.Set(v.DataTable.ServSO(v.Args.RowIndex).PO!FieldValTrim)
			gui.FormSerialMangement.pBar1.Value(60)
			gui.FormSerialMangement.lbl1.Caption("60%")
			f.Intrinsic.String.Build("O!*!{0}!*!*!*ZDR*!*", v.Local.sPO, v.Local.sParams)
			gui.FormSerialMangement.pBar1.Value(100)
			gui.FormSerialMangement.lbl1.Caption("100%")
			f.Global.General.CallwrapperAsync(175200, v.Local.sParams)
	f.Intrinsic.Control.EndSelect
	
	'f.Intrinsic.Control.UnBlockEvents
f.Intrinsic.Control.Catch
	f.Intrinsic.Control.CallSub(ErrorMsg, CurrentSub, v.Ambient.CurrentSubroutine)
f.Intrinsic.Control.EndTry
Program.Sub.GsGridControlServSO_RowCellClick.End

Program.Sub.GsGridControlbomWOBOM_RowCellClick.Start
v.Local.sJob.Declare
v.Local.sSuffix.Declare
v.Local.sPart.Declare
v.Local.sParams.Declare
v.Local.sColumn.Declare

f.Intrinsic.Control.Try

	'f.Intrinsic.Control.BlockEvents
	gui.FormSerialMangement.pBar1.Value(0)
	gui.FormSerialMangement.lbl1.Caption("0%")
	
	f.Intrinsic.String.UCase(v.Args.Column, v.Local.sColumn)
	f.Intrinsic.Control.SelectCase(v.Local.sColumn)
		f.Intrinsic.Control.Case("JOB")
			gui.FormSerialMangement.pBar1.Value(30)
			gui.FormSerialMangement.lbl1.Caption("30%")
			v.Local.sJob.Set(v.DataTable.WOBOM(v.Args.RowIndex).Job!FieldValTrim)
			v.Local.sSuffix.Set(v.DataTable.WOBOM(v.Args.RowIndex).Suffix!FieldValTrim)
			f.Intrinsic.String.Build("7!*!{0}!*!{1}!*!A", v.Local.sJob, v.Local.sSuffix, v.Local.sParams)
			gui.FormSerialMangement.pBar1.Value(100)
			gui.FormSerialMangement.lbl1.Caption("100%")
			f.Global.General.CallwrapperAsync(450000, v.Local.sParams)
		f.Intrinsic.Control.Case("SUFFIX")
			gui.FormSerialMangement.pBar1.Value(30)
			gui.FormSerialMangement.lbl1.Caption("30%")
			v.Local.sJob.Set(v.DataTable.WOBOM(v.Args.RowIndex).Job!FieldValTrim)
			v.Local.sSuffix.Set(v.DataTable.WOBOM(v.Args.RowIndex).Suffix!FieldValTrim)
			f.Intrinsic.String.Build("7!*!{0}!*!{1}!*!A", v.Local.sJob, v.Local.sSuffix, v.Local.sParams)
			gui.FormSerialMangement.pBar1.Value(100)
			gui.FormSerialMangement.lbl1.Caption("100%")
			f.Global.General.CallwrapperAsync(450000, v.Local.sParams)
		f.Intrinsic.Control.Case("PART")
			'Change to Open Suply and Demand.
			gui.FormSerialMangement.pBar1.Value(30)
			gui.FormSerialMangement.lbl1.Caption("30%")
			v.Local.sPart.Set(v.DataTable.WOBOM(v.Args.RowIndex).Part!FieldValTrim)
			'f.Intrinsic.String.Build("{0}!*!O!*!*!*ZDR*!*!*!*!*ZDR*!*!*!{1}!*!  ", v.Caller.CompanyCode, v.Local.sPart, v.Local.sParams)
			f.Intrinsic.String.Build("{0}!*!  ", v.Local.sPart, v.Local.sParams)
			gui.FormSerialMangement.pBar1.Value(100)
			gui.FormSerialMangement.lbl1.Caption("100%")
			'f.Global.General.CallwrapperAsync(3500, v.Local.sParams)
			
			f.Global.General.CallwrapperAsync(300010 , v.Local.sParams)
	f.Intrinsic.Control.EndSelect
	
	'f.Intrinsic.Control.UnBlockEvents
f.Intrinsic.Control.Catch
	f.Intrinsic.Control.CallSub(ErrorMsg, CurrentSub, v.Ambient.CurrentSubroutine)
f.Intrinsic.Control.EndTry
Program.Sub.GsGridControlbomWOBOM_RowCellClick.End

Program.Sub.cleanTxt.Start
f.Intrinsic.Control.Try
	'gui.FormSerialMangement.txtSerial.Text("")
	'gui.FormSerialMangement.txtCustomer.Text("")
	gui.FormSerialMangement.txtCustomer.Text("")
	gui.FormSerialMangement.txtCustomer.Text("")
	'gui.FormSerialMangement.txtCustContactNumber.Text("")
	'gui.FormSerialMangement.txtVendContactNumber.Text("")
	'gui.FormSerialMangement.txtContactCust.Text("")
	'gui.FormSerialMangement.txtConCustPhone.Text("")
	'gui.FormSerialMangement.txtConCustEmail.Text("")
	'gui.FormSerialMangement.txtSiteName.Text("")
	'gui.FormSerialMangement.txtSiteContact.Text("")
	'gui.FormSerialMangement.txtVendor.Text("")
	'gui.FormSerialMangement.txtVendorName.Text("")
	'gui.FormSerialMangement.txtVendorContact.Text("")
	'gui.FormSerialMangement.txtVendorPhone.Text("")
	'gui.FormSerialMangement.txtVendorEmail.Text("")
f.Intrinsic.Control.Catch
	f.Intrinsic.Control.CallSub(ErrorMsg, CurrentSub, v.Ambient.CurrentSubroutine)
f.Intrinsic.Control.EndTry
Program.Sub.cleanTxt.End

Program.Sub.loadSO_WO.Start
v.Local.sSQL.Declare
v.Local.sRet.Declare
f.Intrinsic.Control.Try
	
	f.Intrinsic.Control.If(v.DataTable.orderToWoDT.RowCount, >, 0)
		f.Data.DataTable.DeleteRow("orderToWoDT")
		f.Data.DataTable.AcceptChanges("orderToWoDT")
	f.Intrinsic.Control.EndIf
	
	f.Intrinsic.String.Build("Select Job, Suffix, Order_no, Order_line, Part, Description from Order_to_wo where Order_No+Order_Line in (Select Order_No+Record_No from V_Order_Lines where Order_no in (Select distinct Order_No from V_Order_Header where User_1 = '{0}')) ", v.Args.sSerialNumber, v.Local.sSQL)
	f.ODBC.Connection!con.OpenCompanyConnection
		f.Data.DataTable.CreateFromSQL("tempOrderToWoDT", "con", v.Local.sSQL)
		f.Intrinsic.Control.If(v.DataTable.tempOrderToWoDT.RowCount, =, 0)
			f.Data.DataTable.Close("tempOrderToWoDT")
			f.Intrinsic.String.Build("Select Job, Suffix, Order_no, Order_line, Part, Description from Order_to_wo where Order_No+Order_Line in (Select Order_No+Record_No from V_Order_Lines where Order_no in (Select distinct Order_No from V_ORDER_HIST_HEAD where User_1 = '{0}')) ", v.Args.sSerialNumber, v.Local.sSQL)
		f.Intrinsic.Control.Else
			f.Data.DataTable.Merge("tempOrderToWoDT", "orderToWoDT", false, 2)
			f.Data.DataTable.Close("tempOrderToWoDT")	
		f.Intrinsic.Control.EndIf
	f.ODBC.Connection!con.Close	
	
	f.Intrinsic.Control.If(v.DataView.orderToWoDT!orderToWoDV.Exists)
		f.Data.DataView.Close("orderToWoDT", "orderToWoDV")
	f.Intrinsic.Control.EndIf
	
	f.Data.DataView.Create("orderToWoDT", "orderToWoDV", 22)
'	f.Data.DataView.ToDataTableDistinct("orderToWoDT", "orderToWoDV", "jobSuffixDT", "Job*!*Suffix")
'	f.Data.DataView.Close("orderToWoDT", "orderToWoDV")
'	f.Data.DataView.Create("jobSuffixDT", "jobSuffixDV", 22)
	f.Data.DataView.ToString("orderToWoDT", "orderToWoDV", "Job*!*Suffix", "", "','", v.Local.sRet )

	
	f.ODBC.Connection!con.OpenCompanyConnection
		F.Intrinsic.String.Build("Select Job, Suffix, Seq, Job+Suffix as Job_Part, Part, Job+Suffix+Seq as SerialNumber, Description From V_Job_Hist_Dtl Where Job+Suffix in ('{0}') and LMO = 'M' Order by Suffix",V.Local.sRet,V.Local.sSql)
		F.Data.DataTable.CreateFromSQL("TempChildWO","con",V.Local.sSql)
		F.Intrinsic.Control.If(V.DataTable.TempChildWO.RowCount--,=,-1)
			F.Data.DataTable.Close("TempChildWO")
			F.Intrinsic.String.Build("Select Job, Suffix, Seq, Job+Suffix as Job_Part, Part, Job+Suffix+Seq as SerialNumber, Description From V_Job_Detail Where Job+Suffix in ('{0}') and LMO = 'M' Order by Suffix",V.Local.sRet,V.Local.sSql)
			F.Data.DataTable.CreateFromSQL("TempChildWO","con",V.Local.sSql)
		F.Intrinsic.Control.EndIf
		
		'f.Data.DataTable.AddColumn("TempChildWO", "Quantity", "Float")
		

		F.Data.DataTable.DeleteRow("orderToWoDT$ChildWO")
		F.Data.DataTable.AcceptChanges("orderToWoDT$ChildWO")
		F.Data.DataTable.Merge("TempChildWO","orderToWoDT$ChildWO",False,4)
		F.Data.DataTable.Close("TempChildWO")

		F.Data.Dictionary.CreateFromSQL("QuantityDict","con","Select Job+Suffix+Seq as Job_Part, Hours_Actual as Quantity from V_JOB_OPERATIONS union Select Job+Suffix as Job_Part, Hours_Actual as Quantity from V_JOB_HIST_OPS")
		F.Data.Dictionary.SetDefaultReturn("QuantityDict","0")
		F.Data.DataTable.FillFromDictionary("orderToWoDT$ChildWO","QuantityDict", "SerialNumber", "Quantity")
		f.Data.Dictionary.Close("QuantityDict")

	
		'f.Data.DataTable.AddRelation("orderToWoDT", "Job", "ChildWO", "Job", "childOrderToWo")
	
'	F.Data.Dictionary.CreateFromSQL("Warranty","con","Select Part, 'Y' as Warranty From V_Inventory_Mstr Where Flag_Warranty = 'Y'")
'	F.Data.Dictionary.SetDefaultReturn("Warranty","N")
'	F.Data.DataTable.FillFromDictionary("WOBOM","Warranty","Part","Warranty")
'	F.Data.Dictionary.Close("Warranty")
'	
'	F.Data.Dictionary.CreateFromSQL("JobPart","con","Select Job+Suffix as Job_Part, Part from V_Job_Header union Select Job+Suffix as Job_Part, Part from V_job_hist_mast")
'	F.Data.Dictionary.SetDefaultReturn("JobPart","")
'	F.Data.DataTable.FillFromDictionary("WOBOM","JobPart", "Job_Part", "Job_Part")
'	F.Data.Dictionary.Close("JobPart")
'	

''******************
'	f.Intrinsic.Control.If(v.DataTable.WOBOM.RowCount, >, 0)
'	
'		v.Local.sJobPart.Set(v.DataTable.WOBOM(0).Job_Part!FieldValTrim)
'		f.Intrinsic.String.Build("Select Part from V_BOM_MSTR where Parent ='{0}' and Category = 'R'", v.Local.sJobPart, v.Local.sSql)
'		f.Data.DataTable.CreateFromSQL("DrawingsDT", "con", v.Local.sSql, true)
'		v.Local.sSql.Set("")
'		f.Intrinsic.Control.For(v.Local.iCnt, 0, v.DataTable.DrawingsDT.RowCount--, 1)
'			v.Local.sDRWPart.Set(v.DataTable.DrawingsDT(v.Local.iCnt).Part!FieldVal)
'			f.Intrinsic.String.RPad(v.Local.sDRWPart, " ", 20, v.Local.sDRWPart)
'			f.Intrinsic.Control.If(v.Local.sSql.Trim, =, "")
'				f.Intrinsic.String.Build("'{0}' {1}", v.Local.sDRWPart, v.Local.sSql, v.Local.sSql)
'			f.Intrinsic.Control.Else
'				f.Intrinsic.String.Build("'{0}', {1}", v.Local.sDRWPart, v.Local.sSql, v.Local.sSql)
'			f.Intrinsic.Control.EndIf
'			
'			f.Data.DataTable.AddRow("WOBOM", "Job", v.Local.sJob, "Suffix", "000", "Seq", "", "Job_Part", v.Local.sJobPart, "SerialNumber", "", "Part", v.Local.sDRWPart, "Description", v.Local.sDRWPart, "Warranty", "N")
'		f.Intrinsic.Control.Next(v.Local.iCnt)
'		f.Data.DataTable.Close("DrawingsDT")
'		
'		f.Intrinsic.String.Build("Select Part, Description from V_Inventory_Mstr where Part in ({0})", v.Local.sSql, V.Local.sSql)
'		f.Data.Dictionary.CreateFromSQL("descriptionDict", "con", v.Local.sSql)
'		F.Data.DataTable.FillFromDictionary("WOBOM","descriptionDict", "Description", "Description")
'		F.Data.Dictionary.Close("descriptionDict")
'		
'		F.Data.Dictionary.CreateFromSQL("Serial_NumberDict","con","Select  Job+Suffix+Sequence as JobSuffixSeq, Serial_number from V_Item_History where Code_Transaction = 'J55'")
'		F.Data.Dictionary.SetDefaultReturn("Serial_NumberDict","")
'		F.Data.DataTable.FillFromDictionary("WOBOM","Serial_NumberDict", "SerialNumber", "SerialNumber")
'		F.Data.Dictionary.Close("Serial_NumberDict")
'		
'		F.Intrinsic.String.Build("Select Top 1 Job+Suffix From V_Item_History Where Serial_Number = '{0}' and Part = '{1}'",V.Screen.FormSerialMangement!txtSerial.Text,V.Local.sPart,V.Local.sSql)
'		F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.sJob)
'	f.Intrinsic.Control.EndIf
	
	
	f.ODBC.Connection!con.Close
	
'	
'	Function.Intrinsic.Debug.InvokeDebugger
'	Function.Intrinsic.Debug.Stop
'	
'	Gui.FormSerialMangement.GsGcOrderToWO.AddGridviewFromDatatable("GCHILDWO", "orderToWoDT$ChildWO")
''	Gui.FormSerialMangement.GsGcOrderToWO.SetGridviewProperty("GCHILDWO","ReadOnly",True)
''	Gui.FormSerialMangement.GsGcOrderToWO.SetGridviewProperty("GCHILDWO","Editable",False)
''	Gui.FormSerialMangement.GsGcOrderToWO.SetGridviewProperty("GCHILDWO","OptionsSelectionEnableAppearanceFocusedRow",False)
'	
'	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Job","Caption","Job")
'	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Suffix","Caption","Suffix")
'	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Seq","Caption","Seq")
'	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Job_Part","Caption","Job Part")
'	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Part","Caption","Part")
'	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Description","Caption","Description")
'	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Warranty","Caption","Warranty")
'	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","SerialNumber","Caption","Serial Number")
'	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Quantity","Caption","Quantity")
'	
''	gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO", "Job", "CellForeColor", v.Color.LtBlue)
''	gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO", "Suffix", "CellForeColor", v.Color.LtBlue)
''	gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO", "Part", "CellForeColor", v.Color.LtBlue)
''	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO", "Job_Part", "CellForeColor", v.Color.LtBlue)
'	
'	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Warranty","Visible",False)
'	
'	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Job","HeaderBackColor",v.Color.GSS)
'	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Job","HeaderForeColor","White")
'	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Suffix","HeaderBackColor",v.Color.GSS)
'	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Suffix","HeaderForeColor","White")
'	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Part","HeaderBackColor",v.Color.GSS)
'	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Part","HeaderForeColor","White")
'	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Description","HeaderBackColor",v.Color.GSS)
'	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Description","HeaderForeColor","White")
'	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Warranty","HeaderBackColor",v.Color.GSS)
'	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Warranty","HeaderForeColor","White")
'	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Seq","HeaderBackColor",v.Color.GSS)
'	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Seq","HeaderForeColor","White")
'	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Job_Part","HeaderBackColor",v.Color.GSS)
'	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Job_Part","HeaderForeColor","White")
'	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","SerialNumber","HeaderBackColor",v.Color.GSS)
'	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","SerialNumber","HeaderForeColor","White")
'	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Quantity","HeaderBackColor",v.Color.GSS)
'	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Quantity","HeaderForeColor","White")
'	
'	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Job","Width","30")
'	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Suffix","Width","30")
'	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Seq","Width","30")
'	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Job_Part","Width","30")
'	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","Part","Width","30")
'	Gui.FormSerialMangement.GsGcOrderToWO.SetColumnProperty("GCHILDWO","SerialNumber","Width","30")
''	
'	Gui.FormSerialMangement.GsGcOrderToWO.AddStyleFormatCondition("GCHILDWO","Warranty","ParentGreen","Equal","Y")
'    	Gui.FormSerialMangement.GsGcOrderToWO.SetStyleFormatConditionProperty("GCHILDWO","Warranty","ParentGreen","BackColor", v.Color.LtGreen)
'    	Gui.FormSerialMangement.GsGcOrderToWO.SetStyleFormatConditionProperty("GCHILDWO","Warranty","ParentGreen","ApplyToRow",True)
	
f.Intrinsic.Control.Catch
	f.Intrinsic.Control.CallSub(ErrorMsg, CurrentSub, v.Ambient.CurrentSubroutine)
f.Intrinsic.Control.EndTry
Program.Sub.loadSO_WO.End

Program.Sub.GsGcOrderToWO_RowCellClick.Start
 v.Local.sPart.Declare
 v.Local.sLocation.Declare
 v.Local.sOrderNo.Declare
 v.Local.sParams.Declare
 v.Local.sCustomer.Declare
 v.Local.sSQL.Declare
v.Local.sPO.Declare
v.Local.bOrderHist.Declare

v.Local.sJob.Declare
v.Local.sSuffix.Declare

v.Local.sColumn.Declare

f.Intrinsic.Control.Try

	'f.Intrinsic.Control.BlockEvents
	gui.FormSerialMangement.pBar1.Value(0)
	gui.FormSerialMangement.lbl1.Caption("0%")
	
	f.Intrinsic.String.UCase(v.Args.Column, v.Local.sColumn)
	f.Intrinsic.Control.SelectCase(v.Local.sColumn)
	
	gui.FormSerialMangement.pBar1.Value(50)
	gui.FormSerialMangement.lbl1.Caption("50%")
	
		f.Intrinsic.Control.Case("SUFFIX")
			v.Local.sJob.Set(v.DataTable.orderToWoDT(v.Args.RowIndex).Job!FieldValTrim)
			v.Local.sSuffix.Set(v.DataTable.orderToWoDT(v.Args.RowIndex).Suffix!FieldValTrim)
			f.Intrinsic.String.Build("7!*!{0}!*!{1}!*!A", v.Local.sJob, v.Local.sSuffix, v.Local.sParams)
			gui.FormSerialMangement.pBar1.Value(100)
			gui.FormSerialMangement.lbl1.Caption("100%")
			f.Global.General.CallwrapperAsync(450000, v.Local.sParams)
		f.Intrinsic.Control.Case("PART")
			v.Local.sPart.Set(v.DataTable.orderToWoDT(v.Args.RowIndex).Part!FieldValTrim)
			f.Intrinsic.String.Build("{0}!*!O!*!*!*ZDR*!*!*!*!*ZDR*!*!*!{1}!*!  ", v.Caller.CompanyCode, v.Local.sPart, v.Local.sParams)
			f.Global.General.CallwrapperAsync(3500, v.Local.sParams)
			gui.FormSerialMangement.pBar1.Value(100)
			gui.FormSerialMangement.lbl1.Caption("100%")
		f.Intrinsic.Control.Case("ORDER_NO")
			v.Local.sOrderNo.Set(v.DataTable.orderToWoDT(v.Args.RowIndex).Order_No!FieldValTrim)
			
'			f.Intrinsic.Control.If(v.ODBC.con.State, =, 1)
'				f.ODBC.Connection!con.Close
'			f.Intrinsic.Control.EndIf
			
			gui.FormSerialMangement.pBar1.Value(50)
			gui.FormSerialMangement.lbl1.Caption("50%")
			
			f.ODBC.Connection!con.OpenCompanyConnection
				f.Intrinsic.String.Build("Select * from v_order_header where Order_No = '{0}'", v.Local.sOrderNo, v.Local.sSQL)
				f.Data.DataTable.CreateFromSQL("orderDT", "con", v.Local.sSQL)
					f.Intrinsic.Control.If(v.DataTable.orderDT.RowCount, =, 1)
						v.Local.sCustomer.Set(v.DataTable.orderDT(0).Customer!FieldValTrim)
					f.Intrinsic.Control.Else
						f.Intrinsic.String.Build("Select distinct customer from V_ORDER_HIST_HEAD where Order_No = '{0}'", v.Local.sOrderNo, v.Local.sSQL)
						f.Data.DataTable.CreateFromSQL("orderHistDT", "con", v.Local.sSQL)
						f.Intrinsic.Control.If(v.DataTable.orderHistDT.RowCount, =, 1)
							v.Local.sCustomer.Set(v.DataTable.orderHistDT(0).Customer!FieldValTrim)
							v.Local.bOrderHist.Set(true)
						f.Intrinsic.Control.Else
							f.Intrinsic.UI.Msgbox("Multiple Customers are asociated with this Order.")
							v.Local.sCustomer.Set("*!*ZDR*!*")
						f.Intrinsic.Control.EndIf	
						f.Data.DataTable.Close("orderHistDT")
					f.Intrinsic.Control.EndIf					
				f.Data.DataTable.Close("orderDT")
			f.ODBC.Connection!con.Close
			gui.FormSerialMangement.pBar1.Value(70)
			gui.FormSerialMangement.lbl1.Caption("70%")
			
			f.Intrinsic.Control.If(v.Local.bOrderHist)
				f.Intrinsic.String.Build("{0}!*!{1}", v.Local.sOrderNo, v.Local.sCustomer, v.Local.sParams)
				gui.FormSerialMangement.pBar1.Value(100)
				gui.FormSerialMangement.lbl1.Caption("100%")
				f.Global.General.CallwrapperAsync(7070 , v.Local.sParams)
			f.Intrinsic.Control.Else
				f.Intrinsic.String.Build("{0}!*!O!*!{1}", v.Local.sOrderNo, v.Local.sCustomer, v.Local.sParams)
				f.Global.General.CallwrapperAsync(200000, v.Local.sParams)
				gui.FormSerialMangement.pBar1.Value(100)
				gui.FormSerialMangement.lbl1.Caption("100%")
			f.Intrinsic.Control.EndIf
	f.Intrinsic.Control.EndSelect
	
	'f.Intrinsic.Control.UnBlockEvents
f.Intrinsic.Control.Catch
	f.Intrinsic.Control.CallSub(ErrorMsg, CurrentSub, v.Ambient.CurrentSubroutine)
f.Intrinsic.Control.EndTry
Program.Sub.GsGcOrderToWO_RowCellClick.End

Program.Sub.loadTxt.Start
'v.Local.sRef.Declare
'v.Local.sSerial.Declare
'v.Local.sSQL.Declare
'f.Intrinsic.Control.Try

'	f.Intrinsic.Control.If(v.ODBC!con.State, =, 1)
'		f.ODBC.Connection!con.Close
'	f.Intrinsic.Control.EndIf
'	
'	v.Local.sRef.Set(v.Screen.FormSerialMangement!txtCustomer.Text)
'	'gui.FormSerialMangement.txtCustomer.Text(v.Local.sRef)
'	v.Local.sSerial.Set(v.Screen.FormSerialMangement!txtSerial.Text)
'	
'	f.ODBC.Connection!con.OpenCompanyConnection
'		f.Intrinsic.String.Build("Select Name_Customer from V_customer_Master where Customer = '{0}'", v.Local.sRef, v.Local.sSql)
'		f.ODBC.Connection!con.ExecuteAndReturn(v.Local.sSql, v.Local.sRef)
'		f.Intrinsic.String.Build("Select * from GCG_5530_CSR_INFO where Serial_Number = '{0}'", v.Local.sSerial, v.Local.sSql)
'		f.Data.DataTable.CreateFromSQL("csrDT", "con", v.Local.sSql)
'	f.ODBC.Connection!con.Close
'	
'	'gui.FormSerialMangement.txtCustName.Text(v.Local.sRef.Trim)
'	
'	f.Intrinsic.Control.If(v.DataTable.csrDT.RowCount, =, 1)
'		gui.FormSerialMangement.txtCustomer.Text(v.DataTable.csrDT(0).Customer!FieldValTrim)
'		gui.FormSerialMangement.txtCustomer.Text(v.DataTable.csrDT(0).Customer_Name!FieldValTrim)
'		gui.FormSerialMangement.txtContactCust.Text(v.DataTable.csrDT(0).ContactCustName!FieldValTrim)
'		gui.FormSerialMangement.txtConCustPhone.Text(v.DataTable.csrDT(0).ContactCustPhone!FieldValTrim)
'		gui.FormSerialMangement.txtConCustEmail.Text(v.DataTable.csrDT(0).ContactCustEmail!FieldValTrim)
'		
'		'gui.FormSerialMangement.txtCustContactNumber.Text(v.DataTable.csrDT(0).CONTACTCUSTNUM!FieldValTrim)
'		'gui.FormSerialMangement.txtVendContactNumber.Text(v.DataTable.csrDT(0).CONTACTVENDNUM!FieldValTrim)
'		
'		v.Local.sRef.Set(v.DataTable.csrDT(0).Site_Names!FieldValTrim)
'		f.Intrinsic.String.Replace(v.Local.sRef, "!*!", v.Ambient.NewLine, v.Local.sRef)
'		gui.FormSerialMangement.txtSiteName.Text(v.Local.sRef)
'		
'		v.Local.sRef.Set(v.DataTable.csrDT(0).Site_Contacts!FieldValTrim)
'		f.Intrinsic.String.Replace(v.Local.sRef, "!*!", v.Ambient.NewLine, v.Local.sRef)
'		gui.FormSerialMangement.txtSiteContact.Text(v.Local.sRef)
'		
'		gui.FormSerialMangement.txtVendor.Text(v.DataTable.csrDT(0).Vendor!FieldValTrim)
'		gui.FormSerialMangement.txtVendorName.Text(v.DataTable.csrDT(0).Vendor_Name!FieldValTrim)
'		gui.FormSerialMangement.txtVendorContact.Text(v.DataTable.csrDT(0).ContactVendorName!FieldValTrim)
'		gui.FormSerialMangement.txtVendorPhone.Text(v.DataTable.csrDT(0).ContactVendorPhone!FieldValTrim)
'		gui.FormSerialMangement.txtVendorEmail.Text(v.DataTable.csrDT(0).ContactVendorEmail!FieldValTrim)		
'	f.Intrinsic.Control.EndIf	
'	
'	f.Data.DataTable.Close("csrDT")
'	
'	f.Intrinsic.Control.CallSub(loadSO_WO, sSerialNumber, v.Local.sSerial)
'	
'	
'f.Intrinsic.Control.Catch
'	f.Intrinsic.Control.CallSub(ErrorMsg, CurrentSub, v.Ambient.CurrentSubroutine)
'f.Intrinsic.Control.EndTry
Program.Sub.loadTxt.End

Program.Sub.txtCustomer_KeyPressEnter.Start
v.Local.sCustomer.Declare
v.Local.sSQL.Declare

f.Intrinsic.Control.Try
'	f.Intrinsic.Control.If(v.ODBC.con.State, =, 1)
'		f.ODBC.Connection!con.Close
'	f.Intrinsic.Control.EndIf
	
	'f.Intrinsic.Control.BlockEvents
	gui.FormSerialMangement.pBar1.Value(0)
	gui.FormSerialMangement.lbl1.Caption("0%")
	v.Local.sCustomer.Set(v.Screen.FormSerialMangement!txtCustomer.Text)
	v.Local.sCustomer.Set(v.Local.sCustomer.Trim)
	gui.FormSerialMangement.txtCustomer.Text(v.Local.sCustomer.UCase)
	gui.FormSerialMangement.pBar1.Value(5)
	gui.FormSerialMangement.lbl1.Caption("5%")
	f.ODBC.Connection!con.OpenCompanyConnection
		f.Intrinsic.String.Build("Select right(Reference,7) as Ref, rtrim(Serial_Number) as Serial, Customer, Customer as Name_Customer, '' as Status, Date_History, Date_History as Date_Warranty, Part From V_Item_History Where Code_Transaction = 'O35' and Customer like '%{0}%' ", v.Local.sCustomer.UCase, v.Local.sSQL)
		f.Data.DataTable.CreateFromSQL("tmpServ", "con", v.Local.sSQL,True)
		gui.FormSerialMangement.pBar1.Value(10)
		gui.FormSerialMangement.lbl1.Caption("10%")
		
		f.Intrinsic.Control.If(v.DataTable.tmpServ.RowCount, =, 0)
			f.Data.DataTable.Close("tmpServ")
			f.Intrinsic.String.Build("Select right(Reference,7) as Ref, rtrim(Serial_Number) as Serial, Customer, Customer as Name_Customer, '' as Status, Date_History, Date_History as Date_Warranty, Part From V_Item_History Where Code_Transaction = 'O35' and Customer like '{0}%' ", v.Local.sCustomer.UCase, v.Local.sSQL)
			f.Data.DataTable.CreateFromSQL("tmpServ", "con", v.Local.sSQL,True)
			
			gui.FormSerialMangement.pBar1.Value(15)
			gui.FormSerialMangement.lbl1.Caption("15%")
			
			f.Intrinsic.Control.If(v.DataTable.tmpServ.RowCount, =, 0)
				f.Data.DataTable.Close("tmpServ")
				f.Intrinsic.String.Build("Select right(Reference,7) as Ref, rtrim(Serial_Number) as Serial, Customer, Customer as Name_Customer, '' as Status, Date_History, Date_History as Date_Warranty, Part From V_Item_History Where Code_Transaction = 'O35' and Customer like '%{0}' ", v.Local.sCustomer.UCase, v.Local.sSQL)
				f.Data.DataTable.CreateFromSQL("tmpServ", "con", v.Local.sSQL,True)
			f.Intrinsic.Control.EndIf
		f.Intrinsic.Control.EndIf
		gui.FormSerialMangement.pBar1.Value(20)
		gui.FormSerialMangement.lbl1.Caption("20%")
		
		f.Data.Dictionary.CreateFromSQL("custDict", "con", "Select Customer, Name_Customer from V_customer_Master")
		f.Data.Dictionary.SetDefaultReturn("custDict", "")
		f.Data.DataTable.FillFromDictionary("tmpServ", "custDict", "Name_Customer")
		f.Data.Dictionary.Close("custDict")
	f.ODBC.Connection!con.Close
	
	gui.FormSerialMangement.pBar1.Value(60)
	gui.FormSerialMangement.lbl1.Caption("60%")
	
	f.Data.DataTable.DeleteRow("Serv")
	f.Data.DataTable.AcceptChanges("Serv")
	f.Data.DataTable.Merge("tmpServ", "Serv", false, 4)
	f.Data.DataTable.Close("tmpServ")
	
	gui.FormSerialMangement.pBar1.Value(100)
	gui.FormSerialMangement.lbl1.Caption("100%")
	'f.Intrinsic.Control.UnBlockEvents
f.Intrinsic.Control.Catch
	f.Intrinsic.Control.CallSub(ErrorMsg, CurrentSub, v.Ambient.CurrentSubroutine)
f.Intrinsic.Control.EndTry
Program.Sub.txtCustomer_KeyPressEnter.End

Program.Sub.txtSerial_KeyPressEnter.Start
v.Local.sSerial.Declare
v.Local.sFilter.Declare
v.Local.sSQL.Declare

f.Intrinsic.Control.Try
'	f.Intrinsic.Control.If(v.ODBC.con.State, =, 1)
'		f.ODBC.Connection!con.Close
'	f.Intrinsic.Control.EndIf
	
	'f.Intrinsic.Control.BlockEvents
	gui.FormSerialMangement.pBar1.Value(0)
	gui.FormSerialMangement.lbl1.Caption("0%")
	
	v.Local.sSerial.Set(v.Screen.FormSerialMangement!txtSerial.Text)
	v.Local.sSerial.Set(v.Local.sSerial.Trim)
	gui.FormSerialMangement.txtSerial.Text(v.Local.sSerial.UCase)
	
	gui.FormSerialMangement.pBar1.Value(5)
	gui.FormSerialMangement.lbl1.Caption("5%")
	f.ODBC.Connection!con.OpenCompanyConnection
		f.Intrinsic.String.Build("Select right(Reference,7) as Ref, rtrim(Serial_Number) as Serial, Customer, Customer as Name_Customer, '' as Status, Date_History, Date_History as Date_Warranty, Part From V_Item_History Where Code_Transaction = 'O35' and Serial_Number like '%{0}%' ", v.Local.sSerial.UCase, v.Local.sSQL)
		
		f.Data.DataTable.CreateFromSQL("tmpServ", "con", v.Local.sSQL,True)
		
		gui.FormSerialMangement.pBar1.Value(10)
		gui.FormSerialMangement.lbl1.Caption("10%")
		
		f.Intrinsic.Control.If(v.DataTable.tmpServ.RowCount, =, 0)
			f.Data.DataTable.Close("tmpServ")
			f.Intrinsic.String.Build("Select right(Reference,7) as Ref, rtrim(Serial_Number) as Serial, Customer, Customer as Name_Customer, '' as Status, Date_History, Date_History as Date_Warranty, Part From V_Item_History Where Code_Transaction = 'O35' and Serial_Number like '{0}%' ", v.Local.sSerial.UCase, v.Local.sSQL)
			f.Data.DataTable.CreateFromSQL("tmpServ", "con", v.Local.sSQL,True)
			
			gui.FormSerialMangement.pBar1.Value(15)
			gui.FormSerialMangement.lbl1.Caption("15%")
			
			f.Intrinsic.Control.If(v.DataTable.tmpServ.RowCount, =, 0)
				f.Data.DataTable.Close("tmpServ")
				f.Intrinsic.String.Build("Select right(Reference,7) as Ref, rtrim(Serial_Number) as Serial, Customer, Customer as Name_Customer, '' as Status, Date_History, Date_History as Date_Warranty, Part From V_Item_History Where Code_Transaction = 'O35' and Serial_Number like '%{0}' ", v.Local.sSerial.UCase, v.Local.sSQL)
				f.Data.DataTable.CreateFromSQL("tmpServ", "con", v.Local.sSQL,True)
			f.Intrinsic.Control.EndIf
		f.Intrinsic.Control.EndIf
		
		gui.FormSerialMangement.pBar1.Value(20)
		gui.FormSerialMangement.lbl1.Caption("20%")
		
		f.Data.DataTable.SetValueFormat("tmpServ", -1, "Name_Customer", "Name_Customer", ">>>>>>")
		
		f.Data.Dictionary.CreateFromSQL("custDict", "con", "Select Customer, Name_Customer from V_customer_Master")
		f.Data.Dictionary.SetDefaultReturn("custDict", "")
		f.Data.DataTable.FillFromDictionary("tmpServ", "custDict", "Name_Customer", "Name_Customer")
		f.Data.Dictionary.Close("custDict")
		gui.FormSerialMangement.pBar1.Value(60)
		gui.FormSerialMangement.lbl1.Caption("60%")
	f.ODBC.Connection!con.Close
	
	f.Data.DataTable.DeleteRow("Serv")
	f.Data.DataTable.AcceptChanges("Serv")
	f.Data.DataTable.Merge("tmpServ", "Serv", false, 4)
	f.Data.DataTable.Close("tmpServ")
	
	gui.FormSerialMangement.pBar1.Value(100)
	gui.FormSerialMangement.lbl1.Caption("100%")
	'f.Intrinsic.Control.UnBlockEvents
f.Intrinsic.Control.Catch
	f.Intrinsic.Control.CallSub(ErrorMsg, CurrentSub, v.Ambient.CurrentSubroutine)
f.Intrinsic.Control.EndTry
Program.Sub.txtSerial_KeyPressEnter.End

Program.Sub.cmdRefresh_Click.Start
v.Local.sSQL.Declare
v.Local.sSerial.Declare
V.Local.i.Declare
v.Local.iMonth.Declare
v.Local.dDate.Declare
v.Local.sStatus.Declare

v.Local.sCust.Declare
v.Local.sStart.Declare
v.Local.sEnd.Declare
f.Intrinsic.Control.Try
	gui.FormSerialMangement.pBar1.Value(0)
	gui.FormSerialMangement.lbl1.Caption("0%")
	v.Local.sSerial.Set(v.Screen.FormSerialMangement!txtSerial.Text)
	v.Local.sCust.Set(v.Screen.FormSerialMangement!txtCustomer.Text)
		
	f.Intrinsic.Control.If(v.Local.sCust.Trim, =, "")
		f.Intrinsic.UI.Msgbox("Please select a Customer.")
		f.Intrinsic.Control.ExitSub
	f.Intrinsic.Control.EndIf
			
	v.Local.sStart.Set(v.Screen.FormSerialMangement!dtp1.Text)
	v.Local.sEnd.Set(v.Screen.FormSerialMangement!dtp2.Text)
	
	f.ODBC.Connection!con.OpenCompanyConnection
		gui.FormSerialMangement.pBar1.Value(10)
		gui.FormSerialMangement.lbl1.Caption("10%")
		
		'f.Intrinsic.String.Build("Select right(Reference,7) as Ref, rtrim(Serial_Number) as Serial, Customer, '' as Status, Date_History, Date_History as Date_Warranty, Part From V_Item_History Where Code_Transaction = 'O35' and Serial_Number like '%{0}%' ", v.Local.sSerial.Trim, v.Local.sSQL)
		'f.Intrinsic.String.Build("Select right(Reference,7) as Ref, rtrim(Serial_Number) as Serial, Customer, '' as Status, Date_History, Date_History as Date_Warranty, Part From V_Item_History Where Code_Transaction = 'O35' ", v.Local.sSQL)
		'f.Intrinsic.String.Build("Select right(Reference,7) as Ref, rtrim(Serial_Number) as Serial, rtrim(Customer) as Customer, rtrim(Customer) as Name_Customer,  rtrim(Customer) as Warranty_Code,'' as Status, Date_History, Date_History as Date_Warranty, Part From V_Item_History Where Code_Transaction = 'O35' and Serial_Number <> ''", V.Local.sSql)
		'v.Local.sSql.Set("Select right(Reference,7) as Ref, rtrim(Serial_Number) as Serial, rtrim(Customer) as Customer, rtrim(Customer) as Name_Customer,  rtrim(Customer) as Warranty_Code,'' as Status, Date_History, Date_History as Date_Warranty, Part From V_Item_History Where Code_Transaction = 'O35' and Serial_Number <> ''")

		'f.Intrinsic.String.Build("Select right(Reference,7) as Ref, rtrim(Serial_Number) as Serial, rtrim(Customer) as Customer, rtrim(Customer) as Name_Customer,  rtrim(Customer) as Warranty_Code,'' as Status, Date_History, Date_History as Date_Warranty, Part From V_Item_History Where Code_Transaction = 'O35' and Serial_Number <> '' and Customer = '{0}' and date_history >= '{1}' and date_history <= '{2}'", v.Local.sCust, v.Local.sStart.PervasiveDate, v.Local.sEnd.PervasiveDate, v.Local.sSQL)
		'*******************************NEW CHANGES
		f.Intrinsic.String.Build("Select Order_no as Ref, rTrim(Serial) as Serial, rtrim(Customer) as Customer, rtrim(Customer) as Name_Customer, rtrim(Customer) as Warranty_Code,'' as Status, min(Date_purchased) as Date_History, min(Date_purchased) as Date_Warranty, Part from V_WARRANTY where Serial <> '' and Customer = '{0}' and Date_purchased >= '{1}' and Date_purchased <= '{2}' group by serial, Part, order_no, Customer", v.Local.sCust, v.Local.sStart.PervasiveDate, v.Local.sEnd.PervasiveDate, v.Local.sSQL)
		
		f.Data.DataTable.CreateFromSQL("tmpServ", "con", v.Local.sSQL,True)
		f.Data.Datatable.AddColumn("tmpServ", "Description", "String")
		
		f.Data.Dictionary.CreateFromSQL("descDict", "con", "Select Part, Description from V_Inventory_MSTR")
		f.Data.Datatable.FillFromDictionary("tmpServ", "descDict", "Part", "Description")
		f.Data.Dictionary.Close("descDict")
		
		'f.Data.Datatable.AddColumn("tmpServ", "Warranty_Type", "String")
		f.Data.Dictionary.CreateFromSQL("descDict", "con", "Select Part, Warranty_Type from V_Inventory_all")
		f.Data.Datatable.FillFromDictionary("tmpServ", "descDict", "Part", "Warranty_Code")
		f.Data.Dictionary.Close("descDict")
		
		gui.FormSerialMangement.pBar1.Value(20)
		gui.FormSerialMangement.lbl1.Caption("20%")
'		f.Intrinsic.Control.If(v.DataTable.tmpServ.RowCount, =, 0)
'			f.Data.DataTable.Close("tmpServ")
'			f.Intrinsic.String.Build("Select right(Reference,7) as Ref, rtrim(Serial_Number) as Serial, Customer, '' as Status, Date_History, Date_History as Date_Warranty, Part From V_Item_History Where Code_Transaction = 'O35' and Serial_Number like '{0}%' ", v.Local.sSerial.Trim, v.Local.sSQL)
'			f.Data.DataTable.CreateFromSQL("tmpServ", "con", v.Local.sSQL,True)
'			gui.FormSerialMangement.pBar1.Value(30)
'			gui.FormSerialMangement.lbl1.Caption("30%")
'			f.Intrinsic.Control.If(v.DataTable.tmpServ.RowCount, =, 0)
'				f.Data.DataTable.Close("tmpServ")
'				f.Intrinsic.String.Build("Select right(Reference,7) as Ref, rtrim(Serial_Number) as Serial, Customer, '' as Status, Date_History, Date_History as Date_Warranty, Part From V_Item_History Where Code_Transaction = 'O35' and Serial_Number like '%{0}' ", v.Local.sSerial.Trim, v.Local.sSQL)
'				f.Data.DataTable.CreateFromSQL("tmpServ", "con", v.Local.sSQL,True)
'			f.Intrinsic.Control.EndIf
'		f.Intrinsic.Control.EndIf
	
	gui.FormSerialMangement.pBar1.Value(60)
	gui.FormSerialMangement.lbl1.Caption("60%")
	
	f.Data.DataTable.CreateFromSQL("shipDT", "con", "Select Order_No, Date_shipped from V_SHIPMENT_HEADER")
		f.Data.DataTable.CreateFromSQL("histDT", "con", "Select Order_No, Date_shipped from V_ORDER_HIST_HEAD")
		f.Data.DataTable.Merge("histDT", "shipDT", false, 2)
		f.Data.Dictionary.CreateFromDataTable("shipDict", "shipDT", "Order_No", "Date_shipped")
		f.Data.Dictionary.SetDefaultReturn("shipDict", 1/1/1900)
		f.Data.DataTable.FillFromDictionary("tmpServ", "shipDict", "Ref", "Date_History")
		f.Data.Dictionary.Close("shipDict")
		f.Data.DataTable.Close("histDT")
		f.Data.DataTable.Close("shipDT")
		
'		f.Data.Dictionary.CreateFromSQL("warrantyDict", "con", "select Customer, C_Sort_1 from CUSTOMER_SALES where customer = '{0}' and rec = '2'")
'		f.Data.Dictionary.SetDefaultReturn("warrantyDict", "")
'		f.Data.DataTable.SetValueFormat("tmpServ", -1, "Warranty_Code", "Warranty_Code", ">")
'		f.Data.DataTable.FillFromDictionary("tmpServ", "warrantyDict", "Warranty_Code", "Warranty_Code")
'		f.Data.Dictionary.Close("warrantyDict")
	
	
		F.Intrinsic.Control.For(V.Local.i, 0, v.DataTable.tmpServ.RowCount--, 1)			
			v.Local.iMonth.Set(0)
			f.Intrinsic.String.Build("select Terms from GCG_5530_Warranty where Warranty_Code = '{0}'", v.DataTable.tmpServ(V.Local.i).Warranty_Code!FieldValTrim, v.Local.sSql)
			f.ODBC.Connection!con.ExecuteAndReturn(v.Local.sSql, v.Local.iMonth)		
			
			F.Intrinsic.Date.DateAdd("M",V.Local.iMonth,V.DataTable.tmpServ(V.Local.i).Date_History!FieldVal,V.Local.dDate)
			
			F.Intrinsic.Control.If(V.Local.dDate,>,V.Ambient.Date)
				V.Local.sStatus.Set("Open")
			F.Intrinsic.Control.Else
				V.Local.sStatus.Set("Closed")
			F.Intrinsic.Control.EndIf
			F.Data.DataTable.SetValue("tmpServ",V.Local.i,"Date_Warranty",V.Local.dDate,"Status",V.Local.sStatus)
		F.Intrinsic.Control.Next(V.Local.i)
	
	'F.Data.DataTable.RemoveColumn("tmpServ","Part")
	
		f.Data.Dictionary.CreateFromSQL("custDict", "con", "Select Customer, Name_Customer from V_customer_Master")
		f.Data.Dictionary.SetDefaultReturn("custDict", "")
		f.Data.DataTable.FillFromDictionary("tmpServ", "custDict", "Name_Customer", "Name_Customer")
		f.Data.Dictionary.Close("custDict")
	
	
	f.ODBC.Connection!con.Close
	
	
	
	f.Data.DataTable.DeleteRow("Serv")
	f.Data.DataTable.AcceptChanges("Serv")
	f.Data.DataTable.Merge("tmpServ","Serv",False,4)
	f.Data.DataTable.Close("tmpServ")
	f.Data.DataTable.AcceptChanges("Serv")
	f.Data.DataView.SetFilter("Serv", "ServDV", "")
	
	gui.FormSerialMangement.pBar1.Value(70)
	gui.FormSerialMangement.lbl1.Caption("70%")
	
	gui.FormSerialMangement.txtSerial.Text("")
	gui.FormSerialMangement.txtCustomer.Text("")
	gui.FormSerialMangement.pBar1.Value(100)
	gui.FormSerialMangement.lbl1.Caption("100%")
f.Intrinsic.Control.Catch
	f.Intrinsic.Control.CallSub(ErrorMsg, CurrentSub, v.Ambient.CurrentSubroutine)
f.Intrinsic.Control.EndTry
Program.Sub.cmdRefresh_Click.End

Program.Sub.loadsingle.Start
v.Local.sSerial.Declare
v.Local.sSO.Declare
v.Local.sSQL.Declare
v.Local.iCnt.Declare
v.Local.sCharCheck.Declare
v.Local.iLength.Declare
v.Local.sDateRet.Declare
v.Local.sJob.Declare

	V.Local.dDate.Declare(Date,V.Ambient.Date)
	V.Local.iMonth.Declare(Long,0)
	V.Local.sStatus.Declare(String,"")
f.Intrinsic.Control.Try

	f.Intrinsic.Control.CallSub(cleanTxt)
	
	v.Local.sSerial.Set(v.Screen.FormSerialMangement!txtSerial.Text)
	f.Intrinsic.String.UCase(v.Local.sSerial, v.Local.sSerial)
	
'	f.Intrinsic.Control.If(v.ODBC.con.State, =, 1)
'		f.ODBC.Connection!con.Close
'	f.Intrinsic.Control.EndIf

	
	f.ODBC.Connection!con.OpenCompanyConnection
		f.Intrinsic.String.Build("Select distinct right(Reference,7) as Ref, rtrim(Serial_Number) as Serial, rtrim(Customer) as Customer, rtrim(Customer) as Name_Customer,  rtrim(Customer) as Warranty_Code,'' as Status, Date_History, Date_History as Date_Warranty, Part From V_Item_History Where Code_Transaction = 'O35' and Serial_Number like '{0}'", v.Local.sSerial, v.Local.sSQL)
		f.Data.DataTable.CreateFromSQL("tmpServ","con",V.Local.sSql,True)
		'f.Data.Dictionary.CreateFromSQL("warrantyDict", "con", "select Customer, C_Sort_1 from CUSTOMER_SALES where customer = '{0}' and rec = '2'")
		f.Data.Dictionary.CreateFromSQL("warrantyDict", "con", "select Customer, C_Sort_1 from CUSTOMER_SALES where rec = '2'")
		f.Data.Dictionary.CreateFromSQL("servDict", "con", "Select rtrim(Customer) as Customer, Name_Customer from V_Customer_Master")
		f.Data.Dictionary.CreateFromSQL("descriptionDict", "con", "Select Part, Description from V_Inventory_MSTR")
	f.ODBC.Connection!con.Close
	
	'Changes 1/17/2020 adding part and description
	f.Data.DataTable.AddColumn("tmpServ", "Description", "String")
	f.Data.Dictionary.SetDefaultReturn("descriptionDict", "")
	f.Data.DataTable.FillFromDictionary("tmpServ", "descriptionDict", "Part", "Description")
	f.Data.Dictionary.Close("descriptionDict")

	f.Data.Dictionary.SetDefaultReturn("warrantyDict", "")
	f.Data.DataTable.SetValueFormat("tmpServ", -1, "Warranty_Code", "Warranty_Code", ">")
	f.Data.DataTable.FillFromDictionary("tmpServ", "warrantyDict", "Warranty_Code", "Warranty_Code")
	
	f.Data.DataTable.SetValueFormat("tmpServ", -1, "Name_Customer", "Name_Customer", ">")		
	f.Data.Dictionary.SetDefaultReturn("servDict", "")
	f.Data.DataTable.FillFromDictionary("tmpServ", "servDict", "Customer", "Name_Customer")
		
	
	f.Intrinsic.Control.If(v.DataTable.tmpServ.RowCount, <, 1)
		f.Intrinsic.UI.Msgbox("No records found.")
	f.Intrinsic.Control.EndIf
	
	f.Intrinsic.Control.For(v.Local.iCnt, 0, v.DataTable.tmpServ.RowCount--, 1)
		v.Local.sSerial.Set(v.DataTable.tmpServ(v.Local.iCnt).Serial!FieldValTrim)
		f.Intrinsic.String.Left(v.Local.sSerial, 2, v.Local.sCharCheck)
		
		f.Intrinsic.Control.If(v.Local.sCharCheck, =, "HC")
			v.Local.sSO.Set(v.DataTable.tmpServ(v.Local.iCnt).Ref!FieldValtrim)
		f.Intrinsic.Control.Else
			f.Intrinsic.Math.Sub(v.Local.sSerial.Length, 2, v.Local.iLength)
			f.Intrinsic.String.Right(v.Local.sSerial, v.Local.iLength, v.Local.sSO)
			f.Intrinsic.String.LPad(v.Local.sSO, "0", 6, v.Local.sJob)
		f.Intrinsic.Control.EndIf
		

		
	
		f.ODBC.Connection!con.OpenCompanyConnection
		 	f.Intrinsic.String.Build("Select  Date_shipped from V_SHIPMENT_HEADER where Order_No = '{0}'", v.Local.sSO, v.Local.sSQL)
		 	f.ODBC.Connection!con.ExecuteAndReturn(v.Local.sSQL, v.Local.sDateRet)
		 	
		 	f.Intrinsic.Control.If(v.Local.sDateRet.Trim, =, "")
		 		f.Intrinsic.String.Build("Select Date_shipped from V_ORDER_HIST_HEAD where Order_No = '{0}'", v.Local.sSO, v.Local.sSQL)
		 		f.ODBC.Connection!con.ExecuteAndReturn(v.Local.sSQL, v.Local.sDateRet)
		 	f.Intrinsic.Control.EndIf
		 	
		 	f.Intrinsic.Control.If(v.Local.sDateRet.Trim, =, "")
		 		f.Intrinsic.String.Build("Select Date_Closed from V_JOB_HIST_MAST where Job = '{0}' and Suffix = '000'", v.Local.sJob, v.Local.sSQL)
		 		f.ODBC.Connection!con.ExecuteAndReturn(v.Local.sSQL, v.Local.sDateRet)
		 	f.Intrinsic.Control.EndIf
		 	
		 	f.Intrinsic.Control.If(v.Local.sDateRet.Trim, =, "")
		 		v.Local.sDateRet.Set("1/1/1900")
		 	f.Intrinsic.Control.EndIf
		f.ODBC.Connection!con.Close
		f.Data.DataTable.SetValue("tmpServ", v.Local.iCnt, "Date_History", v.Local.sDateRet)
		
		
		v.Local.iMonth.Set(0)
		f.Intrinsic.String.Build("select Terms from GCG_5530_Warranty where Warranty_Code = '{0}'", v.DataTable.tmpServ(V.Local.iCnt).Warranty_Code!FieldValTrim, v.Local.sSql)
		f.ODBC.Connection!con.OpenCompanyConnection
			 f.ODBC.Connection!con.ExecuteAndReturn(v.Local.sSql, v.Local.iMonth)		
		f.ODBC.Connection!con.Close		
		
		F.Intrinsic.Date.DateAdd("M",V.Local.iMonth,V.DataTable.tmpServ(V.Local.iCnt).Date_History!FieldVal,V.Local.dDate)
		
		F.Intrinsic.Control.If(V.Local.dDate,>,V.Ambient.Date)
			V.Local.sStatus.Set("Open")
		F.Intrinsic.Control.Else
			V.Local.sStatus.Set("Closed")
		F.Intrinsic.Control.EndIf
		F.Data.DataTable.SetValue("tmpServ",V.Local.iCnt,"Date_Warranty",V.Local.dDate,"Status",V.Local.sStatus)
	f.Intrinsic.Control.Next(v.Local.iCnt)
	
	f.Data.Dictionary.Close("warrantyDict")
	f.Data.Dictionary.Close("servDict")
	
	f.Data.DataTable.DeleteRow("Serv")
	f.Data.DataTable.AcceptChanges("Serv")
	f.Data.DataTable.Merge("tmpServ", "Serv", false, 2)
	f.Data.DataTable.Close("tmpServ")
f.Intrinsic.Control.Catch
	f.Intrinsic.Control.CallSub(ErrorMsg, CurrentSub, v.Ambient.CurrentSubroutine)
f.Intrinsic.Control.EndTry
Program.Sub.loadsingle.End

Program.Sub.Serialize.Start
v.Local.sSerialize.Declare
f.Intrinsic.Control.Try

f.Intrinsic.Control.If(v.DataTable.uploadDT.Exists, =, False)
	f.Intrinsic.Control.ExitSub
f.Intrinsic.Control.EndIf

gui.FormSerialMangement.GsGridControlSERV.Serialize("GServ", v.Local.sSerialize)
f.Global.Registry.AddValue(v.Caller.User, v.Caller.CompanyCode, "GServ", 5530, 1000, False, "Serialize", False, 0, -999.0, 1/1/1980, 12:00:00 AM, v.Local.sSerialize)
	
f.Intrinsic.Control.Catch
	f.Intrinsic.Control.CallSub(ErrorMsg, CurrentSub, v.Ambient.CurrentSubroutine)
f.Intrinsic.Control.EndTry
Program.Sub.Serialize.End

Program.Sub.Deserialize.Start
v.Local.sSerialize.Declare
f.Intrinsic.Control.Try
	f.Global.Registry.ReadValue(v.Caller.User, v.Caller.CompanyCode, "GServ", 5530, 0, 5, "", v.Local.sSerialize)
	f.Intrinsic.Control.If(v.Local.sSerialize, <>, "")
		f.ODBC.Connection!common.OpenCommonConnection
			f.ODBC.Connection!common.Execute("delete from GS_REGISTRY where REG_ID = '5530'")
		f.ODBC.Connection!common.Close
	f.Intrinsic.Control.EndIf
	
	f.Global.Registry.ReadValue(v.Caller.User, v.Caller.CompanyCode, "GServ", "5530", 1000, 6, "", v.Local.sSerialize)
	f.Intrinsic.Control.If(v.Local.sSerialize.Trim, <>, "")
		gui.FormSerialMangement.GsGridControlSERV.Deserialize(v.Local.sSerialize)
	f.Intrinsic.Control.EndIf
f.Intrinsic.Control.Catch
	f.Intrinsic.Control.CallSub(ErrorMsg, CurrentSub, v.Ambient.CurrentSubroutine)
f.Intrinsic.Control.EndTry
Program.Sub.Deserialize.End

Program.Sub.cmdSNbrw_Click.Start
v.Local.sRet.Declare
f.Intrinsic.Control.Try
	f.ODBC.Connection!con.OpenCompanyConnection
		'f.Intrinsic.UI.Browser("Serial Number", "con", "Select right(Reference,7) as Ref, rtrim(Serial_Number) as Serial, Customer, Date_History as Date_Warranty, Part From V_Item_History Where Code_Transaction = 'O35' and Serial_Number <> ''", "Ref*!*Serial Number*!*Customer*!*Date Warranty*!*Part", "60*!*100*!*60*!*60*!*80", v.Local.sRet)
		
		'f.Intrinsic.UI.Browser("Serial Number", "con", "Select distinct right(a.Reference,7) as Ref, rtrim(a.Serial_Number) as Serial, a.Customer, a.Date_History as Date_Warranty, a.Part, B.Description From V_Item_History a left join V_Inventory_all b on a.part = b.part Where Code_Transaction = 'O35' and Serial_Number <> ''", "Ref*!*Serial Number*!*Customer*!*Date Warranty*!*Part*!*Description", "60*!*100*!*60*!*60*!*80*!*140", v.Local.sRet)
		
		f.Intrinsic.UI.Browser("Serial Number", "con", "Select Order_no as Ref, rTrim(Serial) as Serial, if(Customer = '', Purch_From_Id, Customer) as Customer, min(Date_purchased) as Date_Warranty, Part from V_WARRANTY group by serial, Part, order_no, Customer, Purch_From_Id","Ref*!*Serial Number*!*Customer*!*Date Warranty*!*Part", "60*!*100*!*60*!*60*!*80", v.Local.sRet)
		'group by serial, Part, order_no, Customer
	f.ODBC.Connection!con.Close
	f.Intrinsic.Control.If(v.Local.sRet.Trim, <>, "***CANCEL***")
		f.Intrinsic.String.Split(v.Local.sRet, "*!*", v.Local.sRet)
		gui.FormSerialMangement.txtSerial.Text(v.Local.sRet(1))
		gui.FormSerialMangement.txtCustomer.Text(v.Local.sRet(2))
		gui.FormSerialMangement.txtSO.Text(v.Local.sRet(0))
		f.Intrinsic.Control.CallSub("txtSerial_KeyPress")
	f.Intrinsic.Control.EndIf
f.Intrinsic.Control.Catch
	f.Intrinsic.Control.CallSub(ErrorMsg, CurrentSub, v.Ambient.CurrentSubroutine)
f.Intrinsic.Control.EndTry
Program.Sub.cmdSNbrw_Click.End

Program.Sub.cmdCust_Click.Start
v.Local.sRet.Declare
f.Intrinsic.Control.Try
	f.Intrinsic.UI.Browser(205, , v.Local.sRet)
	f.Intrinsic.Control.If(v.Local.sRet.Trim, <>, "***CANCEL***")
		f.Intrinsic.String.Split(v.Local.sRet, "*!*", v.Local.sRet)
		gui.FormSerialMangement.txtCustomer.Text(v.Local.sRet(0))
	f.Intrinsic.Control.EndIf
f.Intrinsic.Control.Catch
	f.Intrinsic.Control.CallSub(ErrorMsg, CurrentSub, v.Ambient.CurrentSubroutine)
f.Intrinsic.Control.EndTry
Program.Sub.cmdCust_Click.End

Program.Sub.cmdReg_Click.Start
gui.F_Registration..Visible(True)
Program.Sub.cmdReg_Click.End

Program.Sub.cmdRegScreen_Click.Start
	f.Global.General.CallWrapperSync(50, "QL1000")
Program.Sub.cmdRegScreen_Click.End

Program.Sub.cmdRegEmail_Click.Start
v.Local.bOutlook.Declare
v.Local.sFolder.Declare
v.Local.sFiles.Declare
v.Local.sRet.Declare

v.Local.sBody.Declare
v.Local.sTemp.Declare
f.Intrinsic.Control.Try
'Try something
	f.Automation.MSOutlook.CheckPresence(v.Local.bOutlook)
	f.Intrinsic.Control.If(v.Local.bOutlook.Not)
		f.Intrinsic.UI.Msgbox("MS Outlook not found.")
		f.Intrinsic.Control.ExitSub
	f.Intrinsic.Control.EndIf
	v.Local.sFolder.Set(v.Screen.F_Registration!txtFromFolder.Text)
	f.Automation.MSOutlook.GetEmailListing(v.Local.sFolder.Trim, v.Local.sFiles)
	f.Intrinsic.UI.BrowserFromString("Email Selection", v.Local.sFiles, "*!*", "*%*", "ID*!*Subject*!*Date*!*Sender*!*User", "200*!*300*!*120*!*120*!*120", v.Local.sRet)
	f.Intrinsic.Control.If(v.Local.sRet.Trim, =, "***CANCEL***")
		v.Global.bEmail.Set(False)
		f.Intrinsic.Control.ExitSub
	f.Intrinsic.Control.EndIf
	f.Intrinsic.String.Split(v.Local.sRet, "*!*", v.Local.sRet)
	f.Automation.MSOutlook.GetEmailBody(v.Local.sFolder.Trim, v.Local.sRet(0), v.Local.sBody)
	v.Global.sEmailID.Set(v.Local.sRet(0))
	'Clean DT
	f.Data.Datatable.DeleteRow("regDT")
	f.Data.Datatable.AcceptChanges("regDT")
	'Parse Body
	'First Name
	f.Intrinsic.String.Split(v.Local.sBody, "First Name", v.Local.sBody)
	f.Intrinsic.String.Split(v.Local.sBody(1), "Last Name", v.Local.sBody)
	v.Local.sTemp.Set(v.Local.sBody(0))
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, "	", "", v.Local.sTemp)
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, v.Ambient.NewLine, "", v.Local.sTemp)
	f.Data.Datatable.AddRow("regDT", "Title", "First Name:", "Value", v.Local.sTemp.Trim)
	'Last Name
	f.Intrinsic.String.Split(v.Local.sBody(1), "Phone Number", v.Local.sBody)
	v.Local.sTemp.Set(v.Local.sBody(0))
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, "	", "", v.Local.sTemp)
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, v.Ambient.NewLine, "", v.Local.sTemp)
	f.Data.Datatable.AddRow("regDT", "Title", "Last Name:", "Value", v.Local.sTemp.Trim)
	'Phone Number
	f.Intrinsic.String.Split(v.Local.sBody(1), "Email", v.Local.sBody)
	v.Local.sTemp.Set(v.Local.sBody(0))
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, "	", "", v.Local.sTemp)
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, v.Ambient.NewLine, "", v.Local.sTemp)
	f.Data.Datatable.AddRow("regDT", "Title", "Phone Number:", "Value", v.Local.sTemp.Trim)
	'Email
	f.Intrinsic.String.Split(v.Local.sBody(1), "Street", v.Local.sBody)
	v.Local.sTemp.Set(v.Local.sBody(0))
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, "	", "", v.Local.sTemp)
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, v.Ambient.NewLine, "", v.Local.sTemp)
	f.Data.Datatable.AddRow("regDT", "Title", "Email:", "Value", v.Local.sTemp.Trim)
	'Street
	f.Intrinsic.String.Split(v.Local.sBody(1), "City", v.Local.sBody)
	v.Local.sTemp.Set(v.Local.sBody(0))
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, "	", "", v.Local.sTemp)
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, v.Ambient.NewLine, "", v.Local.sTemp)
	f.Data.Datatable.AddRow("regDT", "Title", "Street:", "Value", v.Local.sTemp.Trim)
	'City
	f.Intrinsic.String.Split(v.Local.sBody(1), "State", v.Local.sBody)
	v.Local.sTemp.Set(v.Local.sBody(0))
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, "	", "", v.Local.sTemp)
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, v.Ambient.NewLine, "", v.Local.sTemp)
	f.Data.Datatable.AddRow("regDT", "Title", "City:", "Value", v.Local.sTemp.Trim)
	'State
	f.Intrinsic.String.Split(v.Local.sBody(1), "Postal Code", v.Local.sBody)
	v.Local.sTemp.Set(v.Local.sBody(0))
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, "	", "", v.Local.sTemp)
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, v.Ambient.NewLine, "", v.Local.sTemp)
	f.Data.Datatable.AddRow("regDT", "Title", "State:", "Value", v.Local.sTemp.Trim)
	'Postal Code
	f.Intrinsic.String.Split(v.Local.sBody(1), "Country", v.Local.sBody)
	v.Local.sTemp.Set(v.Local.sBody(0))
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, "	", "", v.Local.sTemp)
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, v.Ambient.NewLine, "", v.Local.sTemp)
	f.Data.Datatable.AddRow("regDT", "Title", "Postal Code:", "Value", v.Local.sTemp.Trim)
	'Country
	f.Intrinsic.String.Split(v.Local.sBody(1), "Model Name", v.Local.sBody)
	v.Local.sTemp.Set(v.Local.sBody(0))
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, "	", "", v.Local.sTemp)
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, v.Ambient.NewLine, "", v.Local.sTemp)
	f.Data.Datatable.AddRow("regDT", "Title", "Country:", "Value", v.Local.sTemp.Trim)
	'Model Name
	f.Intrinsic.String.Split(v.Local.sBody(1), "Serial Number", v.Local.sBody)
	v.Local.sTemp.Set(v.Local.sBody(0))
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, "	", "", v.Local.sTemp)
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, v.Ambient.NewLine, "", v.Local.sTemp)
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, v.Ambient.NewLine, "", v.Local.sTemp)
	f.Data.Datatable.AddRow("regDT", "Title", "Model Name:", "Value", v.Local.sTemp.Trim)
	'Serial Number
	f.Intrinsic.String.Split(v.Local.sBody(1), "Installation Date", v.Local.sBody)
	v.Local.sTemp.Set(v.Local.sBody(0))
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, "	", "", v.Local.sTemp)
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, v.Ambient.NewLine, "", v.Local.sTemp)
	f.Data.Datatable.AddRow("regDT", "Title", "Serial Number:", "Value", v.Local.sTemp.Trim)
	'Installation Date
	f.Intrinsic.String.Split(v.Local.sBody(1), "Choose Shell Color", v.Local.sBody)
	v.Local.sTemp.Set(v.Local.sBody(0))
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, "	", "", v.Local.sTemp)
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, v.Ambient.NewLine, "", v.Local.sTemp)
	f.Data.Datatable.AddRow("regDT", "Title", "Installation Date:", "Value", v.Local.sTemp.Trim)
	'
	v.Global.bEmail.Set(True)
f.Intrinsic.Control.Catch
	f.Intrinsic.Control.CallSub(ErrorMsg, CurrentSub, v.Ambient.CurrentSubroutine)
f.Intrinsic.Control.EndTry
Program.Sub.cmdRegEmail_Click.End

Program.Sub.cmdRegSave_Click.Start
v.Local.sTDate.Declare
v.Local.sTTime.Declare
v.Local.sEndUser.Declare
v.Local.sTmp.Declare
v.Local.sSQL.Declare
v.Local.dInst.Declare
v.Local.sSInst.Declare
v.Local.sFromFolder.Declare
v.Local.sToFolder.Declare
v.Local.dExp.Declare
v.Local.sSExp.Declare
v.Local.sRet.Declare
v.Local.sInv.Declare

f.Intrinsic.Control.Try
	
	f.Intrinsic.Control.If(v.DataTable.regDT.RowCount, =, 0)
		f.Intrinsic.Control.ExitSub
	f.Intrinsic.Control.EndIf
	f.ODBC.Connection!con.OpenCompanyConnection
		f.Data.Datatable.CreateFromSQL("warrantyDT", "con", "Select * from Warranty where Serial = '-1'")
		f.Data.Datatable.DeleteRow("warrantyDT")
		f.Data.Datatable.AcceptChanges("warrantyDT")
		
		'Get Dates
		f.Intrinsic.String.Format(v.Ambient.Date, "yymmdd", v.Local.sTDate)
		f.Intrinsic.String.Format(v.Ambient.Time, "hhnnssss", v.Local.sTTime)
		
		v.Local.sTmp.Set(v.DataTable.regDT(11).Value!FieldValTrim)
		f.Intrinsic.Control.If(v.Local.sTmp.IsDate)
		f.Intrinsic.Control.Else
			f.Intrinsic.UI.Msgbox("Installation Date in incorrect format please change it to mm/dd/yyyy format")
			f.ODBC.Connection!con.Close
			f.Intrinsic.Control.ExitSub
		f.Intrinsic.Control.EndIf
		
		f.Intrinsic.Date.ConvertDString(v.DataTable.regDT(11).Value!FieldValTrim, "mm/dd/yyyy", v.Local.dInst)
		f.Intrinsic.String.Format(v.Local.dInst, "yyyymmdd", v.Local.sSInst)
		
		f.Intrinsic.Date.DateAdd("YYYY", 3, v.Local.dInst, v.Local.dExp)
		f.Intrinsic.String.Format(v.Local.dExp, "yyyymmdd", v.Local.sSExp)
		
		'End User
		v.Local.sTmp.Set(v.DataTable.regDT(1).Value!FieldValTrim)
		f.Intrinsic.String.Replace(v.Local.sTmp, " ", "", v.Local.sTmp)
		
		v.Local.sEndUser.Set(v.DataTable.regDT(0).Value!FieldValTrim)
		f.Intrinsic.String.Replace(v.Local.sEndUser, " ", "", v.Local.sEndUser)
		
		f.Intrinsic.String.Build("{1} {0}", v.Local.sTmp.Trim, v.Local.sEndUser.Trim, v.Local.sEndUser)
		
		'Part
		f.Intrinsic.String.Build("Select * from V_ITEM_HISTORY where Serial_Number = '{0}' and code_transaction = 'O35'", v.DataTable.regDT(10).Value!FieldValTrim, v.Local.sSQL)
		f.Data.Datatable.CreateFromSQL("itemDT", "con", v.Local.sSQL)
		
		f.Intrinsic.Control.If(v.DataTable.itemDT.RowCount, =, 0)
			f.Data.Datatable.Close("itemDT")
			f.Intrinsic.String.Build("Select Part, Location, Order_no, Order_Suffix, Order_line, if(Customer = '', Purch_From_Id, Customer) as Customer, Invoice from Warranty where Serial = '{0}'", v.DataTable.regDT(10).Value!FieldValTrim, v.Local.sSQL)
			f.Data.Datatable.CreateFromSQL("itemDT", "con", v.Local.sSQL)
			
			'f.Intrinsic.String.Build("Select Invoice from ")
		f.Intrinsic.Control.EndIf
		
		f.Intrinsic.Control.If(v.DataTable.itemDT.RowCount, =, 0)
			f.Intrinsic.UI.Msgbox("Serial not found in Order History Table or Warranty Table. Please Select a Serial number or cancel.")
			'Browse
			f.Intrinsic.String.Build("Select Serial, Part, if(Customer = '', Purch_From_Id, Customer) as Customer, Invoice from Warranty where Serial like '%{0}%'", v.DataTable.regDT(10).Value!FieldValTrim, v.Local.sSQL)
			f.Intrinsic.UI.Browser("Serial Number", "con", v.Local.sSQL, "Serial*!*Part*!*Customer*!*Invoice", "70*!*120*!*70*!*80", v.Local.sRet)
			
			f.Intrinsic.Control.If(v.Local.sRet, =, "***CANCEL***")
				f.ODBC.Connection!con.Close
				f.Data.Datatable.Close("itemDT")
				f.Data.Datatable.Close("warrantyDT")
				f.Intrinsic.Control.ExitSub
			f.Intrinsic.Control.EndIf
			
			f.Intrinsic.String.Split(v.Local.sRet, "*!*", v.Local.sRet)
			f.Intrinsic.String.Build("Select Part, Location, Order_no, Order_Suffix, Order_line, if(Customer = '', Purch_From_Id, Customer) as Customer, Invoice from Warranty where Serial = '{0}'", v.Local.sRet(0), v.Local.sSQL)
			f.Data.Datatable.Close("itemDT")
			f.Data.Datatable.CreateFromSQL("itemDT", "con", v.Local.sSQL)
			f.Data.Datatable.SetValue("regDT", 10, "Value", v.Local.sRet(0))
		f.Intrinsic.Control.EndIf
		
		
		
		'f.Data.Datatable.AddRow("warrantyDT", "Serial", v.Screen.FormSerialMangement!txtSerial.Text, "Part", v.DataTable.itemDT(0).Part!FieldValTrim, "Location", v.DataTable.itemDT(0).Location!FieldValTrim, "date_Warranty_chg", v.Local.sTDate, "time_warranty_Chg", v.Local.sTTime, "order_no", v.DataTable.itemDT(0).Order_no!FieldValTrim, "order_suffix", v.DataTable.itemDT(0).Order_Suffix!FieldValTrim, "Order_Line", v.DataTable.itemDT(0).Order_line!FieldValTrim, "Invoice", v.DataTable.itemDT(0).Invoice!FieldValTrim, "date_purchased", v.Local.sSInst, "date_expiration", v.Local.sSInst, "Customer", v.DataTable.itemDT(0).Customer!FieldValTrim, "purch_from_id", "", "end_user_name", v.Local.sEndUser, "address_1", v.DataTable.regDT(4).Value!FieldValTrim, "address_2", "", "City", v.DataTable.regDT(5).Value!FieldValTrim, "State", v.DataTable.regDT(6).Value!FieldValTrim, "ZIP", v.DataTable.regDT(7).Value!FieldValTrim, "Country", v.DataTable.regDT(8).Value!FieldValTrim, "County", "", "Attention", v.Local.sEndUser, "Phone", v.DataTable.regDT(2).Value!FieldValTrim, "Fax", "", "Email", v.DataTable.regDT(3).Value!FieldValTrim, "Old_Serial", "", "address_3", "", "address_4", "", "address_5", "", "flag_intl", "", "Filler", "")
		
		f.Intrinsic.String.Build("Insert into  Warranty (Serial, Part, Location, date_Warranty_chg, time_warranty_Chg, order_no, order_suffix, Order_Line, Invoice, date_purchased, date_expiration, Customer, purch_from_id, end_user_name, address_1, City, State, ZIP, Country, Attention, Phone, Email) Values ('{0}', '{1}', '{2}', '{3}', '{4}', '{5}', '{6}', '{7}', '{8}', '{9}', '{10}', '{11}', '{12}', '{13}', '{14}', '{15}', '{16}', '{17}', '{18}', '{19}', '{20}', '{21}')", v.DataTable.regDT(10).Value!FieldValTrim, v.DataTable.itemDT(0).Part!FieldValTrim, v.DataTable.itemDT(0).Location!FieldValTrim, v.Local.sTDate, v.Local.sTTime, v.DataTable.itemDT(0).Order_no!FieldValTrim, v.DataTable.itemDT(0).Order_Suffix!FieldValTrim, v.DataTable.itemDT(0).Order_line!FieldValTrim, v.DataTable.itemDT(0).Invoice!FieldValTrim, v.Local.sSInst, v.Local.sSExp, v.DataTable.itemDT(0).Customer!FieldValTrim, " ", v.Local.sEndUser.PSQLFriendly, v.DataTable.regDT(4).Value!FieldValTrim, v.DataTable.regDT(5).Value!FieldValTrim, v.DataTable.regDT(6).Value!FieldValTrim, v.DataTable.regDT(7).Value!FieldValTrim, v.DataTable.regDT(8).Value!FieldValTrim, v.Local.sEndUser.PSQLFriendly, v.DataTable.regDT(2).Value!FieldValTrim, v.DataTable.regDT(3).Value!FieldValTrim, v.Local.sSQL)
		
		f.ODBC.Connection!con.Execute(v.Local.sSQL)
		'f.Data.Datatable.SaveToDB("warrantyDT", "con", "warranty", "Serial*!*Part*!*Location*!*Date_Warranty_Chg*!*Time_Warranty_Chg", 128)
		
		f.Data.Datatable.Close("itemDT")
		f.Data.Datatable.Close("warrantyDT")
	f.ODBC.Connection!con.Close
	
	f.Intrinsic.Control.If(v.Global.bEmail)
		'Move Email.
		v.Local.sFromFolder.Set(v.Screen.F_Registration!txtFromFolder.Text)
		v.Local.sToFolder.Set(v.Screen.F_Registration!txtToFolder.Text)
	Function.Automation.MSOutlook.MoveEmail(v.Local.sFromFolder.Trim, v.Global.sEmailID, v.Local.sToFolder.Trim)
	f.Intrinsic.Control.EndIf
	
	f.Intrinsic.UI.Msgbox("Save Complete")
	'Reload Tables.
	gui.FormSerialMangement.txtSerial.Text(v.DataTable.regDT(10).Value!FieldValTrim)
f.Intrinsic.Control.Catch
	f.Intrinsic.Control.CallSub(ErrorMsg, CurrentSub, v.Ambient.CurrentSubroutine)
f.Intrinsic.Control.EndTry
Program.Sub.cmdRegSave_Click.End

Program.Sub.F_Registration_UnLoad.Start
gui.F_Registration..Visible(False)
Program.Sub.F_Registration_UnLoad.End

Program.Sub.cmdTo_Click.Start
v.Local.bOutlook.Declare
v.Local.sFolder.Declare
f.Intrinsic.Control.Try
	'Check for Outlook Presence
	f.Automation.MSOutlook.CheckPresence(v.Local.bOutlook)
	f.Intrinsic.Control.If(v.Local.bOutlook.Not)
		f.Intrinsic.UI.Msgbox("MS Outlook not found.")
		f.Intrinsic.Control.ExitSub
	f.Intrinsic.Control.EndIf
	'Get To folder to move emails.
	f.Automation.MSOutlook.FolderPathPicker(v.Local.sFolder)
	gui.F_Registration.txtToFolder.Text(v.Local.sFolder)
f.Intrinsic.Control.Catch
	f.Intrinsic.Control.CallSub(ErrorMsg, CurrentSub, v.Ambient.CurrentSubroutine)
f.Intrinsic.Control.EndTry
Program.Sub.cmdTo_Click.End

Program.Sub.cmdFrom_Click.Start
v.Local.bOutlook.Declare
v.Local.sFolder.Declare
f.Intrinsic.Control.Try
	'Check for Outlook Presence
	f.Automation.MSOutlook.CheckPresence(v.Local.bOutlook)
	f.Intrinsic.Control.If(v.Local.bOutlook.Not)
		f.Intrinsic.UI.Msgbox("MS Outlook not found.")
		f.Intrinsic.Control.ExitSub
	f.Intrinsic.Control.EndIf
	'Get To folder to move emails.
	f.Automation.MSOutlook.FolderPathPicker(v.Local.sFolder)
	gui.F_Registration.txtFromFolder.Text(v.Local.sFolder)
	'Set Processed TXT To be determined by customer
	f.Intrinsic.String.Split(v.Local.sFolder, "\", v.Local.sFolder)
	v.Local.sFolder(v.Local.sFolder.UBound).Set("Processed")
	f.Intrinsic.String.Join(v.Local.sFolder, "\", v.Local.sFolder)
	gui.F_Registration.txtToFolder.Text(v.Local.sFolder)
f.Intrinsic.Control.Catch
	f.Intrinsic.Control.CallSub(ErrorMsg, CurrentSub, v.Ambient.CurrentSubroutine)
f.Intrinsic.Control.EndTry
Program.Sub.cmdFrom_Click.End

Program.Sub.ddlIncidentType_Change.Start
v.Local.sSQL.Declare
f.Intrinsic.Control.Try
'Try something
	f.ODBC.Connection!con.OpenCompanyConnection
		v.Local.sSQL.Set(v.Screen.FormSerialMangement!ddlIncidentType.Value)
		f.Intrinsic.String.Build("Select * from GCG_6544_Incident where IncidentType = '{0}'", v.Local.sSQL.PSQLFriendly, v.Local.sSQL)
		f.Data.Datatable.CreateFromSQL("cboDT", "con", v.Local.sSQL)
	f.ODBC.Connection!con.Close
	gui.FormSerialMangement.ddlIncident.ClearItems
	gui.FormSerialMangement.ddlIncident.AddItems("datatable", "cboDT", "Incident", "Incident")
	f.Data.Datatable.Close("cboDT")
f.Intrinsic.Control.Catch
	f.Intrinsic.Control.CallSub(ErrorMsg, CurrentSub, v.Ambient.CurrentSubroutine)
f.Intrinsic.Control.EndTry
Program.Sub.ddlIncidentType_Change.End

Program.Sub.loadCBO.Start
f.Intrinsic.Control.Try
	f.ODBC.Connection!con.OpenCompanyConnection
		f.Data.Datatable.CreateFromSQL("cboDT", "con", "Select distinct IncidentType from GCG_6544_Incident")
	f.ODBC.Connection!con.Close
	gui.FormSerialMangement.ddlIncidentType.AddItems("datatable", "cboDT", "IncidentType", "IncidentType")
	f.Data.Datatable.Close("cboDT")
f.Intrinsic.Control.Catch
	f.Intrinsic.Control.CallSub(ErrorMsg, CurrentSub, v.Ambient.CurrentSubroutine)
f.Intrinsic.Control.EndTry
Program.Sub.loadCBO.End

Program.Sub.cmdIncidentNew_Click.Start
v.Local.fID.Declare
v.Local.sSerial.Declare
v.Local.sSQL.Declare
v.Local.sIncident.Declare
v.Local.sIncType.Declare
v.Local.sNotes.Declare
f.Intrinsic.Control.Try
'Try something
	'Get and Check Serial
	v.Local.sSerial.Set(v.Screen.FormSerialMangement!txtSerial.Text)
	v.Local.sIncident.Set(v.Screen.FormSerialMangement!ddlIncident.Text)
	v.Local.sIncType.Set(v.Screen.FormSerialMangement!ddlIncidentType.Text)
	v.Local.sNotes.Set(v.Screen.FormSerialMangement!txtSiteName.Text)
	f.Intrinsic.Control.If(v.Local.sSerial.Trim, =, "")
		f.Intrinsic.UI.Msgbox("Please Select a Serial Number.")
		f.Intrinsic.Control.ExitSub
	f.Intrinsic.Control.EndIf
	'Check the other
'	f.Intrinsic.Control.If(v.Local.sIncident.Trim, =, "")
'		f.Intrinsic.UI.Msgbox("Please Select a Incident.")
'		f.Intrinsic.Control.ExitSub
'	f.Intrinsic.Control.EndIf
'	f.Intrinsic.Control.If(v.Local.sIncType.Trim, =, "")
'		f.Intrinsic.UI.Msgbox("Please Select a Incident Type.")
'		f.Intrinsic.Control.ExitSub
'	f.Intrinsic.Control.EndIf
	'Get last Incident Number for this serial
	f.ODBC.Connection!con.OpenCompanyConnection
		f.Intrinsic.String.Build("Select top 1 Incident_ID from GCG_6544_SO_INCIDENT where Serial_no = '{0}' order by incident_ID desc", v.Local.sSerial, v.Local.sSQL)
		f.ODBC.Connection!con.ExecuteAndReturn(v.Local.sSQL, v.Local.fID)
		'Get next NUmber
		f.Intrinsic.Math.Add(v.Local.fID, 1, v.Local.fID)
		'Save Number
		'f.Intrinsic.String.Build("Insert into  GCG_6544_SO_INCIDENT (Incident_ID, Serial_no) Values ('{0}', '{1}')", v.Local.fID, v.Local.sSerial, v.Local.sSQL)
		'f.ODBC.Connection!con.Execute(v.Local.sSQL)
	f.ODBC.Connection!con.Close
	'Set Incident
	gui.FormSerialMangement.txtIncident.Text(v.Local.fID)
	gui.FormSerialMangement.ddlIncident.ListIndex(-1)
	gui.FormSerialMangement.ddlIncidentType.ListIndex(-1)
	gui.FormSerialMangement.txtSiteName.Text("")
f.Intrinsic.Control.Catch
	f.Intrinsic.Control.CallSub(ErrorMsg, CurrentSub, v.Ambient.CurrentSubroutine)
f.Intrinsic.Control.EndTry
Program.Sub.cmdIncidentNew_Click.End

Program.Sub.cmdIncidentSave_Click.Start
v.Local.fID.Declare
v.Local.sSerial.Declare
v.Local.sSQL.Declare
v.Local.sIncident.Declare
v.Local.sIncType.Declare
v.Local.sNotes.Declare
v.Local.fRet.Declare
f.Intrinsic.Control.Try
'Try something
	'Get and Check Serial
	v.Local.fID.Set(v.Screen.FormSerialMangement!txtIncident.Text)
	v.Local.sSerial.Set(v.Screen.FormSerialMangement!txtSerial.Text)
	v.Local.sIncident.Set(v.Screen.FormSerialMangement!ddlIncident.Text)
	v.Local.sIncType.Set(v.Screen.FormSerialMangement!ddlIncidentType.Text)
	v.Local.sNotes.Set(v.Screen.FormSerialMangement!txtSiteName.Text)
	f.Intrinsic.Control.If(v.Local.sSerial.Trim, =, "")
		f.Intrinsic.UI.Msgbox("Please Select a Serial Number.")
		f.Intrinsic.Control.ExitSub
	f.Intrinsic.Control.EndIf
	'Check the other
	f.Intrinsic.Control.If(v.Local.sIncident.Trim, =, "")
		f.Intrinsic.UI.Msgbox("Please Select a Incident.")
		f.Intrinsic.Control.ExitSub
	f.Intrinsic.Control.EndIf
	f.Intrinsic.Control.If(v.Local.sIncType.Trim, =, "")
		f.Intrinsic.UI.Msgbox("Please Select a Incident Type.")
		f.Intrinsic.Control.ExitSub
	f.Intrinsic.Control.EndIf
	'Get last Incident Number for this serial
	f.ODBC.Connection!con.OpenCompanyConnection
		f.Intrinsic.String.Build("Select top 1 Incident_ID from GCG_6544_SO_INCIDENT where Serial_no = '{0}' and Incident_ID = '{1}' order by incident_id desc", v.Local.sSerial, v.Local.fID, v.Local.sSQL)
		f.ODBC.Connection!con.ExecuteAndReturn(v.Local.sSQL, v.Local.fRet)
		'Check if it exists.
		f.Intrinsic.Control.If(v.Local.fRet, =, v.Local.fID)
			f.Intrinsic.String.Build("Update GCG_6544_SO_INCIDENT Set Incident_Type = '{2}', Incident = '{3}', Notes = '{4}' Where Incident_ID = '{0}' and Serial_no = '{1}'", v.Local.fID, v.Local.sSerial, v.Local.sIncType.PSQLFriendly, v.Local.sIncident.PSQLFriendly, v.Local.sNotes.PSQLFriendly, v.Local.sSQL)
		f.Intrinsic.Control.Else
			f.Intrinsic.String.Build("Insert into  GCG_6544_SO_INCIDENT (Incident_ID, Serial_no, Incident_Type, Incident, Notes) Values ('{0}', '{1}', '{2}', '{3}', '{4}')", v.Local.fID, v.Local.sSerial, v.Local.sIncType.PSQLFriendly, v.Local.sIncident.PSQLFriendly, v.Local.sNotes.PSQLFriendly, v.Local.sSQL)
		f.Intrinsic.Control.EndIf
		'Save Number
		f.ODBC.Connection!con.Execute(v.Local.sSQL)
		
		F.Intrinsic.String.Build("Select * From GCG_6544_SO_INCIDENT Where Serial_No = '{0}'", V.Screen.FormSerialMangement!txtSerial.Text, V.Local.sSql)
		F.Data.DataTable.CreateFromSQL("TempOrigSO","con",V.Local.sSql)
		F.Data.DataTable.DeleteRow("OrigSO")
		F.Data.DataTable.AcceptChanges("OrigSO")
		F.Data.DataTable.Merge("TempOrigSO","OrigSO",False,4)
		f.Data.Datatable.Close("TempOrigSO")
		F.Data.DataTable.AcceptChanges("OrigSO")
	f.ODBC.Connection!con.Close
f.Intrinsic.Control.Catch
	f.Intrinsic.Control.CallSub(ErrorMsg, CurrentSub, v.Ambient.CurrentSubroutine)
f.Intrinsic.Control.EndTry
Program.Sub.cmdIncidentSave_Click.End

Program.Sub.cmdIncidentDelete_Click.Start
v.Local.fID.Declare
v.Local.sSerial.Declare
v.Local.sSQL.Declare
v.Local.sMSG.Declare
v.Local.fRet.Declare
f.Intrinsic.Control.Try
'Try something
	v.Local.sSerial.Set(v.Screen.FormSerialMangement!txtSerial.Text)
	v.Local.fID.Set(v.Screen.FormSerialMangement!txtIncident.Text)
	f.Intrinsic.Control.If(v.Local.sSerial.Trim, =, "")
		f.Intrinsic.UI.Msgbox("Please Select a Serial Number.")
		f.Intrinsic.Control.ExitSub
	f.Intrinsic.Control.EndIf
	'Check the other
	f.Intrinsic.Control.If(v.Local.fID.Trim, =, "")
		f.Intrinsic.UI.Msgbox("Please Select a Incident.")
		f.Intrinsic.Control.ExitSub
	f.Intrinsic.Control.EndIf
	'Check Before Delete
	f.Intrinsic.String.Build("Do you wish to delete Incident #: {0} for Serial Number: {1}", v.Local.fID, v.Local.sSerial, v.Local.sMSG)
	f.Intrinsic.UI.Msgbox(v.Local.sMSG, "Delete", 4, v.Local.fRet)
	f.Intrinsic.Control.If(v.Local.fRet, <>, 6)
		f.Intrinsic.Control.ExitSub
	f.Intrinsic.Control.EndIf
	'Delete From SQL
	f.ODBC.Connection!con.OpenCompanyConnection
		f.Intrinsic.String.Build("Delete From GCG_6544_SO_INCIDENT Where Incident_ID = '{0}' and Serial_no = '{1}'", v.Local.fID, v.Local.sSerial, v.Local.sSQL)
		f.ODBC.Connection!con.Execute(v.Local.sSQL)
		
		F.Intrinsic.String.Build("Select * From GCG_6544_SO_INCIDENT Where Serial_No = '{0}'", V.Screen.FormSerialMangement!txtSerial.Text, V.Local.sSql)
		F.Data.DataTable.CreateFromSQL("TempOrigSO","con",V.Local.sSql)
		F.Data.DataTable.DeleteRow("OrigSO")
		F.Data.DataTable.AcceptChanges("OrigSO")
		F.Data.DataTable.Merge("TempOrigSO","OrigSO",False,4)
		f.Data.Datatable.Close("TempOrigSO")
		F.Data.DataTable.AcceptChanges("OrigSO")
	f.ODBC.Connection!con.Close
	'Set Incident
	gui.FormSerialMangement.txtIncident.Text("")
	gui.FormSerialMangement.ddlIncident.Text("")
	gui.FormSerialMangement.ddlIncidentType.Text("")
	gui.FormSerialMangement.txtSiteName.Text("")
f.Intrinsic.Control.Catch
	f.Intrinsic.Control.CallSub(ErrorMsg, CurrentSub, v.Ambient.CurrentSubroutine)
f.Intrinsic.Control.EndTry
Program.Sub.cmdIncidentDelete_Click.End

Program.Sub.cmdCreateSO_Click.Start
v.Local.sID.Declare
v.Local.fRet.Declare
v.Local.sSO.Declare
v.Local.sCustomer.Declare
v.Local.sSerial.Declare
v.Local.sMSG.Declare
v.Local.sTerm.Declare
v.Local.sUser3.Declare
v.Local.sDate.Declare
v.Local.sSQL.Declare
v.Local.sLine.Declare
v.Local.iCnt.Declare
v.Local.iAdd.Declare
v.Local.sPartFull.Declare
v.Local.sPart.Declare
v.Local.sRev.Declare
v.Local.sParams.Declare
'Ship to Info
v.Local.sShip_CustomerName.Declare
v.Local.sShipAdd1.Declare
v.Local.sShipAdd2.Declare
v.Local.sShipAdd3.Declare
v.Local.sShipToCity.Declare
v.Local.sShipToState.Declare
v.Local.sShipToZip.Declare
v.Local.sShipToCountry.Declare
v.Local.sShipToAttention.Declare
v.Local.sShipToID.Declare
v.Local.sCustomID.Declare
v.Local.sQty.Declare
v.Local.sTempQty.Declare
v.Local.sWarranty.Declare
v.Local.sPL.Declare
v.Local.sGL.Declare
v.Local.sReturn.Declare
f.Intrinsic.Control.Try
'Try something	
	v.Local.sSerial.Set(v.Screen.FormSerialMangement!txtSerial.Text)
	v.Local.sID.Set(v.Screen.FormSerialMangement!txtIncident.Text)
	v.Local.sCustomer.Set(v.Screen.FormSerialMangement!txtCustomer.Text)
	f.Intrinsic.Control.If(v.DataView.WOBOM!WOSelectedDV.RowCount, =, 0)
		f.Intrinsic.UI.Msgbox("Please select at least one part.")
		f.Intrinsic.Control.ExitSub
	f.Intrinsic.Control.EndIf
	
	f.Intrinsic.Control.If(v.Local.sCustomer.Trim, =, "")
		f.Intrinsic.UI.Msgbox("Please select a Customer.")
		f.Intrinsic.Control.ExitSub
	f.Intrinsic.Control.EndIf
	
	f.Intrinsic.String.Build("Select Customer from V_Customer_Master where Customer = '{0}'", v.Local.sCustomer, v.Local.sSQL)
	f.ODBC.Connection!con.OpenCompanyConnection
		f.ODBC.Connection!con.ExecuteAndReturn(v.Local.sSQL, v.Local.sReturn)
	f.ODBC.Connection!con.Close
	
	f.Intrinsic.Control.If(v.Local.sReturn, <>, v.Local.sCustomer)
		f.Intrinsic.UI.Msgbox("Please select a Valid Customer.")
		f.Intrinsic.Control.ExitSub
	f.Intrinsic.Control.EndIf
	
	'Credit Hold
	f.Intrinsic.String.Build("Select FLAG_CREDIT_HOLD from V_Customer_Master where Customer = '{0}'", v.Local.sCustomer, v.Local.sSQL)
	f.ODBC.Connection!con.OpenCompanyConnection
		f.ODBC.Connection!con.ExecuteAndReturn(v.Local.sSQL, v.Local.sReturn)
	f.ODBC.Connection!con.Close
	
	f.Intrinsic.Control.If(v.Local.sReturn, =, "Y")
		f.Intrinsic.UI.Msgbox("Customer on Credit Hold, Sales Order cannot be created.")
		f.Intrinsic.Control.ExitSub
	f.Intrinsic.Control.EndIf
	
	'Check Incident
	f.Intrinsic.Control.If(v.Local.sID, =, "")
		f.Intrinsic.UI.Msgbox("Please select an Incident")
		f.Intrinsic.Control.ExitSub
	f.Intrinsic.Control.Else
		f.Intrinsic.String.Build("Select top 1 Incident_ID from GCG_6544_SO_INCIDENT where Serial_no = '{0}' and Incident_ID = '{1}'", v.Local.sSerial, v.Local.sID, v.Local.sSQL)
		f.ODBC.Connection!con.OpenCompanyConnection
		 	f.ODBC.Connection!con.ExecuteAndReturn(v.Local.sSQL, v.Local.sID)
		f.ODBC.Connection!con.Close		
		f.Intrinsic.Control.If(v.Local.sID, =, "")
			f.Intrinsic.UI.Msgbox("Please select an Incident")
			f.Intrinsic.Control.ExitSub
		f.Intrinsic.Control.EndIf
		
	f.Intrinsic.Control.EndIf
	'Check Warranty checkbox
	f.Intrinsic.Control.If(v.Screen.FormSerialMangement!chk1.Value, =, 1)
		v.Local.sMSG.Set("Do you wish to create a Warranty Order?")
		v.Local.sUser3.Set("Warranty")
		f.Intrinsic.String.Build("Select Warranty from GCG_6544_CUST_TERMS where Customer = '{0}'", v.Local.sCustomer, v.Local.sSQL)
	f.Intrinsic.Control.Else
		v.Local.sMSG.Set("Do you wish to create a Service Part Order?")
		v.Local.sUser3.Set("Service/Parts")
		f.Intrinsic.String.Build("Select Service_Order from GCG_6544_CUST_TERMS where Customer = '{0}'", v.Local.sCustomer, v.Local.sSQL)
	f.Intrinsic.Control.EndIf
	f.Intrinsic.UI.Msgbox(v.Local.sMSG, "Sales Order Creation", 4, v.Local.fRet)
	f.Intrinsic.Control.If(v.Local.fRet, <>, 6)
		f.Intrinsic.Control.ExitSub
	f.Intrinsic.Control.EndIf
	'Get Terms
	f.Intrinsic.UI.InvokeWaitDialog("Creating Sales Order...")
	f.ODBC.Connection!con.OpenCompanyConnection
		 f.ODBC.Connection!con.ExecuteAndReturn(v.Local.sSQL, v.Local.sTerm)
		 f.Intrinsic.String.Build("Select top 1 Terms_message from V_AR_TERMS where Terms_Code = '{0}'", v.Local.sTerm, v.Local.sSQL)
		 f.ODBC.Connection!con.ExecuteAndReturn(v.Local.sSQL, v.Local.sTerm)
		 'f.ODBC.Connection!con.ExecuteAndReturn("Select top 1 Order_no from V_Order_Header order by order_no desc", v.Local.fRet)
		 f.ODBC.Connection!con.ExecuteAndReturn("select top 1 f_long from OP_HEADER where id = '402499' and sequence = '0000'", v.Local.fRet)
		 f.Intrinsic.String.LPad(v.Local.fRet.++, "0", 7, v.Local.sSO)
		 f.Intrinsic.String.Build("update OP_HEADER set f_long = '{0}' from OP_HEADER where id = '402499' and sequence = '0000'", v.Local.fRet, v.Local.sSQL)
		 f.ODBC.Connection!con.Execute(v.Local.sSQL)
		 f.Intrinsic.String.Build("Select * from V_OE_MULTI_SHIP where Customer = '{0}'", v.Local.sCustomer, v.Local.sSQL)
		 f.Data.DataTable.CreateFromSQL("shiptoDT", "con", v.Local.sSQL)
	f.ODBC.Connection!con.Close		
	'Get Custom ID
	f.Intrinsic.String.Build("CustomID_{0}", v.Caller.Terminal, v.Local.sCustomID)		
	'Ship info
	f.Intrinsic.Control.If(v.DataTable.shiptoDT.RowCount, =, 1)	
		v.Local.sShip_CustomerName.Set(v.DataTable.shiptoDT(0).CUSTOMER_NAME!FieldValTrim)
		v.Local.sShipAdd1.Set(v.DataTable.shiptoDT(0).SHIP_ADDRESS1!FieldValTrim)
		v.Local.sShipAdd2.Set(v.DataTable.shiptoDT(0).SHIP_ADDRESS2!FieldValTrim)
		v.Local.sShipAdd3.Set(v.DataTable.shiptoDT(0).SHIP_ADDRESS3!FieldValTrim)
		v.Local.sShipToCity.Set(v.DataTable.shiptoDT(0).SHIP_CITY!FieldValTrim)
		v.Local.sShipToState.Set(v.DataTable.shiptoDT(0).SHIP_STATE!FieldValTrim)
		v.Local.sShipToZip.Set(v.DataTable.shiptoDT(0).SHIP_ZIP!FieldValTrim)
		v.Local.sShipToCountry.Set(v.DataTable.shiptoDT(0).SHIP_COUNTRY!FieldValTrim)
		v.Local.sShipToAttention.Set(v.DataTable.shiptoDT(0).SHIP_ATTENTION!FieldValTrim)
		v.Local.sShipToID.Set(v.DataTable.shiptoDT(0).SHIP_SEQ!FieldValTrim)
	f.Intrinsic.Control.EndIf
	'Get Date
	f.Intrinsic.String.Format(v.Ambient.Date, "YYYYMMDD", v.Local.sDate)
	'Add Row
	'f.Data.Datatable.AddRow("6004Header", "Type", "O", "CustNum", v.Local.sCustomer, "DueDate", v.Local.sDate, "OrdDate", v.Local.sDate, "User3", v.Local.sUser3, "OrderNum", v.Local.sSO)
	f.Data.DataTable.AddRow("ORDUPL", "Transaction", "O", "CustomerNo", v.Local.sCustomer, "UserField1Head", v.Local.sSerial, "UserField2Head", v.Local.sCustomID, "UserField5Head", "", "UserField3Head", v.Local.sUser3, "ShipToName", v.Local.sShip_CustomerName, "ShipToAddress1", v.Local.sShipAdd1, "ShipToAddress2", v.Local.sShipAdd2, "ShipToAddress3", v.Local.sShipAdd3, "ShipToCity", v.Local.sShipToCity, "ShipToState", v.Local.sShipToState, "ShipToZip", v.Local.sShipToZip, "ShipToCountry", v.Local.sShipToCountry, "ShipToAttention", v.Local.sShipToAttention, "ShipToID", v.Local.sShipToID, "OrderType", " ", "FromLOC", "  ", "OrderNumber", v.Local.sSO, "OverrideAutoNumbering", 1)
	'f.Data.DataTable.AddRow("ORDUPL", "Transaction", "O", "CustomerNo", v.Local.sCustomer, "ShipVia", v.Local.sShipVia, "UserField1Head", "Intercompany", "UserField2Head", "NA", "UserField5Head", "NA", "UserField3Head", v.Local.sCustomID, "OrderType", "T", "ShipToName", v.Local.sShip_CustomerName, "ShipToAddress1", v.Local.sShipAdd1, "ShipToAddress2", v.Local.sShipAdd2, "ShipToAddress3", v.Local.sShipAdd3, "ShipToCity", v.Local.sShipToCity, "ShipToState", v.Local.sShipToState, "ShipToZip", v.Local.sShipToZip, "ShipToCountry", v.Local.sShipToCountry, "ShipToAttention", v.Local.sShipToAttention, "ShipToID", v.Local.sShipToID, "FromLOC", v.Local.sFromLoc) OrderNumber
	'Add Lines
	f.Intrinsic.Control.For(v.Local.iCnt, 0, v.DataView.WOBOM!woSelectedDV.RowCount--, 1)
		'Get Line
		f.Intrinsic.Math.Add(v.Local.iCnt, 1, v.Local.iAdd)
		f.Intrinsic.String.LPad(v.Local.iAdd, "0", 3, v.Local.sLine)
		'Get part
		f.Intrinsic.String.RPad(v.DataView.WOBOM!woSelectedDV(v.Local.iCnt).Part!FieldValTrim, " ", 20, v.Local.sPartFull)
		f.Intrinsic.String.Right(v.Local.sPartFull, 3, v.Local.sRev)
		f.Intrinsic.String.Left(v.Local.sPartFull, 17, v.Local.sPart)
		'Get Part Data
		f.ODBC.Connection!con.OpenCompanyConnection
			f.Intrinsic.String.Build("Select * from V_Inventory_All where part = '{0}'", v.Local.sPartFull, v.Local.sSQL)
			f.Data.Datatable.CreateFromSQL("partDT", "con", v.Local.sSQL, false)
		f.ODBC.Connection!con.Close
		'QTY
		v.Local.sTempQty.Set(v.DataView.WOBOM!woSelectedDV(v.Local.iCnt).Quantity!FieldVal)
		f.Intrinsic.String.Split(v.Local.sTempQty.Trim, ".", v.Local.sTempQty)
			f.Intrinsic.Control.If(v.Local.sTempQty.UBound, =, 1)
				f.Intrinsic.String.LPad(v.Local.sTempQty(0), "0", 9, v.Local.sTempQty(0))
				f.Intrinsic.String.RPad(v.Local.sTempQty(1), "0", 4, v.Local.sTempQty(1))
				f.Intrinsic.String.Build("{0}{1}", v.Local.sTempQty(0), v.Local.sTempQty(1), v.Local.sQty)
			f.Intrinsic.Control.ElseIf(v.Local.sTempQty.UBound, =, 0)
				f.Intrinsic.String.LPad(v.Local.sTempQty, "0", 9, v.Local.sQty)
				f.Intrinsic.String.RPad(v.Local.sQty, "0", 13, v.Local.sQty)
			f.Intrinsic.Control.EndIf			
		'PL
		f.Intrinsic.Control.If(v.Screen.FormSerialMangement!chk1.Value, =, 1)
			v.Local.sPL.Set("WP")
		f.Intrinsic.Control.Else
			v.Local.sPL.Set(v.DataTable.partDT(0).Product_Line!FieldValTrim)
		f.Intrinsic.Control.EndIf
		'Add Line
		f.Data.DataTable.AddRow("ORDUPLLines", "QtyOrdered", v.Local.sQty, "PartNumber", v.Local.sPart, "PartRev", v.Local.sRev, "PartLoc", v.DataTable.partDT(0).Location!FieldValTrim, "UserField1", v.Local.sSerial, "UserField3", v.Local.sUser3, "UserField4", v.Screen.FormSerialMangement!ddlIncidentType.Text, "UserField5", v.Screen.FormSerialMangement!ddlIncident.Text, "LinePromiseDate",  v.Local.sDate, "UM", v.DataTable.partDT(0).UM_Inventory!FieldValTrim, "PL", v.Local.sPL)
		
		'f.Data.Datatable.AddRow("6004Lines", "OrderNum", v.Local.sSO, "lineNumber", v.Local.sLine, "QtyOrdered", v.DataView.WOBOM!woSelectedDV(v.Local.iCnt).Quantity!FieldVal, "Part", v.Local.sPart, "Rev", v.Local.sRev, "UM", v.DataTable.partDT(0).UM_Inventory!FieldValTrim, "Cost", v.DataTable.partDT(0).AMT_COST!FieldValTrim, "PartDescription", v.DataTable.partDT(0).Description!FieldValTrim, "PL", v.DataTable.partDT(0).Product_Line!FieldValTrim, "User1", v.Local.sSerial, "User4", v.Screen.FormSerialMangement!ddlIncidentType.Text, "User5", v.Screen.FormSerialMangement!ddlIncident.Text, "User3", v.Local.sUser3, "OrderDate", v.Local.sDate, "QuotedPrice", v.DataTable.partDT(0).Amt_Price!FieldValTrim, "OverridePrice", v.DataTable.partDT(0).Amt_Price!FieldValTrim)
		
		f.Data.Datatable.Close("partDT")
	f.Intrinsic.Control.Next(v.Local.iCnt)
	'f.Intrinsic.Control.CallSub("6004Sync")
	f.Data.DataTable.AcceptChanges("ORDUPL")
	f.Data.DataTable.AcceptChanges("ORDUPLLines")
		
	f.Intrinsic.Control.CallSub(ORDUPLCreateFile)		
	f.Intrinsic.Control.CallSub(ORDUPLSync)
	'Add Code Sort
	f.ODBC.Connection!con.OpenCompanyConnection
		'f.Intrinsic.String.Build("Select top 1 Order_No from V_Order_Header where Rtrim(USER_2) = '{0}'", v.Local.sCustomID.Trim, v.Local.sSQL)
		'f.ODBC.Connection!con.ExecuteAndReturn(v.Local.sSQL, v.Local.sSO)
		 	
		f.Intrinsic.String.Build("Update Order_Header Set Code_Sort = '{0}', User_2 = '', Terms = '{2}' Where Order_no = '{1}' and Record_No = '  A'", v.Local.sUser3, v.Local.sSO, v.Local.sTerm, v.Local.sSQL) 
		f.ODBC.Connection!con.Execute(v.Local.sSQL)
		
		f.Intrinsic.String.Build("Update Order_lines Set Product_line = '{0}', User_1 = '{2}' where Order_no = '{1}' and Record_Type = 'L'", v.Local.sPL, v.Local.sSO, v.Local.sSerial, v.Local.sSQL)
		f.ODBC.Connection!con.Execute(v.Local.sSQL)
		
		f.Intrinsic.Control.If(v.Local.sPL, =, "WP")
			f.ODBC.Connection!con.ExecuteAndReturn("Select top 1 GL_acct from V_PL_GL_ACCOUNTS where Prod_line = 'WP' and Type = '1'", v.Local.sGL)
			f.Intrinsic.String.Build("Update Order_lines Set GL_Account = '{0}' where Order_no = '{1}' and Record_Type = 'L'", v.Local.sGL, v.Local.sSO, v.Local.sSQL)
			f.ODBC.Connection!con.Execute(v.Local.sSQL)
		f.Intrinsic.Control.EndIf
		
		f.Intrinsic.String.Build("Update GCG_6544_SO_INCIDENT Set Order_No = '{0}' where Serial_no = '{1}' and Incident_ID = '{2}'", v.Local.sSO, v.Local.sSerial, v.Local.sID, v.Local.sSQL)
		f.ODBC.Connection!con.Execute(v.Local.sSQL)
	f.ODBC.Connection!con.Close
	
	f.Intrinsic.String.Build("{0}!*!O!*!{1}", v.Local.sSO, v.Local.sCustomer, v.Local.sParams)
	f.Global.General.CallwrapperAsync(200000, v.Local.sParams)
	f.Data.Datatable.Close("shiptoDT")
	f.Intrinsic.UI.CloseWaitDialog
f.Intrinsic.Control.Catch
	f.Intrinsic.UI.CloseWaitDialog
	f.Intrinsic.Control.CallSub(ErrorMsg, CurrentSub, v.Ambient.CurrentSubroutine)
f.Intrinsic.Control.EndTry
Program.Sub.cmdCreateSO_Click.End

Program.Sub.cmdAddPartWO_Click.Start
v.Local.sRet.Declare
f.Intrinsic.Control.Try
	f.Intrinsic.UI.SetBrowserHotTypeAhead(True)
	f.Intrinsic.UI.Browser(105, ,v.Local.sRet)
	f.Intrinsic.Control.If(v.Local.sRet.Trim, =, "***CANCEL***")
		f.Intrinsic.Control.ExitSub
	f.Intrinsic.Control.EndIf
	f.Intrinsic.String.Split(v.Local.sRet, "*!*", v.Local.sRet)
	f.Data.Datatable.AddRow("WOBOM", "Part", v.Local.sRet(0), "Description", v.Local.sRet(2), "Quantity", 1)
f.Intrinsic.Control.Catch
	f.Intrinsic.Control.CallSub(ErrorMsg, CurrentSub, v.Ambient.CurrentSubroutine)
f.Intrinsic.Control.EndTry
Program.Sub.cmdAddPartWO_Click.End

Program.Sub.cmdTextEmail_Click.Start
f.Intrinsic.Control.Try
'Try something
	gui.FormRegText..Visible(True)
f.Intrinsic.Control.Catch
	f.Intrinsic.Control.CallSub(ErrorMsg, CurrentSub, v.Ambient.CurrentSubroutine)
f.Intrinsic.Control.EndTry
Program.Sub.cmdTextEmail_Click.End

Program.Sub.cmdOKTEXT_Click.Start
v.Local.sBody.Declare
v.Local.sTemp.Declare
v.Local.iStreet.Declare
f.Intrinsic.Control.Try
	'Get Body from Textboxt
	v.Local.sBody.Set(v.Screen.FormRegText!txtRegEmail.Text)
	f.Intrinsic.Control.If(v.Local.sBody.Trim, =, "")
		gui.FormRegText..Visible(False)
		f.Intrinsic.Control.ExitSub
	f.Intrinsic.Control.EndIf
	'Clean DT
	f.Data.Datatable.DeleteRow("regDT")
	f.Data.Datatable.AcceptChanges("regDT")
	'Parse Body
	'First Name
	f.Intrinsic.String.Split(v.Local.sBody, "First Name", v.Local.sBody)
	f.Intrinsic.String.Split(v.Local.sBody(1), "Last Name", v.Local.sBody)
	v.Local.sTemp.Set(v.Local.sBody(0))
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, "	", "", v.Local.sTemp)
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, v.Ambient.NewLine, "", v.Local.sTemp)
	f.Data.Datatable.AddRow("regDT", "Title", "First Name:", "Value", v.Local.sTemp.Trim)
	'Last Name
	f.Intrinsic.String.Split(v.Local.sBody(1), "Phone Number", v.Local.sBody)
	v.Local.sTemp.Set(v.Local.sBody(0))
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, "	", "", v.Local.sTemp)
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, v.Ambient.NewLine, "", v.Local.sTemp)
	f.Data.Datatable.AddRow("regDT", "Title", "Last Name:", "Value", v.Local.sTemp.Trim)
	'Phone Number
	f.Intrinsic.String.Split(v.Local.sBody(1), "Email", v.Local.sBody)
	v.Local.sTemp.Set(v.Local.sBody(0))
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, "	", "", v.Local.sTemp)
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, v.Ambient.NewLine, "", v.Local.sTemp)
	f.Data.Datatable.AddRow("regDT", "Title", "Phone Number:", "Value", v.Local.sTemp.Trim)
	'Email
	f.Intrinsic.String.Split(v.Local.sBody(1), "Street", v.Local.sBody)
	v.Local.sTemp.Set(v.Local.sBody(0))
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, "	", "", v.Local.sTemp)
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, v.Ambient.NewLine, "", v.Local.sTemp)
	f.Data.Datatable.AddRow("regDT", "Title", "Email:", "Value", v.Local.sTemp.Trim)
	f.Intrinsic.Control.If(v.Local.sBody.UBound, =, 3)
		f.Intrinsic.String.Build("{0} Street{1}", v.Local.sBody(1), v.Local.sBody(2), v.Local.sBody(1))
	f.Intrinsic.Control.EndIf
	'Street
	f.Intrinsic.String.Split(v.Local.sBody(1), "City", v.Local.sBody)
	v.Local.sTemp.Set(v.Local.sBody(0))
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, "	", "", v.Local.sTemp)
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, v.Ambient.NewLine, "", v.Local.sTemp)	
	f.Data.Datatable.AddRow("regDT", "Title", "Street:", "Value", v.Local.sTemp.Trim)
	'City
	f.Intrinsic.String.Split(v.Local.sBody(1), "State", v.Local.sBody)
	v.Local.sTemp.Set(v.Local.sBody(0))
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, "	", "", v.Local.sTemp)
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, v.Ambient.NewLine, "", v.Local.sTemp)
	f.Data.Datatable.AddRow("regDT", "Title", "City:", "Value", v.Local.sTemp.Trim)
	'State
	f.Intrinsic.String.Split(v.Local.sBody(1), "Postal Code", v.Local.sBody)
	v.Local.sTemp.Set(v.Local.sBody(0))
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, "	", "", v.Local.sTemp)
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, v.Ambient.NewLine, "", v.Local.sTemp)
	f.Data.Datatable.AddRow("regDT", "Title", "State:", "Value", v.Local.sTemp.Trim)
	'Postal Code
	f.Intrinsic.String.Split(v.Local.sBody(1), "Country", v.Local.sBody)
	v.Local.sTemp.Set(v.Local.sBody(0))
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, "	", "", v.Local.sTemp)
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, v.Ambient.NewLine, "", v.Local.sTemp)
	f.Data.Datatable.AddRow("regDT", "Title", "Postal Code:", "Value", v.Local.sTemp.Trim)
	'Country
	f.Intrinsic.String.Split(v.Local.sBody(1), "Model Name", v.Local.sBody)
	v.Local.sTemp.Set(v.Local.sBody(0))
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, "	", "", v.Local.sTemp)
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, v.Ambient.NewLine, "", v.Local.sTemp)
	f.Data.Datatable.AddRow("regDT", "Title", "Country:", "Value", v.Local.sTemp.Trim)
	'Model Name
	f.Intrinsic.String.Split(v.Local.sBody(1), "Serial Number", v.Local.sBody)
	v.Local.sTemp.Set(v.Local.sBody(0))
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, "	", "", v.Local.sTemp)
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, v.Ambient.NewLine, "", v.Local.sTemp)
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, v.Ambient.NewLine, "", v.Local.sTemp)
	f.Data.Datatable.AddRow("regDT", "Title", "Model Name:", "Value", v.Local.sTemp.Trim)
	'Serial Number
	f.Intrinsic.String.Split(v.Local.sBody(1), "Installation Date", v.Local.sBody)
	v.Local.sTemp.Set(v.Local.sBody(0))
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, "	", "", v.Local.sTemp)
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, v.Ambient.NewLine, "", v.Local.sTemp)
	f.Data.Datatable.AddRow("regDT", "Title", "Serial Number:", "Value", v.Local.sTemp.Trim)
	'Installation Date
	f.Intrinsic.String.Split(v.Local.sBody(1), "Choose Shell Color", v.Local.sBody)
	v.Local.sTemp.Set(v.Local.sBody(0))
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, "	", "", v.Local.sTemp)
	f.Intrinsic.String.Replace(v.Local.sTemp.Trim, v.Ambient.NewLine, "", v.Local.sTemp)
	f.Data.Datatable.AddRow("regDT", "Title", "Installation Date:", "Value", v.Local.sTemp.Trim)
	'Close
	v.Global.bEmail.Set(False)
	gui.FormRegText.txtRegEmail.Text("")
	gui.FormRegText..Visible(False)
	f.Intrinsic.Control.ExitSub
f.Intrinsic.Control.Catch
	f.Intrinsic.Control.CallSub(ErrorMsg, CurrentSub, v.Ambient.CurrentSubroutine)
f.Intrinsic.Control.EndTry
Program.Sub.cmdOKTEXT_Click.End

Program.Sub.Comments.Start
${$5$}$3.0.0.0$}$1
${$6$}$aanazco$}$20230112150211902$}$7aQAV3Tor/tR9bkuakHbuzQlHVuXCGOz8eP9dq02peWFqYlxSoVHvjTfpQqlJBR6zi9MpYxQ7l4=
Program.Sub.Comments.End